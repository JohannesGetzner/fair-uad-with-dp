Running script with Anaconda environment: thesis_opacus
Using cuda
Running dp/v1...
Run config: {'dp': True, 'max_grad_norm': 0.01, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 3, 'wandb_project': 'unsupervised-fairness', 'epochs': 15000, 'batch_size': 512, 'max_physical_batch_size': 512, 'lr': 0.0002}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.7 (678 young and 678 old samples are available)
Using 475 young and 475 old samples for training.
Final dataset shape:  (950, 4)
Loaded datasets in 9.73s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.10 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/wandb/run-20230917_184515-g9coa9hm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/g9coa9hm
Setting seed to 1...
Initializing model...
Using normal loss
/u/home/getzner/opacus/opacus/privacy_engine.py:95: UserWarning: Secure RNG turned off. This is perfectly fine for experimentation as it allows for much faster training performance, but remember to turn it on and retrain one last time before production with ``secure_mode`` turned on.
  warnings.warn(
Starting training...
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
/u/home/getzner/opacus/opacus/accountants/analysis/rdp.py:332: UserWarning: Optimal order is the largest alpha. Please consider expanding the range of alphas to get a tighter privacy bound.
  warnings.warn(
Finished epoch 1/15000, (2 iterations)
Finished epoch 2/15000, (4 iterations)
Finished epoch 3/15000, (6 iterations)
Finished epoch 4/15000, (8 iterations)
Finished epoch 5/15000, (10 iterations)
Finished epoch 6/15000, (12 iterations)
Finished epoch 7/15000, (14 iterations)
Finished epoch 8/15000, (16 iterations)
Finished epoch 9/15000, (18 iterations)
Finished epoch 10/15000, (20 iterations)
Finished epoch 11/15000, (22 iterations)
Finished epoch 12/15000, (24 iterations)
Finished epoch 13/15000, (26 iterations)
Finished epoch 14/15000, (28 iterations)
Finished epoch 15/15000, (30 iterations)
Finished epoch 16/15000, (32 iterations)
Finished epoch 17/15000, (34 iterations)
Finished epoch 18/15000, (36 iterations)
Finished epoch 19/15000, (38 iterations)
Finished epoch 20/15000, (40 iterations)
Finished epoch 21/15000, (42 iterations)
Finished epoch 22/15000, (44 iterations)
Finished epoch 23/15000, (46 iterations)
Finished epoch 24/15000, (48 iterations)
Finished epoch 25/15000, (50 iterations)
Finished epoch 26/15000, (52 iterations)
Finished epoch 27/15000, (54 iterations)
Finished epoch 28/15000, (56 iterations)
Finished epoch 29/15000, (58 iterations)
Finished epoch 30/15000, (60 iterations)
Finished epoch 31/15000, (62 iterations)
Finished epoch 32/15000, (64 iterations)
Finished epoch 33/15000, (66 iterations)
Finished epoch 34/15000, (68 iterations)
Finished epoch 35/15000, (70 iterations)
Finished epoch 36/15000, (72 iterations)
Finished epoch 37/15000, (74 iterations)
Finished epoch 38/15000, (76 iterations)
Finished epoch 39/15000, (78 iterations)
Finished epoch 40/15000, (80 iterations)
Finished epoch 41/15000, (82 iterations)
Finished epoch 42/15000, (84 iterations)
Finished epoch 43/15000, (86 iterations)
Finished epoch 44/15000, (88 iterations)
Finished epoch 45/15000, (90 iterations)
Finished epoch 46/15000, (92 iterations)
Finished epoch 47/15000, (94 iterations)
Finished epoch 48/15000, (96 iterations)
Finished epoch 49/15000, (98 iterations)
Iteration 100 - loss: 0.9814 - rec_loss: 0.9814 - time: 0d-0h-2m-29s - remaining time: 0d-12h-37m-45s
Finished epoch 50/15000, (100 iterations)
Finished epoch 51/15000, (102 iterations)
Finished epoch 52/15000, (104 iterations)
Finished epoch 53/15000, (106 iterations)
Finished epoch 54/15000, (108 iterations)
Finished epoch 55/15000, (110 iterations)
Finished epoch 56/15000, (112 iterations)
Finished epoch 57/15000, (114 iterations)
Finished epoch 58/15000, (116 iterations)
Finished epoch 59/15000, (118 iterations)
Finished epoch 60/15000, (120 iterations)
Finished epoch 61/15000, (122 iterations)
Finished epoch 62/15000, (124 iterations)
Finished epoch 63/15000, (126 iterations)
Finished epoch 64/15000, (128 iterations)
Finished epoch 65/15000, (130 iterations)
Finished epoch 66/15000, (132 iterations)
Finished epoch 67/15000, (134 iterations)
Finished epoch 68/15000, (136 iterations)
Finished epoch 69/15000, (138 iterations)
Finished epoch 70/15000, (140 iterations)
Finished epoch 71/15000, (142 iterations)
Finished epoch 72/15000, (144 iterations)
Finished epoch 73/15000, (146 iterations)
Finished epoch 74/15000, (148 iterations)
Finished epoch 75/15000, (150 iterations)
Finished epoch 76/15000, (152 iterations)
Finished epoch 77/15000, (154 iterations)
Finished epoch 78/15000, (156 iterations)
Finished epoch 79/15000, (158 iterations)
Finished epoch 80/15000, (160 iterations)
Finished epoch 81/15000, (162 iterations)
Finished epoch 82/15000, (164 iterations)
Finished epoch 83/15000, (166 iterations)
Finished epoch 84/15000, (168 iterations)
Finished epoch 85/15000, (170 iterations)
Finished epoch 86/15000, (172 iterations)
Finished epoch 87/15000, (174 iterations)
Finished epoch 88/15000, (176 iterations)
Finished epoch 89/15000, (178 iterations)
Finished epoch 90/15000, (180 iterations)
Finished epoch 91/15000, (182 iterations)
Finished epoch 92/15000, (184 iterations)
Finished epoch 93/15000, (186 iterations)
Finished epoch 94/15000, (188 iterations)
Finished epoch 95/15000, (190 iterations)
Finished epoch 96/15000, (192 iterations)
Finished epoch 97/15000, (194 iterations)
Finished epoch 98/15000, (196 iterations)
Finished epoch 99/15000, (198 iterations)
Iteration 200 - loss: 0.9761 - rec_loss: 0.9761 - time: 0d-0h-4m-56s - remaining time: 0d-12h-24m-18s

val results:
val/lungOpacity_young_AUROC: 0.5108
val/lungOpacity_old_AUROC: 0.5012
val/lungOpacity_young_AP: 0.5273
val/lungOpacity_old_AP: 0.5410
val/lungOpacity_young_anomaly_score: 1.0080
val/lungOpacity_old_anomaly_score: 1.0075
val/lungOpacity_young_fpr@0.95: 0.9600
val/lungOpacity_old_fpr@0.95: 0.9800
val/lungOpacity_young_subgroupAUROC: 0.4740
val/lungOpacity_old_subgroupAUROC: 0.5492
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.9715
val/lungOpacity_young_rec_loss: 0.9715
val/lungOpacity_old_loss: 0.9708
val/lungOpacity_old_rec_loss: 0.9708

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 0.40 (target: 8.0)
Finished epoch 100/15000, (200 iterations)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 101/15000, (202 iterations)
Finished epoch 102/15000, (204 iterations)
Finished epoch 103/15000, (206 iterations)
Finished epoch 104/15000, (208 iterations)
Finished epoch 105/15000, (210 iterations)
Finished epoch 106/15000, (212 iterations)
Finished epoch 107/15000, (214 iterations)
Finished epoch 108/15000, (216 iterations)
Finished epoch 109/15000, (218 iterations)
Finished epoch 110/15000, (221 iterations)
Finished epoch 111/15000, (223 iterations)
Finished epoch 112/15000, (225 iterations)
Finished epoch 113/15000, (227 iterations)
Finished epoch 114/15000, (229 iterations)
Finished epoch 115/15000, (231 iterations)
Finished epoch 116/15000, (233 iterations)
Finished epoch 117/15000, (235 iterations)
Finished epoch 118/15000, (237 iterations)
Finished epoch 119/15000, (239 iterations)
Finished epoch 120/15000, (241 iterations)
Finished epoch 121/15000, (243 iterations)
Finished epoch 122/15000, (245 iterations)
Finished epoch 123/15000, (247 iterations)
Finished epoch 124/15000, (249 iterations)
Finished epoch 125/15000, (251 iterations)
Finished epoch 126/15000, (253 iterations)
Finished epoch 127/15000, (255 iterations)
Finished epoch 128/15000, (257 iterations)
Finished epoch 129/15000, (259 iterations)
Finished epoch 130/15000, (261 iterations)
Finished epoch 131/15000, (263 iterations)
Finished epoch 132/15000, (266 iterations)
Finished epoch 133/15000, (268 iterations)
Finished epoch 134/15000, (270 iterations)
Finished epoch 135/15000, (272 iterations)
Finished epoch 136/15000, (274 iterations)
Finished epoch 137/15000, (276 iterations)
Finished epoch 138/15000, (278 iterations)
Finished epoch 139/15000, (280 iterations)
Finished epoch 140/15000, (282 iterations)
Finished epoch 141/15000, (284 iterations)
Finished epoch 142/15000, (286 iterations)
Finished epoch 143/15000, (288 iterations)
Finished epoch 144/15000, (290 iterations)
Finished epoch 145/15000, (292 iterations)
Finished epoch 146/15000, (294 iterations)
Finished epoch 147/15000, (296 iterations)
Finished epoch 148/15000, (298 iterations)
Iteration 300 - loss: 0.9709 - rec_loss: 0.9709 - time: 0d-0h-7m-27s - remaining time: 0d-12h-27m-47s
Finished epoch 149/15000, (300 iterations)
Finished epoch 150/15000, (302 iterations)
Finished epoch 151/15000, (304 iterations)
Finished epoch 152/15000, (306 iterations)
Finished epoch 153/15000, (308 iterations)
Finished epoch 154/15000, (310 iterations)
Finished epoch 155/15000, (312 iterations)
Finished epoch 156/15000, (314 iterations)
Finished epoch 157/15000, (316 iterations)
Finished epoch 158/15000, (318 iterations)
Finished epoch 159/15000, (320 iterations)
Finished epoch 160/15000, (322 iterations)
Finished epoch 161/15000, (324 iterations)
Finished epoch 162/15000, (326 iterations)
Finished epoch 163/15000, (328 iterations)
Finished epoch 164/15000, (330 iterations)
Finished epoch 165/15000, (332 iterations)
Finished epoch 166/15000, (334 iterations)
Finished epoch 167/15000, (336 iterations)
Finished epoch 168/15000, (338 iterations)
Finished epoch 169/15000, (340 iterations)
Finished epoch 170/15000, (342 iterations)
Finished epoch 171/15000, (344 iterations)
Finished epoch 172/15000, (346 iterations)
Finished epoch 173/15000, (348 iterations)
Finished epoch 174/15000, (350 iterations)
Finished epoch 175/15000, (352 iterations)
Finished epoch 176/15000, (355 iterations)
Finished epoch 177/15000, (357 iterations)
Finished epoch 178/15000, (359 iterations)
Finished epoch 179/15000, (361 iterations)
Finished epoch 180/15000, (363 iterations)
Finished epoch 181/15000, (365 iterations)
Finished epoch 182/15000, (367 iterations)
Finished epoch 183/15000, (369 iterations)
Finished epoch 184/15000, (371 iterations)
Finished epoch 185/15000, (373 iterations)
Finished epoch 186/15000, (375 iterations)
Finished epoch 187/15000, (377 iterations)
Finished epoch 188/15000, (379 iterations)
Finished epoch 189/15000, (381 iterations)
Finished epoch 190/15000, (383 iterations)
Finished epoch 191/15000, (385 iterations)
Finished epoch 192/15000, (387 iterations)
Finished epoch 193/15000, (389 iterations)
Finished epoch 194/15000, (391 iterations)
Finished epoch 195/15000, (393 iterations)
Finished epoch 196/15000, (395 iterations)
Finished epoch 197/15000, (397 iterations)
Finished epoch 198/15000, (399 iterations)
Iteration 400 - loss: 0.9653 - rec_loss: 0.9653 - time: 0d-0h-9m-54s - remaining time: 0d-12h-20m-54s

val results:
val/lungOpacity_young_AUROC: 0.5392
val/lungOpacity_old_AUROC: 0.5718
val/lungOpacity_young_AP: 0.5535
val/lungOpacity_old_AP: 0.6022
val/lungOpacity_young_anomaly_score: 1.0076
val/lungOpacity_old_anomaly_score: 1.0073
val/lungOpacity_young_fpr@0.95: 0.9600
val/lungOpacity_old_fpr@0.95: 1.0000
val/lungOpacity_young_subgroupAUROC: 0.5240
val/lungOpacity_old_subgroupAUROC: 0.5890
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.1000
val/lungOpacity_young_loss: 0.9588
val/lungOpacity_young_rec_loss: 0.9588
val/lungOpacity_old_loss: 0.9579
val/lungOpacity_old_rec_loss: 0.9579

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 0.59 (target: 8.0)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 199/15000, (401 iterations)
Finished epoch 200/15000, (403 iterations)
Finished epoch 201/15000, (405 iterations)
Finished epoch 202/15000, (407 iterations)
Finished epoch 203/15000, (409 iterations)
Finished epoch 204/15000, (411 iterations)
Finished epoch 205/15000, (413 iterations)
Finished epoch 206/15000, (415 iterations)
Finished epoch 207/15000, (417 iterations)
Finished epoch 208/15000, (419 iterations)
Finished epoch 209/15000, (421 iterations)
Finished epoch 210/15000, (423 iterations)
Finished epoch 211/15000, (425 iterations)
Finished epoch 212/15000, (427 iterations)
Finished epoch 213/15000, (429 iterations)
Finished epoch 214/15000, (431 iterations)
Finished epoch 215/15000, (433 iterations)
Finished epoch 216/15000, (435 iterations)
Finished epoch 217/15000, (437 iterations)
Finished epoch 218/15000, (439 iterations)
Finished epoch 219/15000, (441 iterations)
Finished epoch 220/15000, (443 iterations)
Finished epoch 221/15000, (445 iterations)
Finished epoch 222/15000, (447 iterations)
Finished epoch 223/15000, (449 iterations)
Finished epoch 224/15000, (451 iterations)
Finished epoch 225/15000, (453 iterations)
Finished epoch 226/15000, (455 iterations)
Finished epoch 227/15000, (457 iterations)
Finished epoch 228/15000, (459 iterations)
Finished epoch 229/15000, (461 iterations)
Finished epoch 230/15000, (463 iterations)
Finished epoch 231/15000, (465 iterations)
Finished epoch 232/15000, (467 iterations)
Finished epoch 233/15000, (469 iterations)
Finished epoch 234/15000, (471 iterations)
Finished epoch 235/15000, (473 iterations)
Finished epoch 236/15000, (475 iterations)
Finished epoch 237/15000, (477 iterations)
Finished epoch 238/15000, (479 iterations)
Finished epoch 239/15000, (481 iterations)
Finished epoch 240/15000, (483 iterations)
Finished epoch 241/15000, (485 iterations)
Finished epoch 242/15000, (487 iterations)
Finished epoch 243/15000, (489 iterations)
Finished epoch 244/15000, (491 iterations)
Finished epoch 245/15000, (493 iterations)
Finished epoch 246/15000, (495 iterations)
Finished epoch 247/15000, (497 iterations)
Finished epoch 248/15000, (499 iterations)
Iteration 500 - loss: 0.9600 - rec_loss: 0.9600 - time: 0d-0h-12m-26s - remaining time: 0d-12h-19m-43s
Finished epoch 249/15000, (501 iterations)
Finished epoch 250/15000, (503 iterations)
Finished epoch 251/15000, (505 iterations)
Finished epoch 252/15000, (507 iterations)
Finished epoch 253/15000, (509 iterations)
Finished epoch 254/15000, (512 iterations)
Finished epoch 255/15000, (514 iterations)
Finished epoch 256/15000, (516 iterations)
Finished epoch 257/15000, (518 iterations)
Finished epoch 258/15000, (520 iterations)
Finished epoch 259/15000, (522 iterations)
Finished epoch 260/15000, (524 iterations)
Finished epoch 261/15000, (526 iterations)
Finished epoch 262/15000, (528 iterations)
Finished epoch 263/15000, (530 iterations)
Finished epoch 264/15000, (532 iterations)
Finished epoch 265/15000, (534 iterations)
Finished epoch 266/15000, (536 iterations)
Finished epoch 267/15000, (538 iterations)
Finished epoch 268/15000, (540 iterations)
Finished epoch 269/15000, (542 iterations)
Finished epoch 270/15000, (544 iterations)
Finished epoch 271/15000, (546 iterations)
Finished epoch 272/15000, (548 iterations)
Finished epoch 273/15000, (550 iterations)
Finished epoch 274/15000, (552 iterations)
Finished epoch 275/15000, (554 iterations)
Finished epoch 276/15000, (556 iterations)
Finished epoch 277/15000, (558 iterations)
Finished epoch 278/15000, (560 iterations)
Finished epoch 279/15000, (562 iterations)
Finished epoch 280/15000, (564 iterations)
Finished epoch 281/15000, (566 iterations)
Finished epoch 282/15000, (568 iterations)
Finished epoch 283/15000, (570 iterations)
Finished epoch 284/15000, (572 iterations)
Finished epoch 285/15000, (574 iterations)
Finished epoch 286/15000, (576 iterations)
Finished epoch 287/15000, (578 iterations)
Finished epoch 288/15000, (580 iterations)
Finished epoch 289/15000, (582 iterations)
Finished epoch 290/15000, (584 iterations)
Finished epoch 291/15000, (586 iterations)
Finished epoch 292/15000, (588 iterations)
Finished epoch 293/15000, (590 iterations)
Finished epoch 294/15000, (592 iterations)
Finished epoch 295/15000, (594 iterations)
Finished epoch 296/15000, (596 iterations)
Finished epoch 297/15000, (598 iterations)
Iteration 600 - loss: 0.9554 - rec_loss: 0.9554 - time: 0d-0h-14m-53s - remaining time: 0d-12h-17m-0s

val results:
val/lungOpacity_young_AUROC: 0.4420
val/lungOpacity_old_AUROC: 0.6192
val/lungOpacity_young_AP: 0.4811
val/lungOpacity_old_AP: 0.6063
val/lungOpacity_young_anomaly_score: 1.0074
val/lungOpacity_old_anomaly_score: 1.0067
val/lungOpacity_young_fpr@0.95: 0.9400
val/lungOpacity_old_fpr@0.95: 0.9000
val/lungOpacity_young_subgroupAUROC: 0.4388
val/lungOpacity_old_subgroupAUROC: 0.6272
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.9483
val/lungOpacity_young_rec_loss: 0.9483
val/lungOpacity_old_loss: 0.9471
val/lungOpacity_old_rec_loss: 0.9471

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 0.75 (target: 8.0)
Finished epoch 298/15000, (600 iterations)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 299/15000, (602 iterations)
Finished epoch 300/15000, (604 iterations)
Finished epoch 301/15000, (606 iterations)
Finished epoch 302/15000, (608 iterations)
Finished epoch 303/15000, (610 iterations)
Finished epoch 304/15000, (612 iterations)
Finished epoch 305/15000, (614 iterations)
Finished epoch 306/15000, (616 iterations)
Finished epoch 307/15000, (619 iterations)
Finished epoch 308/15000, (621 iterations)
Finished epoch 309/15000, (623 iterations)
Finished epoch 310/15000, (625 iterations)
Finished epoch 311/15000, (627 iterations)
Finished epoch 312/15000, (629 iterations)
Finished epoch 313/15000, (631 iterations)
Finished epoch 314/15000, (633 iterations)
Finished epoch 315/15000, (635 iterations)
Finished epoch 316/15000, (637 iterations)
Finished epoch 317/15000, (639 iterations)
Finished epoch 318/15000, (641 iterations)
Finished epoch 319/15000, (643 iterations)
Finished epoch 320/15000, (645 iterations)
Finished epoch 321/15000, (647 iterations)
Finished epoch 322/15000, (649 iterations)
Finished epoch 323/15000, (651 iterations)
Finished epoch 324/15000, (653 iterations)
Finished epoch 325/15000, (655 iterations)
Finished epoch 326/15000, (657 iterations)
Finished epoch 327/15000, (659 iterations)
Finished epoch 328/15000, (661 iterations)
Finished epoch 329/15000, (664 iterations)
Finished epoch 330/15000, (666 iterations)
Finished epoch 331/15000, (668 iterations)
Finished epoch 332/15000, (670 iterations)
Finished epoch 333/15000, (672 iterations)
Finished epoch 334/15000, (674 iterations)
Finished epoch 335/15000, (676 iterations)
Finished epoch 336/15000, (678 iterations)
Finished epoch 337/15000, (680 iterations)
Finished epoch 338/15000, (682 iterations)
Finished epoch 339/15000, (684 iterations)
Finished epoch 340/15000, (686 iterations)
Finished epoch 341/15000, (688 iterations)
Finished epoch 342/15000, (690 iterations)
Finished epoch 343/15000, (692 iterations)
Finished epoch 344/15000, (694 iterations)
Finished epoch 345/15000, (696 iterations)
Finished epoch 346/15000, (698 iterations)
Iteration 700 - loss: 0.9512 - rec_loss: 0.9512 - time: 0d-0h-17m-23s - remaining time: 0d-12h-16m-42s
Finished epoch 347/15000, (700 iterations)
Finished epoch 348/15000, (702 iterations)
Finished epoch 349/15000, (704 iterations)
Finished epoch 350/15000, (706 iterations)
Finished epoch 351/15000, (708 iterations)
Finished epoch 352/15000, (710 iterations)
Finished epoch 353/15000, (712 iterations)
Finished epoch 354/15000, (714 iterations)
Finished epoch 355/15000, (716 iterations)
Finished epoch 356/15000, (718 iterations)
Finished epoch 357/15000, (720 iterations)
Finished epoch 358/15000, (722 iterations)
Finished epoch 359/15000, (724 iterations)
Finished epoch 360/15000, (726 iterations)
Finished epoch 361/15000, (728 iterations)
Finished epoch 362/15000, (730 iterations)
Finished epoch 363/15000, (732 iterations)
Finished epoch 364/15000, (734 iterations)
Finished epoch 365/15000, (736 iterations)
Finished epoch 366/15000, (738 iterations)
Finished epoch 367/15000, (740 iterations)
Finished epoch 368/15000, (742 iterations)
Finished epoch 369/15000, (744 iterations)
Finished epoch 370/15000, (746 iterations)
Finished epoch 371/15000, (748 iterations)
Finished epoch 372/15000, (750 iterations)
Finished epoch 373/15000, (752 iterations)
Finished epoch 374/15000, (754 iterations)
Finished epoch 375/15000, (756 iterations)
Finished epoch 376/15000, (758 iterations)
Finished epoch 377/15000, (760 iterations)
Finished epoch 378/15000, (762 iterations)
Finished epoch 379/15000, (764 iterations)
Finished epoch 380/15000, (766 iterations)
Finished epoch 381/15000, (768 iterations)
Finished epoch 382/15000, (770 iterations)
Finished epoch 383/15000, (772 iterations)
Finished epoch 384/15000, (774 iterations)
Finished epoch 385/15000, (776 iterations)
Finished epoch 386/15000, (778 iterations)
Finished epoch 387/15000, (780 iterations)
Finished epoch 388/15000, (782 iterations)
Finished epoch 389/15000, (784 iterations)
Finished epoch 390/15000, (786 iterations)
Finished epoch 391/15000, (788 iterations)
Finished epoch 392/15000, (790 iterations)
Finished epoch 393/15000, (792 iterations)
Finished epoch 394/15000, (794 iterations)
Finished epoch 395/15000, (796 iterations)
Finished epoch 396/15000, (798 iterations)
Iteration 800 - loss: 0.9472 - rec_loss: 0.9472 - time: 0d-0h-19m-51s - remaining time: 0d-12h-12m-5s

val results:
val/lungOpacity_young_AUROC: 0.4494
val/lungOpacity_old_AUROC: 0.6396
val/lungOpacity_young_AP: 0.4987
val/lungOpacity_old_AP: 0.6171
val/lungOpacity_young_anomaly_score: 1.0077
val/lungOpacity_old_anomaly_score: 1.0067
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.4392
val/lungOpacity_old_subgroupAUROC: 0.6600
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.9396
val/lungOpacity_young_rec_loss: 0.9396
val/lungOpacity_old_loss: 0.9380
val/lungOpacity_old_rec_loss: 0.9380

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 0.89 (target: 8.0)
Finished epoch 397/15000, (800 iterations)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 398/15000, (802 iterations)
Finished epoch 399/15000, (804 iterations)
Finished epoch 400/15000, (806 iterations)
Finished epoch 401/15000, (808 iterations)
Finished epoch 402/15000, (810 iterations)
Finished epoch 403/15000, (812 iterations)
Finished epoch 404/15000, (814 iterations)
Finished epoch 405/15000, (816 iterations)
Finished epoch 406/15000, (818 iterations)
Finished epoch 407/15000, (820 iterations)
Finished epoch 408/15000, (822 iterations)
Finished epoch 409/15000, (824 iterations)
Finished epoch 410/15000, (826 iterations)
Finished epoch 411/15000, (828 iterations)
Finished epoch 412/15000, (830 iterations)
Finished epoch 413/15000, (832 iterations)
Finished epoch 414/15000, (834 iterations)
Finished epoch 415/15000, (836 iterations)
Finished epoch 416/15000, (838 iterations)
Finished epoch 417/15000, (840 iterations)
Finished epoch 418/15000, (842 iterations)
Finished epoch 419/15000, (844 iterations)
Finished epoch 420/15000, (846 iterations)
Finished epoch 421/15000, (848 iterations)
Finished epoch 422/15000, (850 iterations)
Finished epoch 423/15000, (852 iterations)
Finished epoch 424/15000, (854 iterations)
Finished epoch 425/15000, (856 iterations)
Finished epoch 426/15000, (858 iterations)
Finished epoch 427/15000, (860 iterations)
Finished epoch 428/15000, (862 iterations)
Finished epoch 429/15000, (864 iterations)
Finished epoch 430/15000, (866 iterations)
Finished epoch 431/15000, (868 iterations)
Finished epoch 432/15000, (870 iterations)
Finished epoch 433/15000, (872 iterations)
Finished epoch 434/15000, (874 iterations)
Finished epoch 435/15000, (876 iterations)
Finished epoch 436/15000, (878 iterations)
Finished epoch 437/15000, (880 iterations)
Finished epoch 438/15000, (882 iterations)
Finished epoch 439/15000, (884 iterations)
Finished epoch 440/15000, (886 iterations)
Finished epoch 441/15000, (888 iterations)
Finished epoch 442/15000, (890 iterations)
Finished epoch 443/15000, (892 iterations)
Finished epoch 444/15000, (894 iterations)
Finished epoch 445/15000, (896 iterations)
Finished epoch 446/15000, (898 iterations)
Iteration 900 - loss: 0.9435 - rec_loss: 0.9435 - time: 0d-0h-22m-21s - remaining time: 0d-12h-9m-40s
Finished epoch 447/15000, (900 iterations)
Finished epoch 448/15000, (902 iterations)
Finished epoch 449/15000, (904 iterations)
Finished epoch 450/15000, (906 iterations)
Finished epoch 451/15000, (908 iterations)
Finished epoch 452/15000, (910 iterations)
Finished epoch 453/15000, (912 iterations)
Finished epoch 454/15000, (914 iterations)
Finished epoch 455/15000, (916 iterations)
Finished epoch 456/15000, (918 iterations)
Finished epoch 457/15000, (920 iterations)
Finished epoch 458/15000, (922 iterations)
Finished epoch 459/15000, (924 iterations)
Finished epoch 460/15000, (926 iterations)
Finished epoch 461/15000, (928 iterations)
Finished epoch 462/15000, (930 iterations)
Finished epoch 463/15000, (932 iterations)
Finished epoch 464/15000, (934 iterations)
Finished epoch 465/15000, (936 iterations)
Finished epoch 466/15000, (938 iterations)
Finished epoch 467/15000, (940 iterations)
Finished epoch 468/15000, (942 iterations)
Finished epoch 469/15000, (944 iterations)
Finished epoch 470/15000, (946 iterations)
Finished epoch 471/15000, (948 iterations)
Finished epoch 472/15000, (950 iterations)
Finished epoch 473/15000, (952 iterations)
Finished epoch 474/15000, (954 iterations)
Finished epoch 475/15000, (956 iterations)
Finished epoch 476/15000, (958 iterations)
Finished epoch 477/15000, (960 iterations)
Finished epoch 478/15000, (962 iterations)
Finished epoch 479/15000, (964 iterations)
Finished epoch 480/15000, (966 iterations)
Finished epoch 481/15000, (968 iterations)
Finished epoch 482/15000, (970 iterations)
Finished epoch 483/15000, (972 iterations)
Finished epoch 484/15000, (974 iterations)
Finished epoch 485/15000, (976 iterations)
Finished epoch 486/15000, (978 iterations)
Finished epoch 487/15000, (980 iterations)
Finished epoch 488/15000, (982 iterations)
Finished epoch 489/15000, (984 iterations)
Finished epoch 490/15000, (986 iterations)
Finished epoch 491/15000, (988 iterations)
Finished epoch 492/15000, (990 iterations)
Finished epoch 493/15000, (992 iterations)
Finished epoch 494/15000, (994 iterations)
Finished epoch 495/15000, (996 iterations)
Finished epoch 496/15000, (998 iterations)
Iteration 1000 - loss: 0.9398 - rec_loss: 0.9398 - time: 0d-0h-24m-49s - remaining time: 0d-12h-6m-9s

val results:
val/lungOpacity_young_AUROC: 0.5184
val/lungOpacity_old_AUROC: 0.6824
val/lungOpacity_young_AP: 0.5629
val/lungOpacity_old_AP: 0.6580
val/lungOpacity_young_anomaly_score: 1.0078
val/lungOpacity_old_anomaly_score: 1.0069
val/lungOpacity_young_fpr@0.95: 0.9400
val/lungOpacity_old_fpr@0.95: 0.8600
val/lungOpacity_young_subgroupAUROC: 0.5062
val/lungOpacity_old_subgroupAUROC: 0.6908
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.9315
val/lungOpacity_young_rec_loss: 0.9315
val/lungOpacity_old_loss: 0.9297
val/lungOpacity_old_rec_loss: 0.9297

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 1.01 (target: 8.0)
Finished epoch 497/15000, (1000 iterations)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 498/15000, (1002 iterations)
Finished epoch 499/15000, (1004 iterations)
Finished epoch 500/15000, (1006 iterations)
Finished epoch 501/15000, (1008 iterations)
Finished epoch 502/15000, (1010 iterations)
Finished epoch 503/15000, (1012 iterations)
Finished epoch 504/15000, (1014 iterations)
Finished epoch 505/15000, (1016 iterations)
Finished epoch 506/15000, (1018 iterations)
Finished epoch 507/15000, (1020 iterations)
Finished epoch 508/15000, (1022 iterations)
Finished epoch 509/15000, (1024 iterations)
Finished epoch 510/15000, (1026 iterations)
Finished epoch 511/15000, (1028 iterations)
Finished epoch 512/15000, (1030 iterations)
Finished epoch 513/15000, (1032 iterations)
Finished epoch 514/15000, (1034 iterations)
Finished epoch 515/15000, (1036 iterations)
Finished epoch 516/15000, (1038 iterations)
Finished epoch 517/15000, (1040 iterations)
Finished epoch 518/15000, (1042 iterations)
Finished epoch 519/15000, (1045 iterations)
Finished epoch 520/15000, (1047 iterations)
Finished epoch 521/15000, (1049 iterations)
Finished epoch 522/15000, (1051 iterations)
Finished epoch 523/15000, (1053 iterations)
Finished epoch 524/15000, (1055 iterations)
Finished epoch 525/15000, (1057 iterations)
Finished epoch 526/15000, (1059 iterations)
Finished epoch 527/15000, (1061 iterations)
Finished epoch 528/15000, (1063 iterations)
Finished epoch 529/15000, (1065 iterations)
Finished epoch 530/15000, (1067 iterations)
Finished epoch 531/15000, (1069 iterations)
Finished epoch 532/15000, (1071 iterations)
Finished epoch 533/15000, (1073 iterations)
Finished epoch 534/15000, (1075 iterations)
Finished epoch 535/15000, (1077 iterations)
Finished epoch 536/15000, (1079 iterations)
Finished epoch 537/15000, (1081 iterations)
Finished epoch 538/15000, (1083 iterations)
Finished epoch 539/15000, (1085 iterations)
Finished epoch 540/15000, (1087 iterations)
Finished epoch 541/15000, (1089 iterations)
Finished epoch 542/15000, (1091 iterations)
Finished epoch 543/15000, (1093 iterations)
Finished epoch 544/15000, (1095 iterations)
Finished epoch 545/15000, (1097 iterations)
Finished epoch 546/15000, (1099 iterations)
Iteration 1100 - loss: 0.9364 - rec_loss: 0.9364 - time: 0d-0h-27m-20s - remaining time: 0d-12h-3m-44s
Finished epoch 547/15000, (1101 iterations)
Finished epoch 548/15000, (1103 iterations)
Finished epoch 549/15000, (1105 iterations)
Finished epoch 550/15000, (1107 iterations)
Finished epoch 551/15000, (1109 iterations)
Finished epoch 552/15000, (1111 iterations)
Finished epoch 553/15000, (1113 iterations)
Finished epoch 554/15000, (1115 iterations)
Finished epoch 555/15000, (1117 iterations)
Finished epoch 556/15000, (1119 iterations)
Finished epoch 557/15000, (1121 iterations)
Finished epoch 558/15000, (1123 iterations)
Finished epoch 559/15000, (1125 iterations)
Finished epoch 560/15000, (1127 iterations)
Finished epoch 561/15000, (1129 iterations)
Finished epoch 562/15000, (1131 iterations)
Finished epoch 563/15000, (1133 iterations)
Finished epoch 564/15000, (1135 iterations)
Finished epoch 565/15000, (1137 iterations)
Finished epoch 566/15000, (1139 iterations)
Finished epoch 567/15000, (1141 iterations)
Finished epoch 568/15000, (1143 iterations)
Finished epoch 569/15000, (1145 iterations)
Finished epoch 570/15000, (1147 iterations)
Finished epoch 571/15000, (1149 iterations)
Finished epoch 572/15000, (1151 iterations)
Finished epoch 573/15000, (1153 iterations)
Finished epoch 574/15000, (1155 iterations)
Finished epoch 575/15000, (1157 iterations)
Finished epoch 576/15000, (1159 iterations)
Finished epoch 577/15000, (1161 iterations)
Finished epoch 578/15000, (1163 iterations)
Finished epoch 579/15000, (1165 iterations)
Finished epoch 580/15000, (1167 iterations)
Finished epoch 581/15000, (1169 iterations)
Finished epoch 582/15000, (1171 iterations)
Finished epoch 583/15000, (1173 iterations)
Finished epoch 584/15000, (1175 iterations)
Finished epoch 585/15000, (1177 iterations)
Finished epoch 586/15000, (1179 iterations)
Finished epoch 587/15000, (1181 iterations)
Finished epoch 588/15000, (1183 iterations)
Finished epoch 589/15000, (1185 iterations)
Finished epoch 590/15000, (1187 iterations)
Finished epoch 591/15000, (1189 iterations)
Finished epoch 592/15000, (1191 iterations)
Finished epoch 593/15000, (1193 iterations)
Finished epoch 594/15000, (1195 iterations)
Finished epoch 595/15000, (1197 iterations)
Finished epoch 596/15000, (1199 iterations)
Iteration 1200 - loss: 0.9330 - rec_loss: 0.9330 - time: 0d-0h-29m-48s - remaining time: 0d-12h-0m-19s

val results:
val/lungOpacity_young_AUROC: 0.5648
val/lungOpacity_old_AUROC: 0.7160
val/lungOpacity_young_AP: 0.5919
val/lungOpacity_old_AP: 0.6527
val/lungOpacity_young_anomaly_score: 1.0081
val/lungOpacity_old_anomaly_score: 1.0068
val/lungOpacity_young_fpr@0.95: 0.9000
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.5424
val/lungOpacity_old_subgroupAUROC: 0.7222
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.9247
val/lungOpacity_young_rec_loss: 0.9247
val/lungOpacity_old_loss: 0.9227
val/lungOpacity_old_rec_loss: 0.9227

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 1.13 (target: 8.0)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 597/15000, (1201 iterations)
Finished epoch 598/15000, (1203 iterations)
Finished epoch 599/15000, (1205 iterations)
Finished epoch 600/15000, (1207 iterations)
Finished epoch 601/15000, (1209 iterations)
Finished epoch 602/15000, (1211 iterations)
Finished epoch 603/15000, (1213 iterations)
Finished epoch 604/15000, (1215 iterations)
Finished epoch 605/15000, (1217 iterations)
Finished epoch 606/15000, (1219 iterations)
Finished epoch 607/15000, (1221 iterations)
Finished epoch 608/15000, (1223 iterations)
Finished epoch 609/15000, (1225 iterations)
Finished epoch 610/15000, (1227 iterations)
Finished epoch 611/15000, (1229 iterations)
Finished epoch 612/15000, (1231 iterations)
Finished epoch 613/15000, (1233 iterations)
Finished epoch 614/15000, (1235 iterations)
Finished epoch 615/15000, (1238 iterations)
Finished epoch 616/15000, (1240 iterations)
Finished epoch 617/15000, (1242 iterations)
Finished epoch 618/15000, (1244 iterations)
Finished epoch 619/15000, (1246 iterations)
Finished epoch 620/15000, (1248 iterations)
Finished epoch 621/15000, (1250 iterations)
Finished epoch 622/15000, (1252 iterations)
Finished epoch 623/15000, (1254 iterations)
Finished epoch 624/15000, (1256 iterations)
Finished epoch 625/15000, (1258 iterations)
Finished epoch 626/15000, (1260 iterations)
Finished epoch 627/15000, (1262 iterations)
Finished epoch 628/15000, (1264 iterations)
Finished epoch 629/15000, (1266 iterations)
Finished epoch 630/15000, (1268 iterations)
Finished epoch 631/15000, (1270 iterations)
Finished epoch 632/15000, (1272 iterations)
Finished epoch 633/15000, (1274 iterations)
Finished epoch 634/15000, (1276 iterations)
Finished epoch 635/15000, (1278 iterations)
Finished epoch 636/15000, (1280 iterations)
Finished epoch 637/15000, (1282 iterations)
Finished epoch 638/15000, (1284 iterations)
Finished epoch 639/15000, (1286 iterations)
Finished epoch 640/15000, (1288 iterations)
Finished epoch 641/15000, (1291 iterations)
Finished epoch 642/15000, (1293 iterations)
Finished epoch 643/15000, (1295 iterations)
Finished epoch 644/15000, (1297 iterations)
Finished epoch 645/15000, (1299 iterations)
Iteration 1300 - loss: 0.9300 - rec_loss: 0.9300 - time: 0d-0h-32m-17s - remaining time: 0d-11h-58m-48s
Finished epoch 646/15000, (1301 iterations)
Finished epoch 647/15000, (1303 iterations)
Finished epoch 648/15000, (1305 iterations)
Finished epoch 649/15000, (1307 iterations)
Finished epoch 650/15000, (1309 iterations)
Finished epoch 651/15000, (1311 iterations)
Finished epoch 652/15000, (1313 iterations)
Finished epoch 653/15000, (1315 iterations)
Finished epoch 654/15000, (1317 iterations)
Finished epoch 655/15000, (1319 iterations)
Finished epoch 656/15000, (1321 iterations)
Finished epoch 657/15000, (1323 iterations)
Finished epoch 658/15000, (1325 iterations)
Finished epoch 659/15000, (1327 iterations)
Finished epoch 660/15000, (1329 iterations)
Finished epoch 661/15000, (1331 iterations)
Finished epoch 662/15000, (1333 iterations)
Finished epoch 663/15000, (1335 iterations)
Finished epoch 664/15000, (1337 iterations)
Finished epoch 665/15000, (1339 iterations)
Finished epoch 666/15000, (1341 iterations)
Finished epoch 667/15000, (1343 iterations)
Finished epoch 668/15000, (1345 iterations)
Finished epoch 669/15000, (1347 iterations)
Finished epoch 670/15000, (1349 iterations)
Finished epoch 671/15000, (1351 iterations)
Finished epoch 672/15000, (1353 iterations)
Finished epoch 673/15000, (1355 iterations)
Finished epoch 674/15000, (1357 iterations)
Finished epoch 675/15000, (1359 iterations)
Finished epoch 676/15000, (1361 iterations)
Finished epoch 677/15000, (1363 iterations)
Finished epoch 678/15000, (1365 iterations)
Finished epoch 679/15000, (1367 iterations)
Finished epoch 680/15000, (1369 iterations)
Finished epoch 681/15000, (1371 iterations)
Finished epoch 682/15000, (1373 iterations)
Finished epoch 683/15000, (1375 iterations)
Finished epoch 684/15000, (1377 iterations)
Finished epoch 685/15000, (1379 iterations)
Finished epoch 686/15000, (1381 iterations)
Finished epoch 687/15000, (1383 iterations)
Finished epoch 688/15000, (1385 iterations)
Finished epoch 689/15000, (1387 iterations)
Finished epoch 690/15000, (1389 iterations)
Finished epoch 691/15000, (1391 iterations)
Finished epoch 692/15000, (1393 iterations)
Finished epoch 693/15000, (1395 iterations)
Finished epoch 694/15000, (1397 iterations)
Finished epoch 695/15000, (1399 iterations)
Iteration 1400 - loss: 0.9271 - rec_loss: 0.9271 - time: 0d-0h-34m-45s - remaining time: 0d-11h-55m-23s

val results:
val/lungOpacity_young_AUROC: 0.5688
val/lungOpacity_old_AUROC: 0.7048
val/lungOpacity_young_AP: 0.5749
val/lungOpacity_old_AP: 0.6280
val/lungOpacity_young_anomaly_score: 1.0086
val/lungOpacity_old_anomaly_score: 1.0069
val/lungOpacity_young_fpr@0.95: 0.9200
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.5418
val/lungOpacity_old_subgroupAUROC: 0.7182
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.9186
val/lungOpacity_young_rec_loss: 0.9186
val/lungOpacity_old_loss: 0.9164
val/lungOpacity_old_rec_loss: 0.9164

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 1.24 (target: 8.0)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 696/15000, (1401 iterations)
Finished epoch 697/15000, (1403 iterations)
Finished epoch 698/15000, (1405 iterations)
Finished epoch 699/15000, (1407 iterations)
Finished epoch 700/15000, (1409 iterations)
Finished epoch 701/15000, (1411 iterations)
Finished epoch 702/15000, (1413 iterations)
Finished epoch 703/15000, (1415 iterations)
Finished epoch 704/15000, (1417 iterations)
Finished epoch 705/15000, (1419 iterations)
Finished epoch 706/15000, (1421 iterations)
Finished epoch 707/15000, (1423 iterations)
Finished epoch 708/15000, (1425 iterations)
Finished epoch 709/15000, (1427 iterations)
Finished epoch 710/15000, (1429 iterations)
Finished epoch 711/15000, (1431 iterations)
Finished epoch 712/15000, (1433 iterations)
Finished epoch 713/15000, (1435 iterations)
Finished epoch 714/15000, (1437 iterations)
Finished epoch 715/15000, (1439 iterations)
Finished epoch 716/15000, (1441 iterations)
Finished epoch 717/15000, (1443 iterations)
Finished epoch 718/15000, (1445 iterations)
Finished epoch 719/15000, (1447 iterations)
Finished epoch 720/15000, (1449 iterations)
Finished epoch 721/15000, (1451 iterations)
Finished epoch 722/15000, (1453 iterations)
Finished epoch 723/15000, (1455 iterations)
Finished epoch 724/15000, (1457 iterations)
Finished epoch 725/15000, (1459 iterations)
Finished epoch 726/15000, (1461 iterations)
Finished epoch 727/15000, (1463 iterations)
Finished epoch 728/15000, (1465 iterations)
Finished epoch 729/15000, (1467 iterations)
Finished epoch 730/15000, (1469 iterations)
Finished epoch 731/15000, (1471 iterations)
Finished epoch 732/15000, (1473 iterations)
Finished epoch 733/15000, (1475 iterations)
Finished epoch 734/15000, (1477 iterations)
Finished epoch 735/15000, (1479 iterations)
Finished epoch 736/15000, (1481 iterations)
Finished epoch 737/15000, (1483 iterations)
Finished epoch 738/15000, (1485 iterations)
Finished epoch 739/15000, (1487 iterations)
Finished epoch 740/15000, (1489 iterations)
Finished epoch 741/15000, (1491 iterations)
Finished epoch 742/15000, (1493 iterations)
Finished epoch 743/15000, (1495 iterations)
Finished epoch 744/15000, (1497 iterations)
Iteration 1500 - loss: 0.9244 - rec_loss: 0.9244 - time: 0d-0h-37m-16s - remaining time: 0d-11h-54m-8s
Finished epoch 745/15000, (1500 iterations)
Finished epoch 746/15000, (1502 iterations)
Finished epoch 747/15000, (1504 iterations)
Finished epoch 748/15000, (1506 iterations)
Finished epoch 749/15000, (1508 iterations)
Finished epoch 750/15000, (1510 iterations)
Finished epoch 751/15000, (1512 iterations)
Finished epoch 752/15000, (1514 iterations)
Finished epoch 753/15000, (1516 iterations)
Finished epoch 754/15000, (1518 iterations)
Finished epoch 755/15000, (1520 iterations)
Finished epoch 756/15000, (1522 iterations)
Finished epoch 757/15000, (1524 iterations)
Finished epoch 758/15000, (1526 iterations)
Finished epoch 759/15000, (1529 iterations)
Finished epoch 760/15000, (1531 iterations)
Finished epoch 761/15000, (1533 iterations)
Finished epoch 762/15000, (1535 iterations)
Finished epoch 763/15000, (1537 iterations)
Finished epoch 764/15000, (1539 iterations)
Finished epoch 765/15000, (1541 iterations)
Finished epoch 766/15000, (1543 iterations)
Finished epoch 767/15000, (1545 iterations)
Finished epoch 768/15000, (1547 iterations)
Finished epoch 769/15000, (1549 iterations)
Finished epoch 770/15000, (1551 iterations)
Finished epoch 771/15000, (1553 iterations)
Finished epoch 772/15000, (1555 iterations)
Finished epoch 773/15000, (1557 iterations)
Finished epoch 774/15000, (1559 iterations)
Finished epoch 775/15000, (1561 iterations)
Finished epoch 776/15000, (1563 iterations)
Finished epoch 777/15000, (1565 iterations)
Finished epoch 778/15000, (1567 iterations)
Finished epoch 779/15000, (1569 iterations)
Finished epoch 780/15000, (1571 iterations)
Finished epoch 781/15000, (1573 iterations)
Finished epoch 782/15000, (1575 iterations)
Finished epoch 783/15000, (1577 iterations)
Finished epoch 784/15000, (1579 iterations)
Finished epoch 785/15000, (1581 iterations)
Finished epoch 786/15000, (1583 iterations)
Finished epoch 787/15000, (1585 iterations)
Finished epoch 788/15000, (1587 iterations)
Finished epoch 789/15000, (1589 iterations)
Finished epoch 790/15000, (1591 iterations)
Finished epoch 791/15000, (1593 iterations)
Finished epoch 792/15000, (1595 iterations)
Finished epoch 793/15000, (1597 iterations)
Finished epoch 794/15000, (1599 iterations)
Iteration 1600 - loss: 0.9222 - rec_loss: 0.9222 - time: 0d-0h-39m-43s - remaining time: 0d-11h-50m-52s

val results:
val/lungOpacity_young_AUROC: 0.5592
val/lungOpacity_old_AUROC: 0.7188
val/lungOpacity_young_AP: 0.5584
val/lungOpacity_old_AP: 0.6345
val/lungOpacity_young_anomaly_score: 1.0089
val/lungOpacity_old_anomaly_score: 1.0073
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.5402
val/lungOpacity_old_subgroupAUROC: 0.7242
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.9136
val/lungOpacity_young_rec_loss: 0.9136
val/lungOpacity_old_loss: 0.9112
val/lungOpacity_old_rec_loss: 0.9112

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 1.34 (target: 8.0)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 795/15000, (1601 iterations)
Finished epoch 796/15000, (1603 iterations)
Finished epoch 797/15000, (1605 iterations)
Finished epoch 798/15000, (1607 iterations)
Finished epoch 799/15000, (1609 iterations)
Finished epoch 800/15000, (1611 iterations)
Finished epoch 801/15000, (1613 iterations)
Finished epoch 802/15000, (1615 iterations)
Finished epoch 803/15000, (1617 iterations)
Finished epoch 804/15000, (1620 iterations)
Finished epoch 805/15000, (1622 iterations)
Finished epoch 806/15000, (1624 iterations)
Finished epoch 807/15000, (1626 iterations)
Finished epoch 808/15000, (1628 iterations)
Finished epoch 809/15000, (1630 iterations)
Finished epoch 810/15000, (1632 iterations)
Finished epoch 811/15000, (1634 iterations)
Finished epoch 812/15000, (1636 iterations)
Finished epoch 813/15000, (1638 iterations)
Finished epoch 814/15000, (1640 iterations)
Finished epoch 815/15000, (1642 iterations)
Finished epoch 816/15000, (1644 iterations)
Finished epoch 817/15000, (1646 iterations)
Finished epoch 818/15000, (1648 iterations)
Finished epoch 819/15000, (1650 iterations)
Finished epoch 820/15000, (1652 iterations)
Finished epoch 821/15000, (1654 iterations)
Finished epoch 822/15000, (1656 iterations)
Finished epoch 823/15000, (1658 iterations)
Finished epoch 824/15000, (1660 iterations)
Finished epoch 825/15000, (1662 iterations)
Finished epoch 826/15000, (1664 iterations)
Finished epoch 827/15000, (1666 iterations)
Finished epoch 828/15000, (1668 iterations)
Finished epoch 829/15000, (1670 iterations)
Finished epoch 830/15000, (1672 iterations)
Finished epoch 831/15000, (1674 iterations)
Finished epoch 832/15000, (1676 iterations)
Finished epoch 833/15000, (1678 iterations)
Finished epoch 834/15000, (1680 iterations)
Finished epoch 835/15000, (1682 iterations)
Finished epoch 836/15000, (1684 iterations)
Finished epoch 837/15000, (1686 iterations)
Finished epoch 838/15000, (1688 iterations)
Finished epoch 839/15000, (1690 iterations)
Finished epoch 840/15000, (1692 iterations)
Finished epoch 841/15000, (1694 iterations)
Finished epoch 842/15000, (1696 iterations)
Finished epoch 843/15000, (1698 iterations)
Iteration 1700 - loss: 0.9198 - rec_loss: 0.9198 - time: 0d-0h-42m-14s - remaining time: 0d-11h-49m-27s
Finished epoch 844/15000, (1700 iterations)
Finished epoch 845/15000, (1702 iterations)
Finished epoch 846/15000, (1704 iterations)
Finished epoch 847/15000, (1706 iterations)
Finished epoch 848/15000, (1708 iterations)
Finished epoch 849/15000, (1710 iterations)
Finished epoch 850/15000, (1712 iterations)
Finished epoch 851/15000, (1714 iterations)
Finished epoch 852/15000, (1716 iterations)
Finished epoch 853/15000, (1718 iterations)
Finished epoch 854/15000, (1720 iterations)
Finished epoch 855/15000, (1722 iterations)
Finished epoch 856/15000, (1724 iterations)
Finished epoch 857/15000, (1726 iterations)
Finished epoch 858/15000, (1728 iterations)
Finished epoch 859/15000, (1730 iterations)
Finished epoch 860/15000, (1732 iterations)
Finished epoch 861/15000, (1734 iterations)
Finished epoch 862/15000, (1736 iterations)
Finished epoch 863/15000, (1738 iterations)
Finished epoch 864/15000, (1740 iterations)
Finished epoch 865/15000, (1742 iterations)
Finished epoch 866/15000, (1744 iterations)
Finished epoch 867/15000, (1746 iterations)
Finished epoch 868/15000, (1748 iterations)
Finished epoch 869/15000, (1750 iterations)
Finished epoch 870/15000, (1752 iterations)
Finished epoch 871/15000, (1754 iterations)
Finished epoch 872/15000, (1756 iterations)
Finished epoch 873/15000, (1758 iterations)
Finished epoch 874/15000, (1760 iterations)
Finished epoch 875/15000, (1762 iterations)
Finished epoch 876/15000, (1764 iterations)
Finished epoch 877/15000, (1766 iterations)
Finished epoch 878/15000, (1768 iterations)
Finished epoch 879/15000, (1770 iterations)
Finished epoch 880/15000, (1772 iterations)
Finished epoch 881/15000, (1774 iterations)
Finished epoch 882/15000, (1776 iterations)
Finished epoch 883/15000, (1778 iterations)
Finished epoch 884/15000, (1781 iterations)
Finished epoch 885/15000, (1783 iterations)
Finished epoch 886/15000, (1785 iterations)
Finished epoch 887/15000, (1787 iterations)
Finished epoch 888/15000, (1789 iterations)
Finished epoch 889/15000, (1791 iterations)
Finished epoch 890/15000, (1794 iterations)
Finished epoch 891/15000, (1796 iterations)
Finished epoch 892/15000, (1798 iterations)
Iteration 1800 - loss: 0.9176 - rec_loss: 0.9176 - time: 0d-0h-44m-41s - remaining time: 0d-11h-46m-57s

val results:
val/lungOpacity_young_AUROC: 0.5512
val/lungOpacity_old_AUROC: 0.6980
val/lungOpacity_young_AP: 0.5523
val/lungOpacity_old_AP: 0.6507
val/lungOpacity_young_anomaly_score: 1.0093
val/lungOpacity_old_anomaly_score: 1.0073
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.5232
val/lungOpacity_old_subgroupAUROC: 0.7136
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.9091
val/lungOpacity_young_rec_loss: 0.9091
val/lungOpacity_old_loss: 0.9064
val/lungOpacity_old_rec_loss: 0.9064

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 1.43 (target: 8.0)
Finished epoch 893/15000, (1800 iterations)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 894/15000, (1802 iterations)
Finished epoch 895/15000, (1804 iterations)
Finished epoch 896/15000, (1806 iterations)
Finished epoch 897/15000, (1808 iterations)
Finished epoch 898/15000, (1810 iterations)
Finished epoch 899/15000, (1812 iterations)
Finished epoch 900/15000, (1814 iterations)
Finished epoch 901/15000, (1816 iterations)
Finished epoch 902/15000, (1818 iterations)
Finished epoch 903/15000, (1820 iterations)
Finished epoch 904/15000, (1822 iterations)
Finished epoch 905/15000, (1824 iterations)
Finished epoch 906/15000, (1826 iterations)
Finished epoch 907/15000, (1828 iterations)
Finished epoch 908/15000, (1830 iterations)
Finished epoch 909/15000, (1832 iterations)
Finished epoch 910/15000, (1834 iterations)
Finished epoch 911/15000, (1836 iterations)
Finished epoch 912/15000, (1839 iterations)
Finished epoch 913/15000, (1841 iterations)
Finished epoch 914/15000, (1843 iterations)
Finished epoch 915/15000, (1845 iterations)
Finished epoch 916/15000, (1847 iterations)
Finished epoch 917/15000, (1849 iterations)
Finished epoch 918/15000, (1851 iterations)
Finished epoch 919/15000, (1853 iterations)
Finished epoch 920/15000, (1855 iterations)
Finished epoch 921/15000, (1857 iterations)
Finished epoch 922/15000, (1859 iterations)
Finished epoch 923/15000, (1861 iterations)
Finished epoch 924/15000, (1863 iterations)
Finished epoch 925/15000, (1865 iterations)
Finished epoch 926/15000, (1867 iterations)
Finished epoch 927/15000, (1869 iterations)
Finished epoch 928/15000, (1871 iterations)
Finished epoch 929/15000, (1873 iterations)
Finished epoch 930/15000, (1875 iterations)
Finished epoch 931/15000, (1877 iterations)
Finished epoch 932/15000, (1879 iterations)
Finished epoch 933/15000, (1881 iterations)
Finished epoch 934/15000, (1883 iterations)
Finished epoch 935/15000, (1885 iterations)
Finished epoch 936/15000, (1887 iterations)
Finished epoch 937/15000, (1889 iterations)
Finished epoch 938/15000, (1891 iterations)
Finished epoch 939/15000, (1893 iterations)
Finished epoch 940/15000, (1895 iterations)
Finished epoch 941/15000, (1897 iterations)
Finished epoch 942/15000, (1899 iterations)
Iteration 1900 - loss: 0.9155 - rec_loss: 0.9155 - time: 0d-0h-47m-12s - remaining time: 0d-11h-44m-25s
Finished epoch 943/15000, (1901 iterations)
Finished epoch 944/15000, (1903 iterations)
Finished epoch 945/15000, (1905 iterations)
Finished epoch 946/15000, (1907 iterations)
Finished epoch 947/15000, (1909 iterations)
Finished epoch 948/15000, (1911 iterations)
Finished epoch 949/15000, (1913 iterations)
Finished epoch 950/15000, (1915 iterations)
Finished epoch 951/15000, (1917 iterations)
Finished epoch 952/15000, (1919 iterations)
Finished epoch 953/15000, (1921 iterations)
Finished epoch 954/15000, (1923 iterations)
Finished epoch 955/15000, (1925 iterations)
Finished epoch 956/15000, (1927 iterations)
Finished epoch 957/15000, (1929 iterations)
Finished epoch 958/15000, (1931 iterations)
Finished epoch 959/15000, (1933 iterations)
Finished epoch 960/15000, (1936 iterations)
Finished epoch 961/15000, (1938 iterations)
Finished epoch 962/15000, (1940 iterations)
Finished epoch 963/15000, (1942 iterations)
Finished epoch 964/15000, (1944 iterations)
Finished epoch 965/15000, (1946 iterations)
Finished epoch 966/15000, (1948 iterations)
Finished epoch 967/15000, (1950 iterations)
Finished epoch 968/15000, (1952 iterations)
Finished epoch 969/15000, (1954 iterations)
Finished epoch 970/15000, (1956 iterations)
Finished epoch 971/15000, (1958 iterations)
Finished epoch 972/15000, (1960 iterations)
Finished epoch 973/15000, (1962 iterations)
Finished epoch 974/15000, (1964 iterations)
Finished epoch 975/15000, (1966 iterations)
Finished epoch 976/15000, (1968 iterations)
Finished epoch 977/15000, (1970 iterations)
Finished epoch 978/15000, (1972 iterations)
Finished epoch 979/15000, (1974 iterations)
Finished epoch 980/15000, (1976 iterations)
Finished epoch 981/15000, (1978 iterations)
Finished epoch 982/15000, (1980 iterations)
Finished epoch 983/15000, (1982 iterations)
Finished epoch 984/15000, (1984 iterations)
Finished epoch 985/15000, (1986 iterations)
Finished epoch 986/15000, (1988 iterations)
Finished epoch 987/15000, (1990 iterations)
Finished epoch 988/15000, (1992 iterations)
Finished epoch 989/15000, (1994 iterations)
Finished epoch 990/15000, (1996 iterations)
Finished epoch 991/15000, (1998 iterations)
Iteration 2000 - loss: 0.9137 - rec_loss: 0.9137 - time: 0d-0h-49m-38s - remaining time: 0d-11h-41m-47s

val results:
val/lungOpacity_young_AUROC: 0.5492
val/lungOpacity_old_AUROC: 0.7156
val/lungOpacity_young_AP: 0.5407
val/lungOpacity_old_AP: 0.6624
val/lungOpacity_young_anomaly_score: 1.0095
val/lungOpacity_old_anomaly_score: 1.0072
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.8800
val/lungOpacity_young_subgroupAUROC: 0.5224
val/lungOpacity_old_subgroupAUROC: 0.7244
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.9052
val/lungOpacity_young_rec_loss: 0.9052
val/lungOpacity_old_loss: 0.9024
val/lungOpacity_old_rec_loss: 0.9024

Saving checkpoint to logs/2023-09-17 18:44:54-FAE-rsna-age-bs32-dss-DP/old_percent_05_07_DP/seed_1/ckpt_last.pth
…õ: 1.52 (target: 8.0)
Finished epoch 992/15000, (2000 iterations)
/u/home/getzner/.conda/envs/thesis_opacus/lib/python3.10/site-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Finished epoch 993/15000, (2002 iterations)
Finished epoch 994/15000, (2004 iterations)
Finished epoch 995/15000, (2006 iterations)
Finished epoch 996/15000, (2008 iterations)
Finished epoch 997/15000, (2010 iterations)
Finished epoch 998/15000, (2012 iterations)
Finished epoch 999/15000, (2014 iterations)
Finished epoch 1000/15000, (2016 iterations)
Finished epoch 1001/15000, (2018 iterations)
Finished epoch 1002/15000, (2020 iterations)
Finished epoch 1003/15000, (2022 iterations)
Finished epoch 1004/15000, (2024 iterations)
Finished epoch 1005/15000, (2026 iterations)
Finished epoch 1006/15000, (2028 iterations)
Finished epoch 1007/15000, (2030 iterations)
Finished epoch 1008/15000, (2032 iterations)
Finished epoch 1009/15000, (2034 iterations)
Finished epoch 1010/15000, (2036 iterations)
Finished epoch 1011/15000, (2038 iterations)
Finished epoch 1012/15000, (2040 iterations)
Finished epoch 1013/15000, (2042 iterations)
Finished epoch 1014/15000, (2044 iterations)
Finished epoch 1015/15000, (2046 iterations)
Finished epoch 1016/15000, (2048 iterations)
Finished epoch 1017/15000, (2050 iterations)
Finished epoch 1018/15000, (2052 iterations)
Finished epoch 1019/15000, (2054 iterations)
Finished epoch 1020/15000, (2056 iterations)
Finished epoch 1021/15000, (2058 iterations)
Finished epoch 1022/15000, (2060 iterations)
Finished epoch 1023/15000, (2062 iterations)
Finished epoch 1024/15000, (2064 iterations)
Finished epoch 1025/15000, (2066 iterations)
Finished epoch 1026/15000, (2068 iterations)
Finished epoch 1027/15000, (2070 iterations)
Finished epoch 1028/15000, (2072 iterations)
Finished epoch 1029/15000, (2074 iterations)
Finished epoch 1030/15000, (2076 iterations)
Finished epoch 1031/15000, (2078 iterations)
Finished epoch 1032/15000, (2080 iterations)
Finished epoch 1033/15000, (2082 iterations)
Finished epoch 1034/15000, (2084 iterations)
Finished epoch 1035/15000, (2086 iterations)
Finished epoch 1036/15000, (2088 iterations)
Finished epoch 1037/15000, (2090 iterations)
Finished epoch 1038/15000, (2092 iterations)
Finished epoch 1039/15000, (2094 iterations)
Finished epoch 1040/15000, (2096 iterations)
Finished epoch 1041/15000, (2098 iterations)
Iteration 2100 - loss: 0.9119 - rec_loss: 0.9119 - time: 0d-0h-52m-10s - remaining time: 0d-11h-39m-31s
Finished epoch 1042/15000, (2100 iterations)
Finished epoch 1043/15000, (2102 iterations)
Finished epoch 1044/15000, (2104 iterations)
Finished epoch 1045/15000, (2106 iterations)
Finished epoch 1046/15000, (2108 iterations)
Finished epoch 1047/15000, (2110 iterations)
Finished epoch 1048/15000, (2112 iterations)
Finished epoch 1049/15000, (2114 iterations)
Finished epoch 1050/15000, (2116 iterations)
Finished epoch 1051/15000, (2118 iterations)
Finished epoch 1052/15000, (2120 iterations)
Finished epoch 1053/15000, (2122 iterations)
Finished epoch 1054/15000, (2124 iterations)
Finished epoch 1055/15000, (2126 iterations)
Finished epoch 1056/15000, (2128 iterations)
slurmstepd-atlas: error: *** JOB 10423 ON atlas CANCELLED AT 2023-09-17T19:38:26 ***
