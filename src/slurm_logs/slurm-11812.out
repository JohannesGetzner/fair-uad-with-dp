Running script with Anaconda environment: thesis_opacus
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.001 (678 young and 678 old samples are available)
Using 1 young and 1 old samples for training.
Final dataset shape:  (2, 4)
Loaded datasets in 0.37s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_1/wandb/run-20230930_113100-41l7k0zt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/41l7k0zt
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6920 - rec_loss: 0.6920 - time: 01-00:00:15s - remaining time: 0d-0h-0m-14s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5808
val/lungOpacity_old_AUROC: 0.6064
val/lungOpacity_young_AP: 0.5337
val/lungOpacity_old_AP: 0.5695
val/lungOpacity_young_anomaly_score: 1.0136
val/lungOpacity_old_anomaly_score: 1.0089
val/lungOpacity_young_fpr@0.95: 0.9200
val/lungOpacity_old_fpr@0.95: 0.9200
val/lungOpacity_young_subgroupAUROC: 0.5658
val/lungOpacity_old_subgroupAUROC: 0.6248
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8055
val/lungOpacity_young_rec_loss: 0.8055
val/lungOpacity_old_loss: 0.8072
val/lungOpacity_old_rec_loss: 0.8072

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6020
test/lungOpacity_old_AUROC: 0.6856
test/lungOpacity_young_AP: 0.5869
test/lungOpacity_old_AP: 0.6512
test/lungOpacity_young_anomaly_score: 1.0158
test/lungOpacity_old_anomaly_score: 1.0156
test/lungOpacity_young_fpr@0.95: 0.8800
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6178
test/lungOpacity_old_subgroupAUROC: 0.6656
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8163
test/lungOpacity_young_rec_loss: 0.8163
test/lungOpacity_old_loss: 0.7986
test/lungOpacity_old_rec_loss: 0.7986

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.65122
wandb:           test/lungOpacity_old_AUROC 0.6856
wandb:   test/lungOpacity_old_anomaly_score 1.01562
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.79864
wandb:        test/lungOpacity_old_rec_loss 0.79864
wandb:   test/lungOpacity_old_subgroupAUROC 0.6656
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.58694
wandb:         test/lungOpacity_young_AUROC 0.602
wandb: test/lungOpacity_young_anomaly_score 1.01583
wandb:      test/lungOpacity_young_fpr@0.95 0.88
wandb:          test/lungOpacity_young_loss 0.81627
wandb:      test/lungOpacity_young_rec_loss 0.81627
wandb: test/lungOpacity_young_subgroupAUROC 0.6178
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.69197
wandb:                       train/rec_loss 0.69197
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/41l7k0zt
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v153
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_1/wandb/run-20230930_113100-41l7k0zt/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_2/wandb/run-20230930_113144-s6s2fmb7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/s6s2fmb7
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6906 - rec_loss: 0.6906 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5880
val/lungOpacity_old_AUROC: 0.5988
val/lungOpacity_young_AP: 0.5417
val/lungOpacity_old_AP: 0.5756
val/lungOpacity_young_anomaly_score: 1.0097
val/lungOpacity_old_anomaly_score: 1.0035
val/lungOpacity_young_fpr@0.95: 0.9200
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5642
val/lungOpacity_old_subgroupAUROC: 0.6244
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8064
val/lungOpacity_young_rec_loss: 0.8064
val/lungOpacity_old_loss: 0.8056
val/lungOpacity_old_rec_loss: 0.8056

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6036
test/lungOpacity_old_AUROC: 0.6952
test/lungOpacity_young_AP: 0.5846
test/lungOpacity_old_AP: 0.6756
test/lungOpacity_young_anomaly_score: 1.0120
test/lungOpacity_old_anomaly_score: 1.0105
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6164
test/lungOpacity_old_subgroupAUROC: 0.6802
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8158
test/lungOpacity_young_rec_loss: 0.8158
test/lungOpacity_old_loss: 0.7968
test/lungOpacity_old_rec_loss: 0.7968

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.67565
wandb:           test/lungOpacity_old_AUROC 0.6952
wandb:   test/lungOpacity_old_anomaly_score 1.01049
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.79681
wandb:        test/lungOpacity_old_rec_loss 0.79681
wandb:   test/lungOpacity_old_subgroupAUROC 0.6802
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.58456
wandb:         test/lungOpacity_young_AUROC 0.6036
wandb: test/lungOpacity_young_anomaly_score 1.01202
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.81576
wandb:      test/lungOpacity_young_rec_loss 0.81576
wandb: test/lungOpacity_young_subgroupAUROC 0.6164
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.69056
wandb:                       train/rec_loss 0.69056
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/s6s2fmb7
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_2/wandb/run-20230930_113144-s6s2fmb7/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_3/wandb/run-20230930_113201-7hs75wsu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/7hs75wsu
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6877 - rec_loss: 0.6877 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5820
val/lungOpacity_old_AUROC: 0.6032
val/lungOpacity_young_AP: 0.5397
val/lungOpacity_old_AP: 0.5768
val/lungOpacity_young_anomaly_score: 1.0093
val/lungOpacity_old_anomaly_score: 1.0022
val/lungOpacity_young_fpr@0.95: 0.9400
val/lungOpacity_old_fpr@0.95: 0.9600
val/lungOpacity_young_subgroupAUROC: 0.5588
val/lungOpacity_old_subgroupAUROC: 0.6282
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8033
val/lungOpacity_young_rec_loss: 0.8033
val/lungOpacity_old_loss: 0.8026
val/lungOpacity_old_rec_loss: 0.8026

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6008
test/lungOpacity_old_AUROC: 0.6940
test/lungOpacity_young_AP: 0.5868
test/lungOpacity_old_AP: 0.6588
test/lungOpacity_young_anomaly_score: 1.0117
test/lungOpacity_old_anomaly_score: 1.0091
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.6118
test/lungOpacity_old_subgroupAUROC: 0.6800
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8133
test/lungOpacity_young_rec_loss: 0.8133
test/lungOpacity_old_loss: 0.7935
test/lungOpacity_old_rec_loss: 0.7935

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.65877
wandb:           test/lungOpacity_old_AUROC 0.694
wandb:   test/lungOpacity_old_anomaly_score 1.00914
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.79351
wandb:        test/lungOpacity_old_rec_loss 0.79351
wandb:   test/lungOpacity_old_subgroupAUROC 0.68
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.58683
wandb:         test/lungOpacity_young_AUROC 0.6008
wandb: test/lungOpacity_young_anomaly_score 1.01168
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.81325
wandb:      test/lungOpacity_young_rec_loss 0.81325
wandb: test/lungOpacity_young_subgroupAUROC 0.6118
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.68769
wandb:                       train/rec_loss 0.68769
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/7hs75wsu
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_3/wandb/run-20230930_113201-7hs75wsu/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_4/wandb/run-20230930_113218-bzj9mw3u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/bzj9mw3u
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6903 - rec_loss: 0.6903 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5976
val/lungOpacity_old_AUROC: 0.6160
val/lungOpacity_young_AP: 0.5587
val/lungOpacity_old_AP: 0.5792
val/lungOpacity_young_anomaly_score: 1.0121
val/lungOpacity_old_anomaly_score: 1.0051
val/lungOpacity_young_fpr@0.95: 0.9200
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5736
val/lungOpacity_old_subgroupAUROC: 0.6404
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8054
val/lungOpacity_young_rec_loss: 0.8054
val/lungOpacity_old_loss: 0.8045
val/lungOpacity_old_rec_loss: 0.8045

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6080
test/lungOpacity_old_AUROC: 0.7000
test/lungOpacity_young_AP: 0.5890
test/lungOpacity_old_AP: 0.6496
test/lungOpacity_young_anomaly_score: 1.0135
test/lungOpacity_old_anomaly_score: 1.0120
test/lungOpacity_young_fpr@0.95: 0.8400
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6218
test/lungOpacity_old_subgroupAUROC: 0.6838
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8152
test/lungOpacity_young_rec_loss: 0.8152
test/lungOpacity_old_loss: 0.7954
test/lungOpacity_old_rec_loss: 0.7954

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64956
wandb:           test/lungOpacity_old_AUROC 0.7
wandb:   test/lungOpacity_old_anomaly_score 1.01202
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.79535
wandb:        test/lungOpacity_old_rec_loss 0.79535
wandb:   test/lungOpacity_old_subgroupAUROC 0.6838
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.58896
wandb:         test/lungOpacity_young_AUROC 0.608
wandb: test/lungOpacity_young_anomaly_score 1.01346
wandb:      test/lungOpacity_young_fpr@0.95 0.84
wandb:          test/lungOpacity_young_loss 0.8152
wandb:      test/lungOpacity_young_rec_loss 0.8152
wandb: test/lungOpacity_young_subgroupAUROC 0.6218
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.69031
wandb:                       train/rec_loss 0.69031
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/bzj9mw3u
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_4/wandb/run-20230930_113218-bzj9mw3u/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_5/wandb/run-20230930_113235-oyoa85mb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/oyoa85mb
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6960 - rec_loss: 0.6960 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5804
val/lungOpacity_old_AUROC: 0.6216
val/lungOpacity_young_AP: 0.5349
val/lungOpacity_old_AP: 0.6119
val/lungOpacity_young_anomaly_score: 1.0113
val/lungOpacity_old_anomaly_score: 1.0041
val/lungOpacity_young_fpr@0.95: 0.9200
val/lungOpacity_old_fpr@0.95: 0.9200
val/lungOpacity_young_subgroupAUROC: 0.5622
val/lungOpacity_old_subgroupAUROC: 0.6412
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8061
val/lungOpacity_young_rec_loss: 0.8061
val/lungOpacity_old_loss: 0.8061
val/lungOpacity_old_rec_loss: 0.8061

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5988
test/lungOpacity_old_AUROC: 0.6996
test/lungOpacity_young_AP: 0.5790
test/lungOpacity_old_AP: 0.6844
test/lungOpacity_young_anomaly_score: 1.0140
test/lungOpacity_old_anomaly_score: 1.0104
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.6078
test/lungOpacity_old_subgroupAUROC: 0.6872
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8162
test/lungOpacity_young_rec_loss: 0.8162
test/lungOpacity_old_loss: 0.7973
test/lungOpacity_old_rec_loss: 0.7973

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68443
wandb:           test/lungOpacity_old_AUROC 0.6996
wandb:   test/lungOpacity_old_anomaly_score 1.01043
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.79729
wandb:        test/lungOpacity_old_rec_loss 0.79729
wandb:   test/lungOpacity_old_subgroupAUROC 0.6872
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.57898
wandb:         test/lungOpacity_young_AUROC 0.5988
wandb: test/lungOpacity_young_anomaly_score 1.01397
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.81615
wandb:      test/lungOpacity_young_rec_loss 0.81615
wandb: test/lungOpacity_young_subgroupAUROC 0.6078
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.69601
wandb:                       train/rec_loss 0.69601
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/oyoa85mb
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs42/seed_5/wandb/run-20230930_113235-oyoa85mb/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.005 (678 young and 678 old samples are available)
Using 3 young and 3 old samples for training.
Final dataset shape:  (6, 4)
Loaded datasets in 0.15s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_1/wandb/run-20230930_113305-ykyxr7gt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ykyxr7gt
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7324 - rec_loss: 0.7324 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6664
val/lungOpacity_old_AUROC: 0.7184
val/lungOpacity_young_AP: 0.5913
val/lungOpacity_old_AP: 0.7091
val/lungOpacity_young_anomaly_score: 0.9907
val/lungOpacity_old_anomaly_score: 0.9735
val/lungOpacity_young_fpr@0.95: 0.7800
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.6278
val/lungOpacity_old_subgroupAUROC: 0.7502
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.1000
val/lungOpacity_young_loss: 0.7805
val/lungOpacity_young_rec_loss: 0.7805
val/lungOpacity_old_loss: 0.7731
val/lungOpacity_old_rec_loss: 0.7731

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6488
test/lungOpacity_old_AUROC: 0.7752
test/lungOpacity_young_AP: 0.6051
test/lungOpacity_old_AP: 0.7684
test/lungOpacity_young_anomaly_score: 0.9910
test/lungOpacity_old_anomaly_score: 0.9798
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.7400
test/lungOpacity_young_subgroupAUROC: 0.6534
test/lungOpacity_old_subgroupAUROC: 0.7714
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7903
test/lungOpacity_young_rec_loss: 0.7903
test/lungOpacity_old_loss: 0.7624
test/lungOpacity_old_rec_loss: 0.7624

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.76837
wandb:           test/lungOpacity_old_AUROC 0.7752
wandb:   test/lungOpacity_old_anomaly_score 0.97978
wandb:        test/lungOpacity_old_fpr@0.95 0.74
wandb:            test/lungOpacity_old_loss 0.76244
wandb:        test/lungOpacity_old_rec_loss 0.76244
wandb:   test/lungOpacity_old_subgroupAUROC 0.7714
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.60511
wandb:         test/lungOpacity_young_AUROC 0.6488
wandb: test/lungOpacity_young_anomaly_score 0.99096
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.79027
wandb:      test/lungOpacity_young_rec_loss 0.79027
wandb: test/lungOpacity_young_subgroupAUROC 0.6534
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.73236
wandb:                       train/rec_loss 0.73236
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ykyxr7gt
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_1/wandb/run-20230930_113305-ykyxr7gt/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_2/wandb/run-20230930_113323-64tl6e9w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/64tl6e9w
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7233 - rec_loss: 0.7233 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6536
val/lungOpacity_old_AUROC: 0.7072
val/lungOpacity_young_AP: 0.5762
val/lungOpacity_old_AP: 0.6855
val/lungOpacity_young_anomaly_score: 0.9867
val/lungOpacity_old_anomaly_score: 0.9686
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.6134
val/lungOpacity_old_subgroupAUROC: 0.7396
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7755
val/lungOpacity_young_rec_loss: 0.7755
val/lungOpacity_old_loss: 0.7672
val/lungOpacity_old_rec_loss: 0.7672

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6460
test/lungOpacity_old_AUROC: 0.7580
test/lungOpacity_young_AP: 0.5987
test/lungOpacity_old_AP: 0.7521
test/lungOpacity_young_anomaly_score: 0.9876
test/lungOpacity_old_anomaly_score: 0.9757
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6448
test/lungOpacity_old_subgroupAUROC: 0.7582
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7859
test/lungOpacity_young_rec_loss: 0.7859
test/lungOpacity_old_loss: 0.7577
test/lungOpacity_old_rec_loss: 0.7577

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.75208
wandb:           test/lungOpacity_old_AUROC 0.758
wandb:   test/lungOpacity_old_anomaly_score 0.97566
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.75769
wandb:        test/lungOpacity_old_rec_loss 0.75769
wandb:   test/lungOpacity_old_subgroupAUROC 0.7582
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.59868
wandb:         test/lungOpacity_young_AUROC 0.646
wandb: test/lungOpacity_young_anomaly_score 0.98765
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.78586
wandb:      test/lungOpacity_young_rec_loss 0.78586
wandb: test/lungOpacity_young_subgroupAUROC 0.6448
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.72329
wandb:                       train/rec_loss 0.72329
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/64tl6e9w
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_2/wandb/run-20230930_113323-64tl6e9w/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_3/wandb/run-20230930_113339-8q366h63
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8q366h63
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7237 - rec_loss: 0.7237 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6556
val/lungOpacity_old_AUROC: 0.6980
val/lungOpacity_young_AP: 0.5830
val/lungOpacity_old_AP: 0.6980
val/lungOpacity_young_anomaly_score: 0.9859
val/lungOpacity_old_anomaly_score: 0.9686
val/lungOpacity_young_fpr@0.95: 0.8600
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6164
val/lungOpacity_old_subgroupAUROC: 0.7366
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7741
val/lungOpacity_young_rec_loss: 0.7741
val/lungOpacity_old_loss: 0.7662
val/lungOpacity_old_rec_loss: 0.7662

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6472
test/lungOpacity_old_AUROC: 0.7612
test/lungOpacity_young_AP: 0.5953
test/lungOpacity_old_AP: 0.7648
test/lungOpacity_young_anomaly_score: 0.9872
test/lungOpacity_old_anomaly_score: 0.9754
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6454
test/lungOpacity_old_subgroupAUROC: 0.7668
test/lungOpacity_young_tpr@0.05: 0.1200
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.7848
test/lungOpacity_young_rec_loss: 0.7848
test/lungOpacity_old_loss: 0.7565
test/lungOpacity_old_rec_loss: 0.7565

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.76478
wandb:           test/lungOpacity_old_AUROC 0.7612
wandb:   test/lungOpacity_old_anomaly_score 0.9754
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.75647
wandb:        test/lungOpacity_old_rec_loss 0.75647
wandb:   test/lungOpacity_old_subgroupAUROC 0.7668
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.59535
wandb:         test/lungOpacity_young_AUROC 0.6472
wandb: test/lungOpacity_young_anomaly_score 0.9872
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.78483
wandb:      test/lungOpacity_young_rec_loss 0.78483
wandb: test/lungOpacity_young_subgroupAUROC 0.6454
wandb:      test/lungOpacity_young_tpr@0.05 0.12
wandb:                           train/loss 0.72372
wandb:                       train/rec_loss 0.72372
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8q366h63
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_3/wandb/run-20230930_113339-8q366h63/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_4/wandb/run-20230930_113355-5003yh7w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/5003yh7w
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7226 - rec_loss: 0.7226 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6456
val/lungOpacity_old_AUROC: 0.7024
val/lungOpacity_young_AP: 0.5812
val/lungOpacity_old_AP: 0.6914
val/lungOpacity_young_anomaly_score: 0.9869
val/lungOpacity_old_anomaly_score: 0.9689
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6030
val/lungOpacity_old_subgroupAUROC: 0.7346
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7742
val/lungOpacity_young_rec_loss: 0.7742
val/lungOpacity_old_loss: 0.7660
val/lungOpacity_old_rec_loss: 0.7660

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6444
test/lungOpacity_old_AUROC: 0.7612
test/lungOpacity_young_AP: 0.6170
test/lungOpacity_old_AP: 0.7563
test/lungOpacity_young_anomaly_score: 0.9883
test/lungOpacity_old_anomaly_score: 0.9758
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.6420
test/lungOpacity_old_subgroupAUROC: 0.7674
test/lungOpacity_young_tpr@0.05: 0.1600
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7845
test/lungOpacity_young_rec_loss: 0.7845
test/lungOpacity_old_loss: 0.7563
test/lungOpacity_old_rec_loss: 0.7563

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.75627
wandb:           test/lungOpacity_old_AUROC 0.7612
wandb:   test/lungOpacity_old_anomaly_score 0.9758
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.75625
wandb:        test/lungOpacity_old_rec_loss 0.75625
wandb:   test/lungOpacity_old_subgroupAUROC 0.7674
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.61705
wandb:         test/lungOpacity_young_AUROC 0.6444
wandb: test/lungOpacity_young_anomaly_score 0.98826
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.78446
wandb:      test/lungOpacity_young_rec_loss 0.78446
wandb: test/lungOpacity_young_subgroupAUROC 0.642
wandb:      test/lungOpacity_young_tpr@0.05 0.16
wandb:                           train/loss 0.72258
wandb:                       train/rec_loss 0.72258
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/5003yh7w
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_4/wandb/run-20230930_113355-5003yh7w/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_5/wandb/run-20230930_113412-nar5vra6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/nar5vra6
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7205 - rec_loss: 0.7205 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6488
val/lungOpacity_old_AUROC: 0.6968
val/lungOpacity_young_AP: 0.5718
val/lungOpacity_old_AP: 0.6872
val/lungOpacity_young_anomaly_score: 0.9895
val/lungOpacity_old_anomaly_score: 0.9743
val/lungOpacity_young_fpr@0.95: 0.8600
val/lungOpacity_old_fpr@0.95: 0.9000
val/lungOpacity_young_subgroupAUROC: 0.6142
val/lungOpacity_old_subgroupAUROC: 0.7282
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7772
val/lungOpacity_young_rec_loss: 0.7772
val/lungOpacity_old_loss: 0.7700
val/lungOpacity_old_rec_loss: 0.7700

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6368
test/lungOpacity_old_AUROC: 0.7476
test/lungOpacity_young_AP: 0.6016
test/lungOpacity_old_AP: 0.7470
test/lungOpacity_young_anomaly_score: 0.9908
test/lungOpacity_old_anomaly_score: 0.9797
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6358
test/lungOpacity_old_subgroupAUROC: 0.7506
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7890
test/lungOpacity_young_rec_loss: 0.7890
test/lungOpacity_old_loss: 0.7610
test/lungOpacity_old_rec_loss: 0.7610

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.74701
wandb:           test/lungOpacity_old_AUROC 0.7476
wandb:   test/lungOpacity_old_anomaly_score 0.97974
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.76102
wandb:        test/lungOpacity_old_rec_loss 0.76102
wandb:   test/lungOpacity_old_subgroupAUROC 0.7506
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.60159
wandb:         test/lungOpacity_young_AUROC 0.6368
wandb: test/lungOpacity_young_anomaly_score 0.99078
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.78895
wandb:      test/lungOpacity_young_rec_loss 0.78895
wandb: test/lungOpacity_young_subgroupAUROC 0.6358
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.72052
wandb:                       train/rec_loss 0.72052
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/nar5vra6
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs42/seed_5/wandb/run-20230930_113412-nar5vra6/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.008 (678 young and 678 old samples are available)
Using 5 young and 5 old samples for training.
Final dataset shape:  (10, 4)
Loaded datasets in 0.14s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_1/wandb/run-20230930_113442-5owq0159
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/5owq0159
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7441 - rec_loss: 0.7441 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7088
val/lungOpacity_old_AUROC: 0.7424
val/lungOpacity_young_AP: 0.6339
val/lungOpacity_old_AP: 0.7392
val/lungOpacity_young_anomaly_score: 0.9768
val/lungOpacity_old_anomaly_score: 0.9584
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.7200
val/lungOpacity_young_subgroupAUROC: 0.6678
val/lungOpacity_old_subgroupAUROC: 0.7826
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7563
val/lungOpacity_young_rec_loss: 0.7563
val/lungOpacity_old_loss: 0.7501
val/lungOpacity_old_rec_loss: 0.7501

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6820
test/lungOpacity_old_AUROC: 0.8016
test/lungOpacity_young_AP: 0.6277
test/lungOpacity_old_AP: 0.7952
test/lungOpacity_young_anomaly_score: 0.9753
test/lungOpacity_old_anomaly_score: 0.9637
test/lungOpacity_young_fpr@0.95: 0.6800
test/lungOpacity_old_fpr@0.95: 0.6600
test/lungOpacity_young_subgroupAUROC: 0.6818
test/lungOpacity_old_subgroupAUROC: 0.7990
test/lungOpacity_young_tpr@0.05: 0.1200
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7670
test/lungOpacity_young_rec_loss: 0.7670
test/lungOpacity_old_loss: 0.7371
test/lungOpacity_old_rec_loss: 0.7371

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.79517
wandb:           test/lungOpacity_old_AUROC 0.8016
wandb:   test/lungOpacity_old_anomaly_score 0.96365
wandb:        test/lungOpacity_old_fpr@0.95 0.66
wandb:            test/lungOpacity_old_loss 0.73709
wandb:        test/lungOpacity_old_rec_loss 0.73709
wandb:   test/lungOpacity_old_subgroupAUROC 0.799
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.62768
wandb:         test/lungOpacity_young_AUROC 0.682
wandb: test/lungOpacity_young_anomaly_score 0.97529
wandb:      test/lungOpacity_young_fpr@0.95 0.68
wandb:          test/lungOpacity_young_loss 0.76704
wandb:      test/lungOpacity_young_rec_loss 0.76704
wandb: test/lungOpacity_young_subgroupAUROC 0.6818
wandb:      test/lungOpacity_young_tpr@0.05 0.12
wandb:                           train/loss 0.74411
wandb:                       train/rec_loss 0.74411
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/5owq0159
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_1/wandb/run-20230930_113442-5owq0159/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_2/wandb/run-20230930_113500-5vbzm0k3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/5vbzm0k3
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7343 - rec_loss: 0.7343 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6876
val/lungOpacity_old_AUROC: 0.7500
val/lungOpacity_young_AP: 0.6143
val/lungOpacity_old_AP: 0.7485
val/lungOpacity_young_anomaly_score: 0.9724
val/lungOpacity_old_anomaly_score: 0.9468
val/lungOpacity_young_fpr@0.95: 0.7200
val/lungOpacity_old_fpr@0.95: 0.7200
val/lungOpacity_young_subgroupAUROC: 0.6386
val/lungOpacity_old_subgroupAUROC: 0.7924
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.1000
val/lungOpacity_young_loss: 0.7471
val/lungOpacity_young_rec_loss: 0.7471
val/lungOpacity_old_loss: 0.7392
val/lungOpacity_old_rec_loss: 0.7392

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6600
test/lungOpacity_old_AUROC: 0.8012
test/lungOpacity_young_AP: 0.6065
test/lungOpacity_old_AP: 0.8017
test/lungOpacity_young_anomaly_score: 0.9713
test/lungOpacity_old_anomaly_score: 0.9518
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.7400
test/lungOpacity_young_subgroupAUROC: 0.6524
test/lungOpacity_old_subgroupAUROC: 0.8122
test/lungOpacity_young_tpr@0.05: 0.1400
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7582
test/lungOpacity_young_rec_loss: 0.7582
test/lungOpacity_old_loss: 0.7246
test/lungOpacity_old_rec_loss: 0.7246

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.80166
wandb:           test/lungOpacity_old_AUROC 0.8012
wandb:   test/lungOpacity_old_anomaly_score 0.95184
wandb:        test/lungOpacity_old_fpr@0.95 0.74
wandb:            test/lungOpacity_old_loss 0.72464
wandb:        test/lungOpacity_old_rec_loss 0.72464
wandb:   test/lungOpacity_old_subgroupAUROC 0.8122
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.6065
wandb:         test/lungOpacity_young_AUROC 0.66
wandb: test/lungOpacity_young_anomaly_score 0.97126
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.75822
wandb:      test/lungOpacity_young_rec_loss 0.75822
wandb: test/lungOpacity_young_subgroupAUROC 0.6524
wandb:      test/lungOpacity_young_tpr@0.05 0.14
wandb:                           train/loss 0.73426
wandb:                       train/rec_loss 0.73426
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/5vbzm0k3
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_2/wandb/run-20230930_113500-5vbzm0k3/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_3/wandb/run-20230930_113517-t3wxlxzb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/t3wxlxzb
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7298 - rec_loss: 0.7298 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6780
val/lungOpacity_old_AUROC: 0.7660
val/lungOpacity_young_AP: 0.6012
val/lungOpacity_old_AP: 0.7588
val/lungOpacity_young_anomaly_score: 0.9701
val/lungOpacity_old_anomaly_score: 0.9481
val/lungOpacity_young_fpr@0.95: 0.6800
val/lungOpacity_old_fpr@0.95: 0.6400
val/lungOpacity_young_subgroupAUROC: 0.6412
val/lungOpacity_old_subgroupAUROC: 0.8004
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7461
val/lungOpacity_young_rec_loss: 0.7461
val/lungOpacity_old_loss: 0.7384
val/lungOpacity_old_rec_loss: 0.7384

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6584
test/lungOpacity_old_AUROC: 0.8100
test/lungOpacity_young_AP: 0.6047
test/lungOpacity_old_AP: 0.8022
test/lungOpacity_young_anomaly_score: 0.9695
test/lungOpacity_old_anomaly_score: 0.9531
test/lungOpacity_young_fpr@0.95: 0.6800
test/lungOpacity_old_fpr@0.95: 0.6000
test/lungOpacity_young_subgroupAUROC: 0.6582
test/lungOpacity_old_subgroupAUROC: 0.8112
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7579
test/lungOpacity_young_rec_loss: 0.7579
test/lungOpacity_old_loss: 0.7242
test/lungOpacity_old_rec_loss: 0.7242

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.80221
wandb:           test/lungOpacity_old_AUROC 0.81
wandb:   test/lungOpacity_old_anomaly_score 0.9531
wandb:        test/lungOpacity_old_fpr@0.95 0.6
wandb:            test/lungOpacity_old_loss 0.72422
wandb:        test/lungOpacity_old_rec_loss 0.72422
wandb:   test/lungOpacity_old_subgroupAUROC 0.8112
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.6047
wandb:         test/lungOpacity_young_AUROC 0.6584
wandb: test/lungOpacity_young_anomaly_score 0.96948
wandb:      test/lungOpacity_young_fpr@0.95 0.68
wandb:          test/lungOpacity_young_loss 0.75795
wandb:      test/lungOpacity_young_rec_loss 0.75795
wandb: test/lungOpacity_young_subgroupAUROC 0.6582
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.72978
wandb:                       train/rec_loss 0.72978
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/t3wxlxzb
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_3/wandb/run-20230930_113517-t3wxlxzb/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_4/wandb/run-20230930_113533-w3a4dbca
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/w3a4dbca
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7352 - rec_loss: 0.7352 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6928
val/lungOpacity_old_AUROC: 0.7628
val/lungOpacity_young_AP: 0.6226
val/lungOpacity_old_AP: 0.7500
val/lungOpacity_young_anomaly_score: 0.9740
val/lungOpacity_old_anomaly_score: 0.9504
val/lungOpacity_young_fpr@0.95: 0.6400
val/lungOpacity_old_fpr@0.95: 0.6600
val/lungOpacity_young_subgroupAUROC: 0.6518
val/lungOpacity_old_subgroupAUROC: 0.7986
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7498
val/lungOpacity_young_rec_loss: 0.7498
val/lungOpacity_old_loss: 0.7414
val/lungOpacity_old_rec_loss: 0.7414

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6576
test/lungOpacity_old_AUROC: 0.7956
test/lungOpacity_young_AP: 0.6045
test/lungOpacity_old_AP: 0.7906
test/lungOpacity_young_anomaly_score: 0.9717
test/lungOpacity_old_anomaly_score: 0.9542
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.7400
test/lungOpacity_young_subgroupAUROC: 0.6500
test/lungOpacity_old_subgroupAUROC: 0.8086
test/lungOpacity_young_tpr@0.05: 0.1200
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.7611
test/lungOpacity_young_rec_loss: 0.7611
test/lungOpacity_old_loss: 0.7259
test/lungOpacity_old_rec_loss: 0.7259

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.79064
wandb:           test/lungOpacity_old_AUROC 0.7956
wandb:   test/lungOpacity_old_anomaly_score 0.95419
wandb:        test/lungOpacity_old_fpr@0.95 0.74
wandb:            test/lungOpacity_old_loss 0.72592
wandb:        test/lungOpacity_old_rec_loss 0.72592
wandb:   test/lungOpacity_old_subgroupAUROC 0.8086
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.60453
wandb:         test/lungOpacity_young_AUROC 0.6576
wandb: test/lungOpacity_young_anomaly_score 0.97172
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.76108
wandb:      test/lungOpacity_young_rec_loss 0.76108
wandb: test/lungOpacity_young_subgroupAUROC 0.65
wandb:      test/lungOpacity_young_tpr@0.05 0.12
wandb:                           train/loss 0.73518
wandb:                       train/rec_loss 0.73518
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/w3a4dbca
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_4/wandb/run-20230930_113533-w3a4dbca/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_5/wandb/run-20230930_113550-165won83
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/165won83
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7300 - rec_loss: 0.7300 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6908
val/lungOpacity_old_AUROC: 0.7568
val/lungOpacity_young_AP: 0.6100
val/lungOpacity_old_AP: 0.7500
val/lungOpacity_young_anomaly_score: 0.9735
val/lungOpacity_old_anomaly_score: 0.9510
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.6800
val/lungOpacity_young_subgroupAUROC: 0.6466
val/lungOpacity_old_subgroupAUROC: 0.7940
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7484
val/lungOpacity_young_rec_loss: 0.7484
val/lungOpacity_old_loss: 0.7406
val/lungOpacity_old_rec_loss: 0.7406

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6716
test/lungOpacity_old_AUROC: 0.7928
test/lungOpacity_young_AP: 0.6056
test/lungOpacity_old_AP: 0.7917
test/lungOpacity_young_anomaly_score: 0.9731
test/lungOpacity_old_anomaly_score: 0.9552
test/lungOpacity_young_fpr@0.95: 0.6800
test/lungOpacity_old_fpr@0.95: 0.6600
test/lungOpacity_young_subgroupAUROC: 0.6582
test/lungOpacity_old_subgroupAUROC: 0.8062
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7602
test/lungOpacity_young_rec_loss: 0.7602
test/lungOpacity_old_loss: 0.7256
test/lungOpacity_old_rec_loss: 0.7256

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.79169
wandb:           test/lungOpacity_old_AUROC 0.7928
wandb:   test/lungOpacity_old_anomaly_score 0.95522
wandb:        test/lungOpacity_old_fpr@0.95 0.66
wandb:            test/lungOpacity_old_loss 0.72557
wandb:        test/lungOpacity_old_rec_loss 0.72557
wandb:   test/lungOpacity_old_subgroupAUROC 0.8062
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.6056
wandb:         test/lungOpacity_young_AUROC 0.6716
wandb: test/lungOpacity_young_anomaly_score 0.9731
wandb:      test/lungOpacity_young_fpr@0.95 0.68
wandb:          test/lungOpacity_young_loss 0.76018
wandb:      test/lungOpacity_young_rec_loss 0.76018
wandb: test/lungOpacity_young_subgroupAUROC 0.6582
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.73001
wandb:                       train/rec_loss 0.73001
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/165won83
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs42/seed_5/wandb/run-20230930_113550-165won83/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.001 (678 young and 678 old samples are available)
Using 1 young and 1 old samples for training.
Final dataset shape:  (2, 4)
Loaded datasets in 0.09s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_1/wandb/run-20230930_113617-249yeg0m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/249yeg0m
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6963 - rec_loss: 0.6963 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6340
val/lungOpacity_old_AUROC: 0.4808
val/lungOpacity_young_AP: 0.5957
val/lungOpacity_old_AP: 0.5114
val/lungOpacity_young_anomaly_score: 1.0174
val/lungOpacity_old_anomaly_score: 1.0133
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9600
val/lungOpacity_young_subgroupAUROC: 0.5874
val/lungOpacity_old_subgroupAUROC: 0.5464
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8298
val/lungOpacity_young_rec_loss: 0.8298
val/lungOpacity_old_loss: 0.8141
val/lungOpacity_old_rec_loss: 0.8141

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5808
test/lungOpacity_old_AUROC: 0.5028
test/lungOpacity_young_AP: 0.5468
test/lungOpacity_old_AP: 0.5225
test/lungOpacity_young_anomaly_score: 1.0148
test/lungOpacity_old_anomaly_score: 1.0146
test/lungOpacity_young_fpr@0.95: 0.9800
test/lungOpacity_old_fpr@0.95: 0.9400
test/lungOpacity_young_subgroupAUROC: 0.5736
test/lungOpacity_old_subgroupAUROC: 0.5144
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8263
test/lungOpacity_young_rec_loss: 0.8263
test/lungOpacity_old_loss: 0.8215
test/lungOpacity_old_rec_loss: 0.8215

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.52245
wandb:           test/lungOpacity_old_AUROC 0.5028
wandb:   test/lungOpacity_old_anomaly_score 1.01457
wandb:        test/lungOpacity_old_fpr@0.95 0.94
wandb:            test/lungOpacity_old_loss 0.82153
wandb:        test/lungOpacity_old_rec_loss 0.82153
wandb:   test/lungOpacity_old_subgroupAUROC 0.5144
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.54683
wandb:         test/lungOpacity_young_AUROC 0.5808
wandb: test/lungOpacity_young_anomaly_score 1.01476
wandb:      test/lungOpacity_young_fpr@0.95 0.98
wandb:          test/lungOpacity_young_loss 0.82633
wandb:      test/lungOpacity_young_rec_loss 0.82633
wandb: test/lungOpacity_young_subgroupAUROC 0.5736
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.69632
wandb:                       train/rec_loss 0.69632
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/249yeg0m
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_1/wandb/run-20230930_113617-249yeg0m/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_2/wandb/run-20230930_113637-3dvkqlza
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/3dvkqlza
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6933 - rec_loss: 0.6933 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6552
val/lungOpacity_old_AUROC: 0.5016
val/lungOpacity_young_AP: 0.6090
val/lungOpacity_old_AP: 0.5187
val/lungOpacity_young_anomaly_score: 1.0109
val/lungOpacity_old_anomaly_score: 1.0052
val/lungOpacity_young_fpr@0.95: 0.9600
val/lungOpacity_old_fpr@0.95: 0.9200
val/lungOpacity_young_subgroupAUROC: 0.6030
val/lungOpacity_old_subgroupAUROC: 0.5658
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8253
val/lungOpacity_young_rec_loss: 0.8253
val/lungOpacity_old_loss: 0.8089
val/lungOpacity_old_rec_loss: 0.8089

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5892
test/lungOpacity_old_AUROC: 0.5284
test/lungOpacity_young_AP: 0.5637
test/lungOpacity_old_AP: 0.5457
test/lungOpacity_young_anomaly_score: 1.0076
test/lungOpacity_old_anomaly_score: 1.0070
test/lungOpacity_young_fpr@0.95: 0.9600
test/lungOpacity_old_fpr@0.95: 0.9000
test/lungOpacity_young_subgroupAUROC: 0.5834
test/lungOpacity_old_subgroupAUROC: 0.5372
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8219
test/lungOpacity_young_rec_loss: 0.8219
test/lungOpacity_old_loss: 0.8160
test/lungOpacity_old_rec_loss: 0.8160

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.54569
wandb:           test/lungOpacity_old_AUROC 0.5284
wandb:   test/lungOpacity_old_anomaly_score 1.00699
wandb:        test/lungOpacity_old_fpr@0.95 0.9
wandb:            test/lungOpacity_old_loss 0.81603
wandb:        test/lungOpacity_old_rec_loss 0.81603
wandb:   test/lungOpacity_old_subgroupAUROC 0.5372
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.56373
wandb:         test/lungOpacity_young_AUROC 0.5892
wandb: test/lungOpacity_young_anomaly_score 1.00764
wandb:      test/lungOpacity_young_fpr@0.95 0.96
wandb:          test/lungOpacity_young_loss 0.82189
wandb:      test/lungOpacity_young_rec_loss 0.82189
wandb: test/lungOpacity_young_subgroupAUROC 0.5834
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.69334
wandb:                       train/rec_loss 0.69334
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/3dvkqlza
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_2/wandb/run-20230930_113637-3dvkqlza/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_3/wandb/run-20230930_113654-dihfikm5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/dihfikm5
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6841 - rec_loss: 0.6841 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6528
val/lungOpacity_old_AUROC: 0.4884
val/lungOpacity_young_AP: 0.6132
val/lungOpacity_old_AP: 0.5187
val/lungOpacity_young_anomaly_score: 1.0103
val/lungOpacity_old_anomaly_score: 1.0040
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5974
val/lungOpacity_old_subgroupAUROC: 0.5616
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.8238
val/lungOpacity_young_rec_loss: 0.8238
val/lungOpacity_old_loss: 0.8073
val/lungOpacity_old_rec_loss: 0.8073

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5928
test/lungOpacity_old_AUROC: 0.5420
test/lungOpacity_young_AP: 0.5631
test/lungOpacity_old_AP: 0.5488
test/lungOpacity_young_anomaly_score: 1.0077
test/lungOpacity_old_anomaly_score: 1.0068
test/lungOpacity_young_fpr@0.95: 0.9600
test/lungOpacity_old_fpr@0.95: 0.9200
test/lungOpacity_young_subgroupAUROC: 0.5860
test/lungOpacity_old_subgroupAUROC: 0.5504
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8201
test/lungOpacity_young_rec_loss: 0.8201
test/lungOpacity_old_loss: 0.8152
test/lungOpacity_old_rec_loss: 0.8152

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.54881
wandb:           test/lungOpacity_old_AUROC 0.542
wandb:   test/lungOpacity_old_anomaly_score 1.00678
wandb:        test/lungOpacity_old_fpr@0.95 0.92
wandb:            test/lungOpacity_old_loss 0.81518
wandb:        test/lungOpacity_old_rec_loss 0.81518
wandb:   test/lungOpacity_old_subgroupAUROC 0.5504
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.56308
wandb:         test/lungOpacity_young_AUROC 0.5928
wandb: test/lungOpacity_young_anomaly_score 1.00772
wandb:      test/lungOpacity_young_fpr@0.95 0.96
wandb:          test/lungOpacity_young_loss 0.82014
wandb:      test/lungOpacity_young_rec_loss 0.82014
wandb: test/lungOpacity_young_subgroupAUROC 0.586
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.68412
wandb:                       train/rec_loss 0.68412
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/dihfikm5
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_3/wandb/run-20230930_113654-dihfikm5/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_4/wandb/run-20230930_113710-7z8j46b8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/7z8j46b8
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6886 - rec_loss: 0.6886 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6260
val/lungOpacity_old_AUROC: 0.4772
val/lungOpacity_young_AP: 0.5948
val/lungOpacity_old_AP: 0.5184
val/lungOpacity_young_anomaly_score: 1.0151
val/lungOpacity_old_anomaly_score: 1.0077
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5624
val/lungOpacity_old_subgroupAUROC: 0.5452
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.8242
val/lungOpacity_young_rec_loss: 0.8242
val/lungOpacity_old_loss: 0.8074
val/lungOpacity_old_rec_loss: 0.8074

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5560
test/lungOpacity_old_AUROC: 0.5400
test/lungOpacity_young_AP: 0.5469
test/lungOpacity_old_AP: 0.5477
test/lungOpacity_young_anomaly_score: 1.0121
test/lungOpacity_old_anomaly_score: 1.0112
test/lungOpacity_young_fpr@0.95: 0.9200
test/lungOpacity_old_fpr@0.95: 0.9400
test/lungOpacity_young_subgroupAUROC: 0.5602
test/lungOpacity_old_subgroupAUROC: 0.5376
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8205
test/lungOpacity_young_rec_loss: 0.8205
test/lungOpacity_old_loss: 0.8154
test/lungOpacity_old_rec_loss: 0.8154

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.54774
wandb:           test/lungOpacity_old_AUROC 0.54
wandb:   test/lungOpacity_old_anomaly_score 1.01124
wandb:        test/lungOpacity_old_fpr@0.95 0.94
wandb:            test/lungOpacity_old_loss 0.81539
wandb:        test/lungOpacity_old_rec_loss 0.81539
wandb:   test/lungOpacity_old_subgroupAUROC 0.5376
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.5469
wandb:         test/lungOpacity_young_AUROC 0.556
wandb: test/lungOpacity_young_anomaly_score 1.01208
wandb:      test/lungOpacity_young_fpr@0.95 0.92
wandb:          test/lungOpacity_young_loss 0.82055
wandb:      test/lungOpacity_young_rec_loss 0.82055
wandb: test/lungOpacity_young_subgroupAUROC 0.5602
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.6886
wandb:                       train/rec_loss 0.6886
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/7z8j46b8
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_4/wandb/run-20230930_113710-7z8j46b8/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_5/wandb/run-20230930_113727-rtyvp4g5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/rtyvp4g5
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6858 - rec_loss: 0.6858 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6384
val/lungOpacity_old_AUROC: 0.4888
val/lungOpacity_young_AP: 0.5948
val/lungOpacity_old_AP: 0.5152
val/lungOpacity_young_anomaly_score: 1.0174
val/lungOpacity_old_anomaly_score: 1.0125
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9600
val/lungOpacity_young_subgroupAUROC: 0.5860
val/lungOpacity_old_subgroupAUROC: 0.5506
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8276
val/lungOpacity_young_rec_loss: 0.8276
val/lungOpacity_old_loss: 0.8115
val/lungOpacity_old_rec_loss: 0.8115

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5844
test/lungOpacity_old_AUROC: 0.5256
test/lungOpacity_young_AP: 0.5532
test/lungOpacity_old_AP: 0.5332
test/lungOpacity_young_anomaly_score: 1.0153
test/lungOpacity_old_anomaly_score: 1.0147
test/lungOpacity_young_fpr@0.95: 0.8800
test/lungOpacity_old_fpr@0.95: 0.9000
test/lungOpacity_young_subgroupAUROC: 0.5808
test/lungOpacity_old_subgroupAUROC: 0.5344
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8243
test/lungOpacity_young_rec_loss: 0.8243
test/lungOpacity_old_loss: 0.8194
test/lungOpacity_old_rec_loss: 0.8194

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.53322
wandb:           test/lungOpacity_old_AUROC 0.5256
wandb:   test/lungOpacity_old_anomaly_score 1.01474
wandb:        test/lungOpacity_old_fpr@0.95 0.9
wandb:            test/lungOpacity_old_loss 0.81937
wandb:        test/lungOpacity_old_rec_loss 0.81937
wandb:   test/lungOpacity_old_subgroupAUROC 0.5344
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.55321
wandb:         test/lungOpacity_young_AUROC 0.5844
wandb: test/lungOpacity_young_anomaly_score 1.01532
wandb:      test/lungOpacity_young_fpr@0.95 0.88
wandb:          test/lungOpacity_young_loss 0.82433
wandb:      test/lungOpacity_young_rec_loss 0.82433
wandb: test/lungOpacity_young_subgroupAUROC 0.5808
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.68578
wandb:                       train/rec_loss 0.68578
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/rtyvp4g5
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs43/seed_5/wandb/run-20230930_113727-rtyvp4g5/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.005 (678 young and 678 old samples are available)
Using 3 young and 3 old samples for training.
Final dataset shape:  (6, 4)
Loaded datasets in 0.34s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_1/wandb/run-20230930_113756-1kypjdgg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1kypjdgg
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7342 - rec_loss: 0.7342 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7016
val/lungOpacity_old_AUROC: 0.6732
val/lungOpacity_young_AP: 0.6506
val/lungOpacity_old_AP: 0.6146
val/lungOpacity_young_anomaly_score: 0.9807
val/lungOpacity_old_anomaly_score: 0.9687
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6534
val/lungOpacity_old_subgroupAUROC: 0.7110
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.7775
val/lungOpacity_young_rec_loss: 0.7775
val/lungOpacity_old_loss: 0.7566
val/lungOpacity_old_rec_loss: 0.7566

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6816
test/lungOpacity_old_AUROC: 0.6648
test/lungOpacity_young_AP: 0.6278
test/lungOpacity_old_AP: 0.6271
test/lungOpacity_young_anomaly_score: 0.9781
test/lungOpacity_old_anomaly_score: 0.9688
test/lungOpacity_young_fpr@0.95: 0.8800
test/lungOpacity_old_fpr@0.95: 0.8800
test/lungOpacity_young_subgroupAUROC: 0.6396
test/lungOpacity_old_subgroupAUROC: 0.7016
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.7742
test/lungOpacity_young_rec_loss: 0.7742
test/lungOpacity_old_loss: 0.7663
test/lungOpacity_old_rec_loss: 0.7663

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.62709
wandb:           test/lungOpacity_old_AUROC 0.6648
wandb:   test/lungOpacity_old_anomaly_score 0.96877
wandb:        test/lungOpacity_old_fpr@0.95 0.88
wandb:            test/lungOpacity_old_loss 0.76627
wandb:        test/lungOpacity_old_rec_loss 0.76627
wandb:   test/lungOpacity_old_subgroupAUROC 0.7016
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.62781
wandb:         test/lungOpacity_young_AUROC 0.6816
wandb: test/lungOpacity_young_anomaly_score 0.9781
wandb:      test/lungOpacity_young_fpr@0.95 0.88
wandb:          test/lungOpacity_young_loss 0.77418
wandb:      test/lungOpacity_young_rec_loss 0.77418
wandb: test/lungOpacity_young_subgroupAUROC 0.6396
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.73422
wandb:                       train/rec_loss 0.73422
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1kypjdgg
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_1/wandb/run-20230930_113756-1kypjdgg/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_2/wandb/run-20230930_113814-2p0qlukh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/2p0qlukh
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7265 - rec_loss: 0.7265 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6456
val/lungOpacity_old_AUROC: 0.6268
val/lungOpacity_young_AP: 0.6017
val/lungOpacity_old_AP: 0.6115
val/lungOpacity_young_anomaly_score: 0.9818
val/lungOpacity_old_anomaly_score: 0.9661
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.5902
val/lungOpacity_old_subgroupAUROC: 0.6830
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7742
val/lungOpacity_young_rec_loss: 0.7742
val/lungOpacity_old_loss: 0.7535
val/lungOpacity_old_rec_loss: 0.7535

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5920
test/lungOpacity_old_AUROC: 0.6352
test/lungOpacity_young_AP: 0.5543
test/lungOpacity_old_AP: 0.6343
test/lungOpacity_young_anomaly_score: 0.9778
test/lungOpacity_old_anomaly_score: 0.9667
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.5634
test/lungOpacity_old_subgroupAUROC: 0.6604
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7710
test/lungOpacity_young_rec_loss: 0.7710
test/lungOpacity_old_loss: 0.7642
test/lungOpacity_old_rec_loss: 0.7642

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.63429
wandb:           test/lungOpacity_old_AUROC 0.6352
wandb:   test/lungOpacity_old_anomaly_score 0.96668
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.7642
wandb:        test/lungOpacity_old_rec_loss 0.7642
wandb:   test/lungOpacity_old_subgroupAUROC 0.6604
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.55429
wandb:         test/lungOpacity_young_AUROC 0.592
wandb: test/lungOpacity_young_anomaly_score 0.9778
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.77103
wandb:      test/lungOpacity_young_rec_loss 0.77103
wandb: test/lungOpacity_young_subgroupAUROC 0.5634
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.7265
wandb:                       train/rec_loss 0.7265
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/2p0qlukh
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_2/wandb/run-20230930_113814-2p0qlukh/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_3/wandb/run-20230930_113831-q57a3ze2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/q57a3ze2
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7162 - rec_loss: 0.7162 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6540
val/lungOpacity_old_AUROC: 0.6676
val/lungOpacity_young_AP: 0.6016
val/lungOpacity_old_AP: 0.6455
val/lungOpacity_young_anomaly_score: 0.9720
val/lungOpacity_old_anomaly_score: 0.9575
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6108
val/lungOpacity_old_subgroupAUROC: 0.7048
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7664
val/lungOpacity_young_rec_loss: 0.7664
val/lungOpacity_old_loss: 0.7440
val/lungOpacity_old_rec_loss: 0.7440

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6172
test/lungOpacity_old_AUROC: 0.6668
test/lungOpacity_young_AP: 0.5642
test/lungOpacity_old_AP: 0.6611
test/lungOpacity_young_anomaly_score: 0.9693
test/lungOpacity_old_anomaly_score: 0.9584
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.5948
test/lungOpacity_old_subgroupAUROC: 0.6958
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7629
test/lungOpacity_young_rec_loss: 0.7629
test/lungOpacity_old_loss: 0.7554
test/lungOpacity_old_rec_loss: 0.7554

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.66108
wandb:           test/lungOpacity_old_AUROC 0.6668
wandb:   test/lungOpacity_old_anomaly_score 0.95843
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.75536
wandb:        test/lungOpacity_old_rec_loss 0.75536
wandb:   test/lungOpacity_old_subgroupAUROC 0.6958
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.56415
wandb:         test/lungOpacity_young_AUROC 0.6172
wandb: test/lungOpacity_young_anomaly_score 0.96933
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.76288
wandb:      test/lungOpacity_young_rec_loss 0.76288
wandb: test/lungOpacity_young_subgroupAUROC 0.5948
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.71624
wandb:                       train/rec_loss 0.71624
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/q57a3ze2
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_3/wandb/run-20230930_113831-q57a3ze2/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_4/wandb/run-20230930_113847-yrbxn7ro
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/yrbxn7ro
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7228 - rec_loss: 0.7228 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6608
val/lungOpacity_old_AUROC: 0.6500
val/lungOpacity_young_AP: 0.6082
val/lungOpacity_old_AP: 0.6190
val/lungOpacity_young_anomaly_score: 0.9818
val/lungOpacity_old_anomaly_score: 0.9659
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6134
val/lungOpacity_old_subgroupAUROC: 0.6978
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7739
val/lungOpacity_young_rec_loss: 0.7739
val/lungOpacity_old_loss: 0.7517
val/lungOpacity_old_rec_loss: 0.7517

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6220
test/lungOpacity_old_AUROC: 0.6588
test/lungOpacity_young_AP: 0.5678
test/lungOpacity_old_AP: 0.6380
test/lungOpacity_young_anomaly_score: 0.9781
test/lungOpacity_old_anomaly_score: 0.9668
test/lungOpacity_young_fpr@0.95: 0.8400
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.5944
test/lungOpacity_old_subgroupAUROC: 0.6870
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7696
test/lungOpacity_young_rec_loss: 0.7696
test/lungOpacity_old_loss: 0.7628
test/lungOpacity_old_rec_loss: 0.7628

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.042 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.042 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.63796
wandb:           test/lungOpacity_old_AUROC 0.6588
wandb:   test/lungOpacity_old_anomaly_score 0.96679
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.7628
wandb:        test/lungOpacity_old_rec_loss 0.7628
wandb:   test/lungOpacity_old_subgroupAUROC 0.687
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.56785
wandb:         test/lungOpacity_young_AUROC 0.622
wandb: test/lungOpacity_young_anomaly_score 0.97815
wandb:      test/lungOpacity_young_fpr@0.95 0.84
wandb:          test/lungOpacity_young_loss 0.76956
wandb:      test/lungOpacity_young_rec_loss 0.76956
wandb: test/lungOpacity_young_subgroupAUROC 0.5944
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.72282
wandb:                       train/rec_loss 0.72282
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/yrbxn7ro
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_4/wandb/run-20230930_113847-yrbxn7ro/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_5/wandb/run-20230930_113904-p9hkz2r6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/p9hkz2r6
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7165 - rec_loss: 0.7165 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6628
val/lungOpacity_old_AUROC: 0.6448
val/lungOpacity_young_AP: 0.6154
val/lungOpacity_old_AP: 0.6089
val/lungOpacity_young_anomaly_score: 0.9777
val/lungOpacity_old_anomaly_score: 0.9646
val/lungOpacity_young_fpr@0.95: 0.8600
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6228
val/lungOpacity_old_subgroupAUROC: 0.6846
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7724
val/lungOpacity_young_rec_loss: 0.7724
val/lungOpacity_old_loss: 0.7493
val/lungOpacity_old_rec_loss: 0.7493

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6296
test/lungOpacity_old_AUROC: 0.6376
test/lungOpacity_young_AP: 0.5757
test/lungOpacity_old_AP: 0.6333
test/lungOpacity_young_anomaly_score: 0.9741
test/lungOpacity_old_anomaly_score: 0.9648
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6004
test/lungOpacity_old_subgroupAUROC: 0.6646
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7680
test/lungOpacity_young_rec_loss: 0.7680
test/lungOpacity_old_loss: 0.7608
test/lungOpacity_old_rec_loss: 0.7608

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.63331
wandb:           test/lungOpacity_old_AUROC 0.6376
wandb:   test/lungOpacity_old_anomaly_score 0.96479
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.76083
wandb:        test/lungOpacity_old_rec_loss 0.76083
wandb:   test/lungOpacity_old_subgroupAUROC 0.6646
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.57568
wandb:         test/lungOpacity_young_AUROC 0.6296
wandb: test/lungOpacity_young_anomaly_score 0.97408
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.76798
wandb:      test/lungOpacity_young_rec_loss 0.76798
wandb: test/lungOpacity_young_subgroupAUROC 0.6004
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.71648
wandb:                       train/rec_loss 0.71648
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/p9hkz2r6
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs43/seed_5/wandb/run-20230930_113904-p9hkz2r6/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.008 (678 young and 678 old samples are available)
Using 5 young and 5 old samples for training.
Final dataset shape:  (10, 4)
Loaded datasets in 0.16s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_1/wandb/run-20230930_113933-qcaxnnop
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/qcaxnnop
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7545 - rec_loss: 0.7545 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6932
val/lungOpacity_old_AUROC: 0.6832
val/lungOpacity_young_AP: 0.6446
val/lungOpacity_old_AP: 0.6392
val/lungOpacity_young_anomaly_score: 0.9631
val/lungOpacity_old_anomaly_score: 0.9526
val/lungOpacity_young_fpr@0.95: 0.8600
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.6690
val/lungOpacity_old_subgroupAUROC: 0.7100
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7577
val/lungOpacity_young_rec_loss: 0.7577
val/lungOpacity_old_loss: 0.7337
val/lungOpacity_old_rec_loss: 0.7337

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6788
test/lungOpacity_old_AUROC: 0.6180
test/lungOpacity_young_AP: 0.6228
test/lungOpacity_old_AP: 0.6002
test/lungOpacity_young_anomaly_score: 0.9604
test/lungOpacity_old_anomaly_score: 0.9478
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6324
test/lungOpacity_old_subgroupAUROC: 0.6692
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.7517
test/lungOpacity_young_rec_loss: 0.7517
test/lungOpacity_old_loss: 0.7426
test/lungOpacity_old_rec_loss: 0.7426

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.60021
wandb:           test/lungOpacity_old_AUROC 0.618
wandb:   test/lungOpacity_old_anomaly_score 0.94783
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.74261
wandb:        test/lungOpacity_old_rec_loss 0.74261
wandb:   test/lungOpacity_old_subgroupAUROC 0.6692
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.6228
wandb:         test/lungOpacity_young_AUROC 0.6788
wandb: test/lungOpacity_young_anomaly_score 0.96038
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.75173
wandb:      test/lungOpacity_young_rec_loss 0.75173
wandb: test/lungOpacity_young_subgroupAUROC 0.6324
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.75455
wandb:                       train/rec_loss 0.75455
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/qcaxnnop
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_1/wandb/run-20230930_113933-qcaxnnop/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_2/wandb/run-20230930_113951-v8o1wzlp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/v8o1wzlp
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7483 - rec_loss: 0.7483 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7140
val/lungOpacity_old_AUROC: 0.6892
val/lungOpacity_young_AP: 0.6640
val/lungOpacity_old_AP: 0.6600
val/lungOpacity_young_anomaly_score: 0.9593
val/lungOpacity_old_anomaly_score: 0.9451
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6712
val/lungOpacity_old_subgroupAUROC: 0.7292
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7552
val/lungOpacity_young_rec_loss: 0.7552
val/lungOpacity_old_loss: 0.7307
val/lungOpacity_old_rec_loss: 0.7307

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6728
test/lungOpacity_old_AUROC: 0.6508
test/lungOpacity_young_AP: 0.6133
test/lungOpacity_old_AP: 0.6401
test/lungOpacity_young_anomaly_score: 0.9551
test/lungOpacity_old_anomaly_score: 0.9423
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6352
test/lungOpacity_old_subgroupAUROC: 0.6976
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7503
test/lungOpacity_young_rec_loss: 0.7503
test/lungOpacity_old_loss: 0.7418
test/lungOpacity_old_rec_loss: 0.7418

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64007
wandb:           test/lungOpacity_old_AUROC 0.6508
wandb:   test/lungOpacity_old_anomaly_score 0.94227
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.74183
wandb:        test/lungOpacity_old_rec_loss 0.74183
wandb:   test/lungOpacity_old_subgroupAUROC 0.6976
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.61329
wandb:         test/lungOpacity_young_AUROC 0.6728
wandb: test/lungOpacity_young_anomaly_score 0.95509
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.75028
wandb:      test/lungOpacity_young_rec_loss 0.75028
wandb: test/lungOpacity_young_subgroupAUROC 0.6352
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.7483
wandb:                       train/rec_loss 0.7483
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/v8o1wzlp
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_2/wandb/run-20230930_113951-v8o1wzlp/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_3/wandb/run-20230930_114006-d8yg5dtz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/d8yg5dtz
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7377 - rec_loss: 0.7377 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6800
val/lungOpacity_old_AUROC: 0.6760
val/lungOpacity_young_AP: 0.6497
val/lungOpacity_old_AP: 0.6466
val/lungOpacity_young_anomaly_score: 0.9498
val/lungOpacity_old_anomaly_score: 0.9397
val/lungOpacity_young_fpr@0.95: 0.8600
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6530
val/lungOpacity_old_subgroupAUROC: 0.7010
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7460
val/lungOpacity_young_rec_loss: 0.7460
val/lungOpacity_old_loss: 0.7216
val/lungOpacity_old_rec_loss: 0.7216

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6624
test/lungOpacity_old_AUROC: 0.6124
test/lungOpacity_young_AP: 0.6262
test/lungOpacity_old_AP: 0.6141
test/lungOpacity_young_anomaly_score: 0.9464
test/lungOpacity_old_anomaly_score: 0.9351
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6206
test/lungOpacity_old_subgroupAUROC: 0.6548
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7403
test/lungOpacity_young_rec_loss: 0.7403
test/lungOpacity_old_loss: 0.7323
test/lungOpacity_old_rec_loss: 0.7323

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.61412
wandb:           test/lungOpacity_old_AUROC 0.6124
wandb:   test/lungOpacity_old_anomaly_score 0.93506
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.73227
wandb:        test/lungOpacity_old_rec_loss 0.73227
wandb:   test/lungOpacity_old_subgroupAUROC 0.6548
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.6262
wandb:         test/lungOpacity_young_AUROC 0.6624
wandb: test/lungOpacity_young_anomaly_score 0.94642
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.74031
wandb:      test/lungOpacity_young_rec_loss 0.74031
wandb: test/lungOpacity_young_subgroupAUROC 0.6206
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.73771
wandb:                       train/rec_loss 0.73771
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/d8yg5dtz
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_3/wandb/run-20230930_114006-d8yg5dtz/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_4/wandb/run-20230930_114022-msvrq4qd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/msvrq4qd
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7439 - rec_loss: 0.7439 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6952
val/lungOpacity_old_AUROC: 0.6496
val/lungOpacity_young_AP: 0.6454
val/lungOpacity_old_AP: 0.6068
val/lungOpacity_young_anomaly_score: 0.9611
val/lungOpacity_old_anomaly_score: 0.9502
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.6600
val/lungOpacity_old_subgroupAUROC: 0.6868
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7575
val/lungOpacity_young_rec_loss: 0.7575
val/lungOpacity_old_loss: 0.7331
val/lungOpacity_old_rec_loss: 0.7331

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6744
test/lungOpacity_old_AUROC: 0.6072
test/lungOpacity_young_AP: 0.6185
test/lungOpacity_old_AP: 0.5892
test/lungOpacity_young_anomaly_score: 0.9579
test/lungOpacity_old_anomaly_score: 0.9471
test/lungOpacity_young_fpr@0.95: 0.8800
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.6292
test/lungOpacity_old_subgroupAUROC: 0.6576
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.7508
test/lungOpacity_young_rec_loss: 0.7508
test/lungOpacity_old_loss: 0.7426
test/lungOpacity_old_rec_loss: 0.7426

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.58919
wandb:           test/lungOpacity_old_AUROC 0.6072
wandb:   test/lungOpacity_old_anomaly_score 0.94708
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.74259
wandb:        test/lungOpacity_old_rec_loss 0.74259
wandb:   test/lungOpacity_old_subgroupAUROC 0.6576
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.6185
wandb:         test/lungOpacity_young_AUROC 0.6744
wandb: test/lungOpacity_young_anomaly_score 0.9579
wandb:      test/lungOpacity_young_fpr@0.95 0.88
wandb:          test/lungOpacity_young_loss 0.75078
wandb:      test/lungOpacity_young_rec_loss 0.75078
wandb: test/lungOpacity_young_subgroupAUROC 0.6292
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.74392
wandb:                       train/rec_loss 0.74392
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/msvrq4qd
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_4/wandb/run-20230930_114022-msvrq4qd/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_5/wandb/run-20230930_114040-lbhgbv9l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/lbhgbv9l
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7388 - rec_loss: 0.7388 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6872
val/lungOpacity_old_AUROC: 0.6804
val/lungOpacity_young_AP: 0.6464
val/lungOpacity_old_AP: 0.6463
val/lungOpacity_young_anomaly_score: 0.9570
val/lungOpacity_old_anomaly_score: 0.9447
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.6548
val/lungOpacity_old_subgroupAUROC: 0.7090
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7528
val/lungOpacity_young_rec_loss: 0.7528
val/lungOpacity_old_loss: 0.7279
val/lungOpacity_old_rec_loss: 0.7279

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6744
test/lungOpacity_old_AUROC: 0.6120
test/lungOpacity_young_AP: 0.6137
test/lungOpacity_old_AP: 0.6008
test/lungOpacity_young_anomaly_score: 0.9543
test/lungOpacity_old_anomaly_score: 0.9396
test/lungOpacity_young_fpr@0.95: 0.8400
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.6238
test/lungOpacity_old_subgroupAUROC: 0.6718
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7478
test/lungOpacity_young_rec_loss: 0.7478
test/lungOpacity_old_loss: 0.7375
test/lungOpacity_old_rec_loss: 0.7375

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.60082
wandb:           test/lungOpacity_old_AUROC 0.612
wandb:   test/lungOpacity_old_anomaly_score 0.93964
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.73753
wandb:        test/lungOpacity_old_rec_loss 0.73753
wandb:   test/lungOpacity_old_subgroupAUROC 0.6718
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.61366
wandb:         test/lungOpacity_young_AUROC 0.6744
wandb: test/lungOpacity_young_anomaly_score 0.95432
wandb:      test/lungOpacity_young_fpr@0.95 0.84
wandb:          test/lungOpacity_young_loss 0.74779
wandb:      test/lungOpacity_young_rec_loss 0.74779
wandb: test/lungOpacity_young_subgroupAUROC 0.6238
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.7388
wandb:                       train/rec_loss 0.7388
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/lbhgbv9l
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs43/seed_5/wandb/run-20230930_114040-lbhgbv9l/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.001 (678 young and 678 old samples are available)
Using 1 young and 1 old samples for training.
Final dataset shape:  (2, 4)
Loaded datasets in 0.08s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_1/wandb/run-20230930_114107-4thprp23
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/4thprp23
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6915 - rec_loss: 0.6915 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5788
val/lungOpacity_old_AUROC: 0.5748
val/lungOpacity_young_AP: 0.5845
val/lungOpacity_old_AP: 0.5401
val/lungOpacity_young_anomaly_score: 1.0265
val/lungOpacity_old_anomaly_score: 1.0160
val/lungOpacity_young_fpr@0.95: 0.9000
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.5212
val/lungOpacity_old_subgroupAUROC: 0.6262
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8504
val/lungOpacity_young_rec_loss: 0.8504
val/lungOpacity_old_loss: 0.8290
val/lungOpacity_old_rec_loss: 0.8290

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6124
test/lungOpacity_old_AUROC: 0.6708
test/lungOpacity_young_AP: 0.6418
test/lungOpacity_old_AP: 0.6823
test/lungOpacity_young_anomaly_score: 1.0288
test/lungOpacity_old_anomaly_score: 1.0231
test/lungOpacity_young_fpr@0.95: 0.9000
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.6008
test/lungOpacity_old_subgroupAUROC: 0.6902
test/lungOpacity_young_tpr@0.05: 0.1200
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.8456
test/lungOpacity_young_rec_loss: 0.8456
test/lungOpacity_old_loss: 0.8338
test/lungOpacity_old_rec_loss: 0.8338

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68232
wandb:           test/lungOpacity_old_AUROC 0.6708
wandb:   test/lungOpacity_old_anomaly_score 1.02306
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.83383
wandb:        test/lungOpacity_old_rec_loss 0.83383
wandb:   test/lungOpacity_old_subgroupAUROC 0.6902
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.64181
wandb:         test/lungOpacity_young_AUROC 0.6124
wandb: test/lungOpacity_young_anomaly_score 1.0288
wandb:      test/lungOpacity_young_fpr@0.95 0.9
wandb:          test/lungOpacity_young_loss 0.84565
wandb:      test/lungOpacity_young_rec_loss 0.84565
wandb: test/lungOpacity_young_subgroupAUROC 0.6008
wandb:      test/lungOpacity_young_tpr@0.05 0.12
wandb:                           train/loss 0.6915
wandb:                       train/rec_loss 0.6915
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/4thprp23
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_1/wandb/run-20230930_114107-4thprp23/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_2/wandb/run-20230930_114126-m43gs5fl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/m43gs5fl
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6860 - rec_loss: 0.6860 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5980
val/lungOpacity_old_AUROC: 0.5752
val/lungOpacity_young_AP: 0.5816
val/lungOpacity_old_AP: 0.5345
val/lungOpacity_young_anomaly_score: 1.0250
val/lungOpacity_old_anomaly_score: 1.0148
val/lungOpacity_young_fpr@0.95: 0.9000
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.5426
val/lungOpacity_old_subgroupAUROC: 0.6258
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8465
val/lungOpacity_young_rec_loss: 0.8465
val/lungOpacity_old_loss: 0.8239
val/lungOpacity_old_rec_loss: 0.8239

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6156
test/lungOpacity_old_AUROC: 0.6656
test/lungOpacity_young_AP: 0.6316
test/lungOpacity_old_AP: 0.6621
test/lungOpacity_young_anomaly_score: 1.0267
test/lungOpacity_old_anomaly_score: 1.0218
test/lungOpacity_young_fpr@0.95: 0.9000
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6066
test/lungOpacity_old_subgroupAUROC: 0.6768
test/lungOpacity_young_tpr@0.05: 0.1400
test/lungOpacity_old_tpr@0.05: 0.1800
test/lungOpacity_young_loss: 0.8414
test/lungOpacity_young_rec_loss: 0.8414
test/lungOpacity_old_loss: 0.8293
test/lungOpacity_old_rec_loss: 0.8293

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.66205
wandb:           test/lungOpacity_old_AUROC 0.6656
wandb:   test/lungOpacity_old_anomaly_score 1.02183
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.82925
wandb:        test/lungOpacity_old_rec_loss 0.82925
wandb:   test/lungOpacity_old_subgroupAUROC 0.6768
wandb:        test/lungOpacity_old_tpr@0.05 0.18
wandb:            test/lungOpacity_young_AP 0.63164
wandb:         test/lungOpacity_young_AUROC 0.6156
wandb: test/lungOpacity_young_anomaly_score 1.0267
wandb:      test/lungOpacity_young_fpr@0.95 0.9
wandb:          test/lungOpacity_young_loss 0.84141
wandb:      test/lungOpacity_young_rec_loss 0.84141
wandb: test/lungOpacity_young_subgroupAUROC 0.6066
wandb:      test/lungOpacity_young_tpr@0.05 0.14
wandb:                           train/loss 0.68604
wandb:                       train/rec_loss 0.68604
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/m43gs5fl
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_2/wandb/run-20230930_114126-m43gs5fl/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_3/wandb/run-20230930_114143-6jhmhjg2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/6jhmhjg2
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6790 - rec_loss: 0.6790 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5860
val/lungOpacity_old_AUROC: 0.5768
val/lungOpacity_young_AP: 0.5921
val/lungOpacity_old_AP: 0.5413
val/lungOpacity_young_anomaly_score: 1.0262
val/lungOpacity_old_anomaly_score: 1.0152
val/lungOpacity_young_fpr@0.95: 0.9000
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.5316
val/lungOpacity_old_subgroupAUROC: 0.6262
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8461
val/lungOpacity_young_rec_loss: 0.8461
val/lungOpacity_old_loss: 0.8233
val/lungOpacity_old_rec_loss: 0.8233

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6220
test/lungOpacity_old_AUROC: 0.6676
test/lungOpacity_young_AP: 0.6449
test/lungOpacity_old_AP: 0.6865
test/lungOpacity_young_anomaly_score: 1.0284
test/lungOpacity_old_anomaly_score: 1.0223
test/lungOpacity_young_fpr@0.95: 0.9000
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6040
test/lungOpacity_old_subgroupAUROC: 0.6844
test/lungOpacity_young_tpr@0.05: 0.1200
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.8414
test/lungOpacity_young_rec_loss: 0.8414
test/lungOpacity_old_loss: 0.8284
test/lungOpacity_old_rec_loss: 0.8284

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.6865
wandb:           test/lungOpacity_old_AUROC 0.6676
wandb:   test/lungOpacity_old_anomaly_score 1.02233
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.82836
wandb:        test/lungOpacity_old_rec_loss 0.82836
wandb:   test/lungOpacity_old_subgroupAUROC 0.6844
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.64486
wandb:         test/lungOpacity_young_AUROC 0.622
wandb: test/lungOpacity_young_anomaly_score 1.02844
wandb:      test/lungOpacity_young_fpr@0.95 0.9
wandb:          test/lungOpacity_young_loss 0.8414
wandb:      test/lungOpacity_young_rec_loss 0.8414
wandb: test/lungOpacity_young_subgroupAUROC 0.604
wandb:      test/lungOpacity_young_tpr@0.05 0.12
wandb:                           train/loss 0.67895
wandb:                       train/rec_loss 0.67895
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/6jhmhjg2
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_3/wandb/run-20230930_114143-6jhmhjg2/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_4/wandb/run-20230930_114159-iddu2uqy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/iddu2uqy
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6834 - rec_loss: 0.6834 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6044
val/lungOpacity_old_AUROC: 0.5724
val/lungOpacity_young_AP: 0.5898
val/lungOpacity_old_AP: 0.5359
val/lungOpacity_young_anomaly_score: 1.0271
val/lungOpacity_old_anomaly_score: 1.0171
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.5530
val/lungOpacity_old_subgroupAUROC: 0.6240
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8467
val/lungOpacity_young_rec_loss: 0.8467
val/lungOpacity_old_loss: 0.8234
val/lungOpacity_old_rec_loss: 0.8234

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6420
test/lungOpacity_old_AUROC: 0.6672
test/lungOpacity_young_AP: 0.6536
test/lungOpacity_old_AP: 0.6653
test/lungOpacity_young_anomaly_score: 1.0292
test/lungOpacity_old_anomaly_score: 1.0247
test/lungOpacity_young_fpr@0.95: 0.8800
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.6244
test/lungOpacity_old_subgroupAUROC: 0.6820
test/lungOpacity_young_tpr@0.05: 0.1200
test/lungOpacity_old_tpr@0.05: 0.2000
test/lungOpacity_young_loss: 0.8417
test/lungOpacity_young_rec_loss: 0.8417
test/lungOpacity_old_loss: 0.8288
test/lungOpacity_old_rec_loss: 0.8288

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.66532
wandb:           test/lungOpacity_old_AUROC 0.6672
wandb:   test/lungOpacity_old_anomaly_score 1.02473
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.82881
wandb:        test/lungOpacity_old_rec_loss 0.82881
wandb:   test/lungOpacity_old_subgroupAUROC 0.682
wandb:        test/lungOpacity_old_tpr@0.05 0.2
wandb:            test/lungOpacity_young_AP 0.65364
wandb:         test/lungOpacity_young_AUROC 0.642
wandb: test/lungOpacity_young_anomaly_score 1.02924
wandb:      test/lungOpacity_young_fpr@0.95 0.88
wandb:          test/lungOpacity_young_loss 0.84167
wandb:      test/lungOpacity_young_rec_loss 0.84167
wandb: test/lungOpacity_young_subgroupAUROC 0.6244
wandb:      test/lungOpacity_young_tpr@0.05 0.12
wandb:                           train/loss 0.68336
wandb:                       train/rec_loss 0.68336
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/iddu2uqy
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_4/wandb/run-20230930_114159-iddu2uqy/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_5/wandb/run-20230930_114214-1xsz0ahr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1xsz0ahr
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6836 - rec_loss: 0.6836 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6144
val/lungOpacity_old_AUROC: 0.5876
val/lungOpacity_young_AP: 0.5929
val/lungOpacity_old_AP: 0.5507
val/lungOpacity_young_anomaly_score: 1.0252
val/lungOpacity_old_anomaly_score: 1.0153
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.5662
val/lungOpacity_old_subgroupAUROC: 0.6372
val/lungOpacity_young_tpr@0.05: 0.1400
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8480
val/lungOpacity_young_rec_loss: 0.8480
val/lungOpacity_old_loss: 0.8255
val/lungOpacity_old_rec_loss: 0.8255

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6464
test/lungOpacity_old_AUROC: 0.6856
test/lungOpacity_young_AP: 0.6643
test/lungOpacity_old_AP: 0.6988
test/lungOpacity_young_anomaly_score: 1.0272
test/lungOpacity_old_anomaly_score: 1.0229
test/lungOpacity_young_fpr@0.95: 0.8800
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6358
test/lungOpacity_old_subgroupAUROC: 0.6972
test/lungOpacity_young_tpr@0.05: 0.1600
test/lungOpacity_old_tpr@0.05: 0.2800
test/lungOpacity_young_loss: 0.8432
test/lungOpacity_young_rec_loss: 0.8432
test/lungOpacity_old_loss: 0.8307
test/lungOpacity_old_rec_loss: 0.8307

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.69881
wandb:           test/lungOpacity_old_AUROC 0.6856
wandb:   test/lungOpacity_old_anomaly_score 1.02292
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.83073
wandb:        test/lungOpacity_old_rec_loss 0.83073
wandb:   test/lungOpacity_old_subgroupAUROC 0.6972
wandb:        test/lungOpacity_old_tpr@0.05 0.28
wandb:            test/lungOpacity_young_AP 0.66429
wandb:         test/lungOpacity_young_AUROC 0.6464
wandb: test/lungOpacity_young_anomaly_score 1.02721
wandb:      test/lungOpacity_young_fpr@0.95 0.88
wandb:          test/lungOpacity_young_loss 0.84319
wandb:      test/lungOpacity_young_rec_loss 0.84319
wandb: test/lungOpacity_young_subgroupAUROC 0.6358
wandb:      test/lungOpacity_young_tpr@0.05 0.16
wandb:                           train/loss 0.68362
wandb:                       train/rec_loss 0.68362
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1xsz0ahr
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs44/seed_5/wandb/run-20230930_114214-1xsz0ahr/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.005 (678 young and 678 old samples are available)
Using 3 young and 3 old samples for training.
Final dataset shape:  (6, 4)
Loaded datasets in 0.12s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_1/wandb/run-20230930_114241-fj0ipc4b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/fj0ipc4b
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7297 - rec_loss: 0.7297 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6720
val/lungOpacity_old_AUROC: 0.6124
val/lungOpacity_young_AP: 0.6207
val/lungOpacity_old_AP: 0.5524
val/lungOpacity_young_anomaly_score: 0.9970
val/lungOpacity_old_anomaly_score: 0.9819
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.6204
val/lungOpacity_old_subgroupAUROC: 0.6664
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7875
val/lungOpacity_young_rec_loss: 0.7875
val/lungOpacity_old_loss: 0.7626
val/lungOpacity_old_rec_loss: 0.7626

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6244
test/lungOpacity_old_AUROC: 0.6680
test/lungOpacity_young_AP: 0.6021
test/lungOpacity_old_AP: 0.6903
test/lungOpacity_young_anomaly_score: 0.9926
test/lungOpacity_old_anomaly_score: 0.9892
test/lungOpacity_young_fpr@0.95: 0.9000
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.6252
test/lungOpacity_old_subgroupAUROC: 0.6704
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.1800
test/lungOpacity_young_loss: 0.7793
test/lungOpacity_young_rec_loss: 0.7793
test/lungOpacity_old_loss: 0.7753
test/lungOpacity_old_rec_loss: 0.7753

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.69025
wandb:           test/lungOpacity_old_AUROC 0.668
wandb:   test/lungOpacity_old_anomaly_score 0.98918
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.77529
wandb:        test/lungOpacity_old_rec_loss 0.77529
wandb:   test/lungOpacity_old_subgroupAUROC 0.6704
wandb:        test/lungOpacity_old_tpr@0.05 0.18
wandb:            test/lungOpacity_young_AP 0.60212
wandb:         test/lungOpacity_young_AUROC 0.6244
wandb: test/lungOpacity_young_anomaly_score 0.99257
wandb:      test/lungOpacity_young_fpr@0.95 0.9
wandb:          test/lungOpacity_young_loss 0.77934
wandb:      test/lungOpacity_young_rec_loss 0.77934
wandb: test/lungOpacity_young_subgroupAUROC 0.6252
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.72968
wandb:                       train/rec_loss 0.72968
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/fj0ipc4b
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_1/wandb/run-20230930_114241-fj0ipc4b/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_2/wandb/run-20230930_114259-8yy4w6vb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8yy4w6vb
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7211 - rec_loss: 0.7211 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6756
val/lungOpacity_old_AUROC: 0.6380
val/lungOpacity_young_AP: 0.6104
val/lungOpacity_old_AP: 0.5700
val/lungOpacity_young_anomaly_score: 0.9937
val/lungOpacity_old_anomaly_score: 0.9806
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6332
val/lungOpacity_old_subgroupAUROC: 0.6796
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7849
val/lungOpacity_young_rec_loss: 0.7849
val/lungOpacity_old_loss: 0.7585
val/lungOpacity_old_rec_loss: 0.7585

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6188
test/lungOpacity_old_AUROC: 0.6728
test/lungOpacity_young_AP: 0.5906
test/lungOpacity_old_AP: 0.6843
test/lungOpacity_young_anomaly_score: 0.9891
test/lungOpacity_old_anomaly_score: 0.9860
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.6216
test/lungOpacity_old_subgroupAUROC: 0.6718
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.7766
test/lungOpacity_young_rec_loss: 0.7766
test/lungOpacity_old_loss: 0.7706
test/lungOpacity_old_rec_loss: 0.7706

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68431
wandb:           test/lungOpacity_old_AUROC 0.6728
wandb:   test/lungOpacity_old_anomaly_score 0.98599
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.77062
wandb:        test/lungOpacity_old_rec_loss 0.77062
wandb:   test/lungOpacity_old_subgroupAUROC 0.6718
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.59064
wandb:         test/lungOpacity_young_AUROC 0.6188
wandb: test/lungOpacity_young_anomaly_score 0.98915
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.77657
wandb:      test/lungOpacity_young_rec_loss 0.77657
wandb: test/lungOpacity_young_subgroupAUROC 0.6216
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.72107
wandb:                       train/rec_loss 0.72107
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8yy4w6vb
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_2/wandb/run-20230930_114259-8yy4w6vb/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_3/wandb/run-20230930_114316-iw4920df
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/iw4920df
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7137 - rec_loss: 0.7137 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6872
val/lungOpacity_old_AUROC: 0.6124
val/lungOpacity_young_AP: 0.6288
val/lungOpacity_old_AP: 0.5438
val/lungOpacity_young_anomaly_score: 0.9885
val/lungOpacity_old_anomaly_score: 0.9724
val/lungOpacity_young_fpr@0.95: 0.7800
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.6316
val/lungOpacity_old_subgroupAUROC: 0.6682
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7814
val/lungOpacity_young_rec_loss: 0.7814
val/lungOpacity_old_loss: 0.7572
val/lungOpacity_old_rec_loss: 0.7572

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6248
test/lungOpacity_old_AUROC: 0.6792
test/lungOpacity_young_AP: 0.5948
test/lungOpacity_old_AP: 0.6862
test/lungOpacity_young_anomaly_score: 0.9831
test/lungOpacity_old_anomaly_score: 0.9807
test/lungOpacity_young_fpr@0.95: 0.9400
test/lungOpacity_old_fpr@0.95: 0.8800
test/lungOpacity_young_subgroupAUROC: 0.6302
test/lungOpacity_old_subgroupAUROC: 0.6770
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.7735
test/lungOpacity_young_rec_loss: 0.7735
test/lungOpacity_old_loss: 0.7701
test/lungOpacity_old_rec_loss: 0.7701

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68624
wandb:           test/lungOpacity_old_AUROC 0.6792
wandb:   test/lungOpacity_old_anomaly_score 0.98073
wandb:        test/lungOpacity_old_fpr@0.95 0.88
wandb:            test/lungOpacity_old_loss 0.77007
wandb:        test/lungOpacity_old_rec_loss 0.77007
wandb:   test/lungOpacity_old_subgroupAUROC 0.677
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.59475
wandb:         test/lungOpacity_young_AUROC 0.6248
wandb: test/lungOpacity_young_anomaly_score 0.98311
wandb:      test/lungOpacity_young_fpr@0.95 0.94
wandb:          test/lungOpacity_young_loss 0.77348
wandb:      test/lungOpacity_young_rec_loss 0.77348
wandb: test/lungOpacity_young_subgroupAUROC 0.6302
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.71366
wandb:                       train/rec_loss 0.71366
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/iw4920df
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_3/wandb/run-20230930_114316-iw4920df/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_4/wandb/run-20230930_114332-l8wcf1t5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/l8wcf1t5
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7210 - rec_loss: 0.7210 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6708
val/lungOpacity_old_AUROC: 0.6276
val/lungOpacity_young_AP: 0.6209
val/lungOpacity_old_AP: 0.5577
val/lungOpacity_young_anomaly_score: 0.9943
val/lungOpacity_old_anomaly_score: 0.9814
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.6274
val/lungOpacity_old_subgroupAUROC: 0.6686
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7846
val/lungOpacity_young_rec_loss: 0.7846
val/lungOpacity_old_loss: 0.7605
val/lungOpacity_old_rec_loss: 0.7605

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6268
test/lungOpacity_old_AUROC: 0.6724
test/lungOpacity_young_AP: 0.6010
test/lungOpacity_old_AP: 0.6863
test/lungOpacity_young_anomaly_score: 0.9910
test/lungOpacity_old_anomaly_score: 0.9888
test/lungOpacity_young_fpr@0.95: 0.8600
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6274
test/lungOpacity_old_subgroupAUROC: 0.6730
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.7763
test/lungOpacity_young_rec_loss: 0.7763
test/lungOpacity_old_loss: 0.7730
test/lungOpacity_old_rec_loss: 0.7730

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68635
wandb:           test/lungOpacity_old_AUROC 0.6724
wandb:   test/lungOpacity_old_anomaly_score 0.98878
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.77301
wandb:        test/lungOpacity_old_rec_loss 0.77301
wandb:   test/lungOpacity_old_subgroupAUROC 0.673
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.60097
wandb:         test/lungOpacity_young_AUROC 0.6268
wandb: test/lungOpacity_young_anomaly_score 0.99103
wandb:      test/lungOpacity_young_fpr@0.95 0.86
wandb:          test/lungOpacity_young_loss 0.77634
wandb:      test/lungOpacity_young_rec_loss 0.77634
wandb: test/lungOpacity_young_subgroupAUROC 0.6274
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.72098
wandb:                       train/rec_loss 0.72098
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/l8wcf1t5
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_4/wandb/run-20230930_114332-l8wcf1t5/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_5/wandb/run-20230930_114348-crepx5e8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/crepx5e8
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7138 - rec_loss: 0.7138 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6680
val/lungOpacity_old_AUROC: 0.6188
val/lungOpacity_young_AP: 0.6100
val/lungOpacity_old_AP: 0.5524
val/lungOpacity_young_anomaly_score: 0.9966
val/lungOpacity_old_anomaly_score: 0.9848
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6312
val/lungOpacity_old_subgroupAUROC: 0.6628
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7885
val/lungOpacity_young_rec_loss: 0.7885
val/lungOpacity_old_loss: 0.7630
val/lungOpacity_old_rec_loss: 0.7630

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6180
test/lungOpacity_old_AUROC: 0.6728
test/lungOpacity_young_AP: 0.5940
test/lungOpacity_old_AP: 0.6884
test/lungOpacity_young_anomaly_score: 0.9921
test/lungOpacity_old_anomaly_score: 0.9922
test/lungOpacity_young_fpr@0.95: 0.9400
test/lungOpacity_old_fpr@0.95: 0.8800
test/lungOpacity_young_subgroupAUROC: 0.6270
test/lungOpacity_old_subgroupAUROC: 0.6644
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.7806
test/lungOpacity_young_rec_loss: 0.7806
test/lungOpacity_old_loss: 0.7754
test/lungOpacity_old_rec_loss: 0.7754

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68838
wandb:           test/lungOpacity_old_AUROC 0.6728
wandb:   test/lungOpacity_old_anomaly_score 0.99225
wandb:        test/lungOpacity_old_fpr@0.95 0.88
wandb:            test/lungOpacity_old_loss 0.77543
wandb:        test/lungOpacity_old_rec_loss 0.77543
wandb:   test/lungOpacity_old_subgroupAUROC 0.6644
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.59402
wandb:         test/lungOpacity_young_AUROC 0.618
wandb: test/lungOpacity_young_anomaly_score 0.99215
wandb:      test/lungOpacity_young_fpr@0.95 0.94
wandb:          test/lungOpacity_young_loss 0.78062
wandb:      test/lungOpacity_young_rec_loss 0.78062
wandb: test/lungOpacity_young_subgroupAUROC 0.627
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.71382
wandb:                       train/rec_loss 0.71382
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/crepx5e8
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs44/seed_5/wandb/run-20230930_114348-crepx5e8/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.008 (678 young and 678 old samples are available)
Using 5 young and 5 old samples for training.
Final dataset shape:  (10, 4)
Loaded datasets in 0.16s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_1/wandb/run-20230930_114416-8uii8nd4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8uii8nd4
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7466 - rec_loss: 0.7466 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7600
val/lungOpacity_old_AUROC: 0.6800
val/lungOpacity_young_AP: 0.6649
val/lungOpacity_old_AP: 0.6027
val/lungOpacity_young_anomaly_score: 0.9687
val/lungOpacity_old_anomaly_score: 0.9565
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.7110
val/lungOpacity_old_subgroupAUROC: 0.7290
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7639
val/lungOpacity_young_rec_loss: 0.7639
val/lungOpacity_old_loss: 0.7355
val/lungOpacity_old_rec_loss: 0.7355

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7192
test/lungOpacity_old_AUROC: 0.7432
test/lungOpacity_young_AP: 0.6397
test/lungOpacity_old_AP: 0.7026
test/lungOpacity_young_anomaly_score: 0.9651
test/lungOpacity_old_anomaly_score: 0.9665
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.7248
test/lungOpacity_old_subgroupAUROC: 0.7398
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7549
test/lungOpacity_young_rec_loss: 0.7549
test/lungOpacity_old_loss: 0.7486
test/lungOpacity_old_rec_loss: 0.7486

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.70263
wandb:           test/lungOpacity_old_AUROC 0.7432
wandb:   test/lungOpacity_old_anomaly_score 0.9665
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.74859
wandb:        test/lungOpacity_old_rec_loss 0.74859
wandb:   test/lungOpacity_old_subgroupAUROC 0.7398
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.63967
wandb:         test/lungOpacity_young_AUROC 0.7192
wandb: test/lungOpacity_young_anomaly_score 0.96513
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.75487
wandb:      test/lungOpacity_young_rec_loss 0.75487
wandb: test/lungOpacity_young_subgroupAUROC 0.7248
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.74662
wandb:                       train/rec_loss 0.74662
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8uii8nd4
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_1/wandb/run-20230930_114416-8uii8nd4/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_2/wandb/run-20230930_114434-idcblc5i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/idcblc5i
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7362 - rec_loss: 0.7362 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7656
val/lungOpacity_old_AUROC: 0.6596
val/lungOpacity_young_AP: 0.6940
val/lungOpacity_old_AP: 0.5864
val/lungOpacity_young_anomaly_score: 0.9632
val/lungOpacity_old_anomaly_score: 0.9467
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.7008
val/lungOpacity_old_subgroupAUROC: 0.7214
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7602
val/lungOpacity_young_rec_loss: 0.7602
val/lungOpacity_old_loss: 0.7303
val/lungOpacity_old_rec_loss: 0.7303

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7176
test/lungOpacity_old_AUROC: 0.7384
test/lungOpacity_young_AP: 0.6495
test/lungOpacity_old_AP: 0.7024
test/lungOpacity_young_anomaly_score: 0.9589
test/lungOpacity_old_anomaly_score: 0.9579
test/lungOpacity_young_fpr@0.95: 0.8400
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.7186
test/lungOpacity_old_subgroupAUROC: 0.7342
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7514
test/lungOpacity_young_rec_loss: 0.7514
test/lungOpacity_old_loss: 0.7430
test/lungOpacity_old_rec_loss: 0.7430

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.70238
wandb:           test/lungOpacity_old_AUROC 0.7384
wandb:   test/lungOpacity_old_anomaly_score 0.95788
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.74298
wandb:        test/lungOpacity_old_rec_loss 0.74298
wandb:   test/lungOpacity_old_subgroupAUROC 0.7342
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.64953
wandb:         test/lungOpacity_young_AUROC 0.7176
wandb: test/lungOpacity_young_anomaly_score 0.95893
wandb:      test/lungOpacity_young_fpr@0.95 0.84
wandb:          test/lungOpacity_young_loss 0.75138
wandb:      test/lungOpacity_young_rec_loss 0.75138
wandb: test/lungOpacity_young_subgroupAUROC 0.7186
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.73618
wandb:                       train/rec_loss 0.73618
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/idcblc5i
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_2/wandb/run-20230930_114434-idcblc5i/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_3/wandb/run-20230930_114450-rb5ndzez
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/rb5ndzez
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7292 - rec_loss: 0.7292 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7756
val/lungOpacity_old_AUROC: 0.6752
val/lungOpacity_young_AP: 0.6956
val/lungOpacity_old_AP: 0.6001
val/lungOpacity_young_anomaly_score: 0.9604
val/lungOpacity_old_anomaly_score: 0.9467
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.7196
val/lungOpacity_old_subgroupAUROC: 0.7316
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7571
val/lungOpacity_young_rec_loss: 0.7571
val/lungOpacity_old_loss: 0.7282
val/lungOpacity_old_rec_loss: 0.7282

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7288
test/lungOpacity_old_AUROC: 0.7336
test/lungOpacity_young_AP: 0.6645
test/lungOpacity_old_AP: 0.7032
test/lungOpacity_young_anomaly_score: 0.9561
test/lungOpacity_old_anomaly_score: 0.9562
test/lungOpacity_young_fpr@0.95: 0.7600
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.7282
test/lungOpacity_old_subgroupAUROC: 0.7376
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7484
test/lungOpacity_young_rec_loss: 0.7484
test/lungOpacity_old_loss: 0.7404
test/lungOpacity_old_rec_loss: 0.7404

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.70318
wandb:           test/lungOpacity_old_AUROC 0.7336
wandb:   test/lungOpacity_old_anomaly_score 0.95617
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.74039
wandb:        test/lungOpacity_old_rec_loss 0.74039
wandb:   test/lungOpacity_old_subgroupAUROC 0.7376
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.66447
wandb:         test/lungOpacity_young_AUROC 0.7288
wandb: test/lungOpacity_young_anomaly_score 0.9561
wandb:      test/lungOpacity_young_fpr@0.95 0.76
wandb:          test/lungOpacity_young_loss 0.74837
wandb:      test/lungOpacity_young_rec_loss 0.74837
wandb: test/lungOpacity_young_subgroupAUROC 0.7282
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.72915
wandb:                       train/rec_loss 0.72915
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/rb5ndzez
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_3/wandb/run-20230930_114450-rb5ndzez/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_4/wandb/run-20230930_114507-wqnflnce
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/wqnflnce
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7391 - rec_loss: 0.7391 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7844
val/lungOpacity_old_AUROC: 0.6676
val/lungOpacity_young_AP: 0.7152
val/lungOpacity_old_AP: 0.5881
val/lungOpacity_young_anomaly_score: 0.9643
val/lungOpacity_old_anomaly_score: 0.9514
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.7200
val/lungOpacity_young_subgroupAUROC: 0.7232
val/lungOpacity_old_subgroupAUROC: 0.7246
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7618
val/lungOpacity_young_rec_loss: 0.7618
val/lungOpacity_old_loss: 0.7327
val/lungOpacity_old_rec_loss: 0.7327

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7448
test/lungOpacity_old_AUROC: 0.7380
test/lungOpacity_young_AP: 0.6802
test/lungOpacity_old_AP: 0.6892
test/lungOpacity_young_anomaly_score: 0.9600
test/lungOpacity_old_anomaly_score: 0.9614
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.7452
test/lungOpacity_old_subgroupAUROC: 0.7380
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7529
test/lungOpacity_young_rec_loss: 0.7529
test/lungOpacity_old_loss: 0.7445
test/lungOpacity_old_rec_loss: 0.7445

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68925
wandb:           test/lungOpacity_old_AUROC 0.738
wandb:   test/lungOpacity_old_anomaly_score 0.96138
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.74448
wandb:        test/lungOpacity_old_rec_loss 0.74448
wandb:   test/lungOpacity_old_subgroupAUROC 0.738
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.6802
wandb:         test/lungOpacity_young_AUROC 0.7448
wandb: test/lungOpacity_young_anomaly_score 0.96004
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.75291
wandb:      test/lungOpacity_young_rec_loss 0.75291
wandb: test/lungOpacity_young_subgroupAUROC 0.7452
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.73905
wandb:                       train/rec_loss 0.73905
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/wqnflnce
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_4/wandb/run-20230930_114507-wqnflnce/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_5/wandb/run-20230930_114524-1jpb96kv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1jpb96kv
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7313 - rec_loss: 0.7313 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7696
val/lungOpacity_old_AUROC: 0.6548
val/lungOpacity_young_AP: 0.6912
val/lungOpacity_old_AP: 0.5795
val/lungOpacity_young_anomaly_score: 0.9655
val/lungOpacity_old_anomaly_score: 0.9498
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.7800
val/lungOpacity_young_subgroupAUROC: 0.7070
val/lungOpacity_old_subgroupAUROC: 0.7202
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7617
val/lungOpacity_young_rec_loss: 0.7617
val/lungOpacity_old_loss: 0.7318
val/lungOpacity_old_rec_loss: 0.7318

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7248
test/lungOpacity_old_AUROC: 0.7376
test/lungOpacity_young_AP: 0.6561
test/lungOpacity_old_AP: 0.7022
test/lungOpacity_young_anomaly_score: 0.9604
test/lungOpacity_old_anomaly_score: 0.9607
test/lungOpacity_young_fpr@0.95: 0.7200
test/lungOpacity_old_fpr@0.95: 0.7600
test/lungOpacity_young_subgroupAUROC: 0.7266
test/lungOpacity_old_subgroupAUROC: 0.7354
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.7528
test/lungOpacity_young_rec_loss: 0.7528
test/lungOpacity_old_loss: 0.7447
test/lungOpacity_old_rec_loss: 0.7447

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.70219
wandb:           test/lungOpacity_old_AUROC 0.7376
wandb:   test/lungOpacity_old_anomaly_score 0.96073
wandb:        test/lungOpacity_old_fpr@0.95 0.76
wandb:            test/lungOpacity_old_loss 0.7447
wandb:        test/lungOpacity_old_rec_loss 0.7447
wandb:   test/lungOpacity_old_subgroupAUROC 0.7354
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.65605
wandb:         test/lungOpacity_young_AUROC 0.7248
wandb: test/lungOpacity_young_anomaly_score 0.96038
wandb:      test/lungOpacity_young_fpr@0.95 0.72
wandb:          test/lungOpacity_young_loss 0.75277
wandb:      test/lungOpacity_young_rec_loss 0.75277
wandb: test/lungOpacity_young_subgroupAUROC 0.7266
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.73133
wandb:                       train/rec_loss 0.73133
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1jpb96kv
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs44/seed_5/wandb/run-20230930_114524-1jpb96kv/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.001 (678 young and 678 old samples are available)
Using 1 young and 1 old samples for training.
Final dataset shape:  (2, 4)
Loaded datasets in 0.09s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_1/wandb/run-20230930_114551-cvsntvjq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cvsntvjq
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7085 - rec_loss: 0.7085 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5376
val/lungOpacity_old_AUROC: 0.4964
val/lungOpacity_young_AP: 0.5436
val/lungOpacity_old_AP: 0.5228
val/lungOpacity_young_anomaly_score: 1.0213
val/lungOpacity_old_anomaly_score: 1.0175
val/lungOpacity_young_fpr@0.95: 0.9400
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.5056
val/lungOpacity_old_subgroupAUROC: 0.5264
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8513
val/lungOpacity_young_rec_loss: 0.8513
val/lungOpacity_old_loss: 0.8467
val/lungOpacity_old_rec_loss: 0.8467

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4764
test/lungOpacity_old_AUROC: 0.5440
test/lungOpacity_young_AP: 0.5195
test/lungOpacity_old_AP: 0.5664
test/lungOpacity_young_anomaly_score: 1.0193
test/lungOpacity_old_anomaly_score: 1.0192
test/lungOpacity_young_fpr@0.95: 0.9600
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.4978
test/lungOpacity_old_subgroupAUROC: 0.5230
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8522
test/lungOpacity_young_rec_loss: 0.8522
test/lungOpacity_old_loss: 0.8507
test/lungOpacity_old_rec_loss: 0.8507

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.56635
wandb:           test/lungOpacity_old_AUROC 0.544
wandb:   test/lungOpacity_old_anomaly_score 1.0192
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.85071
wandb:        test/lungOpacity_old_rec_loss 0.85071
wandb:   test/lungOpacity_old_subgroupAUROC 0.523
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.51953
wandb:         test/lungOpacity_young_AUROC 0.4764
wandb: test/lungOpacity_young_anomaly_score 1.01931
wandb:      test/lungOpacity_young_fpr@0.95 0.96
wandb:          test/lungOpacity_young_loss 0.85223
wandb:      test/lungOpacity_young_rec_loss 0.85223
wandb: test/lungOpacity_young_subgroupAUROC 0.4978
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.70855
wandb:                       train/rec_loss 0.70855
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cvsntvjq
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_1/wandb/run-20230930_114551-cvsntvjq/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_2/wandb/run-20230930_114611-06q4p85u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/06q4p85u
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7024 - rec_loss: 0.7024 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5084
val/lungOpacity_old_AUROC: 0.4880
val/lungOpacity_young_AP: 0.5436
val/lungOpacity_old_AP: 0.5263
val/lungOpacity_young_anomaly_score: 1.0189
val/lungOpacity_old_anomaly_score: 1.0129
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9200
val/lungOpacity_young_subgroupAUROC: 0.4698
val/lungOpacity_old_subgroupAUROC: 0.5202
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.8416
val/lungOpacity_young_rec_loss: 0.8416
val/lungOpacity_old_loss: 0.8343
val/lungOpacity_old_rec_loss: 0.8343

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4152
test/lungOpacity_old_AUROC: 0.5176
test/lungOpacity_young_AP: 0.4616
test/lungOpacity_old_AP: 0.5505
test/lungOpacity_young_anomaly_score: 1.0150
test/lungOpacity_old_anomaly_score: 1.0139
test/lungOpacity_young_fpr@0.95: 0.9800
test/lungOpacity_old_fpr@0.95: 0.9200
test/lungOpacity_young_subgroupAUROC: 0.4446
test/lungOpacity_old_subgroupAUROC: 0.5004
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8416
test/lungOpacity_young_rec_loss: 0.8416
test/lungOpacity_old_loss: 0.8389
test/lungOpacity_old_rec_loss: 0.8389

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.55048
wandb:           test/lungOpacity_old_AUROC 0.5176
wandb:   test/lungOpacity_old_anomaly_score 1.01386
wandb:        test/lungOpacity_old_fpr@0.95 0.92
wandb:            test/lungOpacity_old_loss 0.83895
wandb:        test/lungOpacity_old_rec_loss 0.83895
wandb:   test/lungOpacity_old_subgroupAUROC 0.5004
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.46161
wandb:         test/lungOpacity_young_AUROC 0.4152
wandb: test/lungOpacity_young_anomaly_score 1.01498
wandb:      test/lungOpacity_young_fpr@0.95 0.98
wandb:          test/lungOpacity_young_loss 0.8416
wandb:      test/lungOpacity_young_rec_loss 0.8416
wandb: test/lungOpacity_young_subgroupAUROC 0.4446
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.70242
wandb:                       train/rec_loss 0.70242
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/06q4p85u
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_2/wandb/run-20230930_114611-06q4p85u/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_3/wandb/run-20230930_114628-cmpqx1gc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cmpqx1gc
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7030 - rec_loss: 0.7030 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5488
val/lungOpacity_old_AUROC: 0.4848
val/lungOpacity_young_AP: 0.5393
val/lungOpacity_old_AP: 0.5081
val/lungOpacity_young_anomaly_score: 1.0142
val/lungOpacity_old_anomaly_score: 1.0113
val/lungOpacity_young_fpr@0.95: 0.9600
val/lungOpacity_old_fpr@0.95: 0.9000
val/lungOpacity_young_subgroupAUROC: 0.5132
val/lungOpacity_old_subgroupAUROC: 0.5214
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.8429
val/lungOpacity_young_rec_loss: 0.8429
val/lungOpacity_old_loss: 0.8381
val/lungOpacity_old_rec_loss: 0.8381

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4604
test/lungOpacity_old_AUROC: 0.5048
test/lungOpacity_young_AP: 0.4696
test/lungOpacity_old_AP: 0.5344
test/lungOpacity_young_anomaly_score: 1.0112
test/lungOpacity_old_anomaly_score: 1.0117
test/lungOpacity_young_fpr@0.95: 0.9600
test/lungOpacity_old_fpr@0.95: 0.9000
test/lungOpacity_young_subgroupAUROC: 0.4778
test/lungOpacity_old_subgroupAUROC: 0.4898
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8431
test/lungOpacity_young_rec_loss: 0.8431
test/lungOpacity_old_loss: 0.8416
test/lungOpacity_old_rec_loss: 0.8416

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.53444
wandb:           test/lungOpacity_old_AUROC 0.5048
wandb:   test/lungOpacity_old_anomaly_score 1.01169
wandb:        test/lungOpacity_old_fpr@0.95 0.9
wandb:            test/lungOpacity_old_loss 0.8416
wandb:        test/lungOpacity_old_rec_loss 0.8416
wandb:   test/lungOpacity_old_subgroupAUROC 0.4898
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.46963
wandb:         test/lungOpacity_young_AUROC 0.4604
wandb: test/lungOpacity_young_anomaly_score 1.01119
wandb:      test/lungOpacity_young_fpr@0.95 0.96
wandb:          test/lungOpacity_young_loss 0.8431
wandb:      test/lungOpacity_young_rec_loss 0.8431
wandb: test/lungOpacity_young_subgroupAUROC 0.4778
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.70297
wandb:                       train/rec_loss 0.70297
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cmpqx1gc
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_3/wandb/run-20230930_114628-cmpqx1gc/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_4/wandb/run-20230930_114644-ze0xf2j0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ze0xf2j0
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7059 - rec_loss: 0.7059 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5316
val/lungOpacity_old_AUROC: 0.4980
val/lungOpacity_young_AP: 0.5397
val/lungOpacity_old_AP: 0.5350
val/lungOpacity_young_anomaly_score: 1.0191
val/lungOpacity_old_anomaly_score: 1.0161
val/lungOpacity_young_fpr@0.95: 0.9600
val/lungOpacity_old_fpr@0.95: 0.9000
val/lungOpacity_young_subgroupAUROC: 0.5028
val/lungOpacity_old_subgroupAUROC: 0.5206
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.8514
val/lungOpacity_young_rec_loss: 0.8514
val/lungOpacity_old_loss: 0.8472
val/lungOpacity_old_rec_loss: 0.8472

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4960
test/lungOpacity_old_AUROC: 0.5236
test/lungOpacity_young_AP: 0.5223
test/lungOpacity_old_AP: 0.5432
test/lungOpacity_young_anomaly_score: 1.0184
test/lungOpacity_old_anomaly_score: 1.0173
test/lungOpacity_young_fpr@0.95: 0.9400
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.5020
test/lungOpacity_old_subgroupAUROC: 0.5140
test/lungOpacity_young_tpr@0.05: 0.0200
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8526
test/lungOpacity_young_rec_loss: 0.8526
test/lungOpacity_old_loss: 0.8503
test/lungOpacity_old_rec_loss: 0.8503

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.54315
wandb:           test/lungOpacity_old_AUROC 0.5236
wandb:   test/lungOpacity_old_anomaly_score 1.01731
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.85031
wandb:        test/lungOpacity_old_rec_loss 0.85031
wandb:   test/lungOpacity_old_subgroupAUROC 0.514
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.52228
wandb:         test/lungOpacity_young_AUROC 0.496
wandb: test/lungOpacity_young_anomaly_score 1.01842
wandb:      test/lungOpacity_young_fpr@0.95 0.94
wandb:          test/lungOpacity_young_loss 0.85262
wandb:      test/lungOpacity_young_rec_loss 0.85262
wandb: test/lungOpacity_young_subgroupAUROC 0.502
wandb:      test/lungOpacity_young_tpr@0.05 0.02
wandb:                           train/loss 0.7059
wandb:                       train/rec_loss 0.7059
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ze0xf2j0
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_4/wandb/run-20230930_114644-ze0xf2j0/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_5/wandb/run-20230930_114701-28gclpj8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/28gclpj8
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7096 - rec_loss: 0.7096 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5312
val/lungOpacity_old_AUROC: 0.4776
val/lungOpacity_young_AP: 0.5569
val/lungOpacity_old_AP: 0.5058
val/lungOpacity_young_anomaly_score: 1.0166
val/lungOpacity_old_anomaly_score: 1.0132
val/lungOpacity_young_fpr@0.95: 0.9800
val/lungOpacity_old_fpr@0.95: 0.9600
val/lungOpacity_young_subgroupAUROC: 0.4972
val/lungOpacity_old_subgroupAUROC: 0.5088
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.8475
val/lungOpacity_young_rec_loss: 0.8475
val/lungOpacity_old_loss: 0.8422
val/lungOpacity_old_rec_loss: 0.8422

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4452
test/lungOpacity_old_AUROC: 0.5148
test/lungOpacity_young_AP: 0.4894
test/lungOpacity_old_AP: 0.5497
test/lungOpacity_young_anomaly_score: 1.0139
test/lungOpacity_old_anomaly_score: 1.0155
test/lungOpacity_young_fpr@0.95: 0.9600
test/lungOpacity_old_fpr@0.95: 0.9200
test/lungOpacity_young_subgroupAUROC: 0.4734
test/lungOpacity_old_subgroupAUROC: 0.4902
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.8480
test/lungOpacity_young_rec_loss: 0.8480
test/lungOpacity_old_loss: 0.8465
test/lungOpacity_old_rec_loss: 0.8465

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.54966
wandb:           test/lungOpacity_old_AUROC 0.5148
wandb:   test/lungOpacity_old_anomaly_score 1.0155
wandb:        test/lungOpacity_old_fpr@0.95 0.92
wandb:            test/lungOpacity_old_loss 0.84655
wandb:        test/lungOpacity_old_rec_loss 0.84655
wandb:   test/lungOpacity_old_subgroupAUROC 0.4902
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.48937
wandb:         test/lungOpacity_young_AUROC 0.4452
wandb: test/lungOpacity_young_anomaly_score 1.01389
wandb:      test/lungOpacity_young_fpr@0.95 0.96
wandb:          test/lungOpacity_young_loss 0.84797
wandb:      test/lungOpacity_young_rec_loss 0.84797
wandb: test/lungOpacity_young_subgroupAUROC 0.4734
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.70963
wandb:                       train/rec_loss 0.70963
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/28gclpj8
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs45/seed_5/wandb/run-20230930_114701-28gclpj8/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.005 (678 young and 678 old samples are available)
Using 3 young and 3 old samples for training.
Final dataset shape:  (6, 4)
Loaded datasets in 0.14s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_1/wandb/run-20230930_114731-l7be0d7c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/l7be0d7c
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7351 - rec_loss: 0.7351 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5696
val/lungOpacity_old_AUROC: 0.5544
val/lungOpacity_young_AP: 0.5546
val/lungOpacity_old_AP: 0.5539
val/lungOpacity_young_anomaly_score: 1.0005
val/lungOpacity_old_anomaly_score: 0.9955
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5370
val/lungOpacity_old_subgroupAUROC: 0.5832
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7995
val/lungOpacity_young_rec_loss: 0.7995
val/lungOpacity_old_loss: 0.7976
val/lungOpacity_old_rec_loss: 0.7976

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5708
test/lungOpacity_old_AUROC: 0.5972
test/lungOpacity_young_AP: 0.5621
test/lungOpacity_old_AP: 0.5835
test/lungOpacity_young_anomaly_score: 1.0012
test/lungOpacity_old_anomaly_score: 0.9993
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.5612
test/lungOpacity_old_subgroupAUROC: 0.6038
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.8029
test/lungOpacity_young_rec_loss: 0.8029
test/lungOpacity_old_loss: 0.8042
test/lungOpacity_old_rec_loss: 0.8042

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.041 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.58347
wandb:           test/lungOpacity_old_AUROC 0.5972
wandb:   test/lungOpacity_old_anomaly_score 0.99931
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.80422
wandb:        test/lungOpacity_old_rec_loss 0.80422
wandb:   test/lungOpacity_old_subgroupAUROC 0.6038
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.56213
wandb:         test/lungOpacity_young_AUROC 0.5708
wandb: test/lungOpacity_young_anomaly_score 1.0012
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.8029
wandb:      test/lungOpacity_young_rec_loss 0.8029
wandb: test/lungOpacity_young_subgroupAUROC 0.5612
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.73508
wandb:                       train/rec_loss 0.73508
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/l7be0d7c
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_1/wandb/run-20230930_114731-l7be0d7c/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_2/wandb/run-20230930_114749-cr9ivwvc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cr9ivwvc
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7295 - rec_loss: 0.7295 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5940
val/lungOpacity_old_AUROC: 0.5628
val/lungOpacity_young_AP: 0.5924
val/lungOpacity_old_AP: 0.5619
val/lungOpacity_young_anomaly_score: 0.9923
val/lungOpacity_old_anomaly_score: 0.9885
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5638
val/lungOpacity_old_subgroupAUROC: 0.5870
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7944
val/lungOpacity_young_rec_loss: 0.7944
val/lungOpacity_old_loss: 0.7931
val/lungOpacity_old_rec_loss: 0.7931

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5796
test/lungOpacity_old_AUROC: 0.6000
test/lungOpacity_young_AP: 0.5769
test/lungOpacity_old_AP: 0.5846
test/lungOpacity_young_anomaly_score: 0.9915
test/lungOpacity_old_anomaly_score: 0.9921
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.5762
test/lungOpacity_old_subgroupAUROC: 0.6038
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.7972
test/lungOpacity_young_rec_loss: 0.7972
test/lungOpacity_old_loss: 0.7998
test/lungOpacity_old_rec_loss: 0.7998

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.58456
wandb:           test/lungOpacity_old_AUROC 0.6
wandb:   test/lungOpacity_old_anomaly_score 0.99205
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.79981
wandb:        test/lungOpacity_old_rec_loss 0.79981
wandb:   test/lungOpacity_old_subgroupAUROC 0.6038
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.57688
wandb:         test/lungOpacity_young_AUROC 0.5796
wandb: test/lungOpacity_young_anomaly_score 0.99148
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.79723
wandb:      test/lungOpacity_young_rec_loss 0.79723
wandb: test/lungOpacity_young_subgroupAUROC 0.5762
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.72955
wandb:                       train/rec_loss 0.72955
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cr9ivwvc
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_2/wandb/run-20230930_114749-cr9ivwvc/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_3/wandb/run-20230930_114806-81g8v2xk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/81g8v2xk
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7218 - rec_loss: 0.7218 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5660
val/lungOpacity_old_AUROC: 0.5588
val/lungOpacity_young_AP: 0.5456
val/lungOpacity_old_AP: 0.5627
val/lungOpacity_young_anomaly_score: 0.9922
val/lungOpacity_old_anomaly_score: 0.9875
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.9400
val/lungOpacity_young_subgroupAUROC: 0.5356
val/lungOpacity_old_subgroupAUROC: 0.5838
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7930
val/lungOpacity_young_rec_loss: 0.7930
val/lungOpacity_old_loss: 0.7920
val/lungOpacity_old_rec_loss: 0.7920

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5516
test/lungOpacity_old_AUROC: 0.5832
test/lungOpacity_young_AP: 0.5390
test/lungOpacity_old_AP: 0.5757
test/lungOpacity_young_anomaly_score: 0.9920
test/lungOpacity_old_anomaly_score: 0.9903
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8800
test/lungOpacity_young_subgroupAUROC: 0.5492
test/lungOpacity_old_subgroupAUROC: 0.5894
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7959
test/lungOpacity_young_rec_loss: 0.7959
test/lungOpacity_old_loss: 0.7981
test/lungOpacity_old_rec_loss: 0.7981

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.57573
wandb:           test/lungOpacity_old_AUROC 0.5832
wandb:   test/lungOpacity_old_anomaly_score 0.99032
wandb:        test/lungOpacity_old_fpr@0.95 0.88
wandb:            test/lungOpacity_old_loss 0.79805
wandb:        test/lungOpacity_old_rec_loss 0.79805
wandb:   test/lungOpacity_old_subgroupAUROC 0.5894
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.53904
wandb:         test/lungOpacity_young_AUROC 0.5516
wandb: test/lungOpacity_young_anomaly_score 0.99199
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.79592
wandb:      test/lungOpacity_young_rec_loss 0.79592
wandb: test/lungOpacity_young_subgroupAUROC 0.5492
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.72176
wandb:                       train/rec_loss 0.72176
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/81g8v2xk
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_3/wandb/run-20230930_114806-81g8v2xk/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_4/wandb/run-20230930_114821-2a6i220i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/2a6i220i
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7248 - rec_loss: 0.7248 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5616
val/lungOpacity_old_AUROC: 0.5628
val/lungOpacity_young_AP: 0.5538
val/lungOpacity_old_AP: 0.5728
val/lungOpacity_young_anomaly_score: 0.9981
val/lungOpacity_old_anomaly_score: 0.9927
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.9600
val/lungOpacity_young_subgroupAUROC: 0.5378
val/lungOpacity_old_subgroupAUROC: 0.5882
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7985
val/lungOpacity_young_rec_loss: 0.7985
val/lungOpacity_old_loss: 0.7970
val/lungOpacity_old_rec_loss: 0.7970

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5484
test/lungOpacity_old_AUROC: 0.6016
test/lungOpacity_young_AP: 0.5499
test/lungOpacity_old_AP: 0.5789
test/lungOpacity_young_anomaly_score: 0.9981
test/lungOpacity_old_anomaly_score: 0.9965
test/lungOpacity_young_fpr@0.95: 0.8400
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.5494
test/lungOpacity_old_subgroupAUROC: 0.6044
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8022
test/lungOpacity_young_rec_loss: 0.8022
test/lungOpacity_old_loss: 0.8039
test/lungOpacity_old_rec_loss: 0.8039

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.57892
wandb:           test/lungOpacity_old_AUROC 0.6016
wandb:   test/lungOpacity_old_anomaly_score 0.99647
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.80391
wandb:        test/lungOpacity_old_rec_loss 0.80391
wandb:   test/lungOpacity_old_subgroupAUROC 0.6044
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.54994
wandb:         test/lungOpacity_young_AUROC 0.5484
wandb: test/lungOpacity_young_anomaly_score 0.99811
wandb:      test/lungOpacity_young_fpr@0.95 0.84
wandb:          test/lungOpacity_young_loss 0.80216
wandb:      test/lungOpacity_young_rec_loss 0.80216
wandb: test/lungOpacity_young_subgroupAUROC 0.5494
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.72475
wandb:                       train/rec_loss 0.72475
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/2a6i220i
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_4/wandb/run-20230930_114821-2a6i220i/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_5/wandb/run-20230930_114838-n8niwh04
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/n8niwh04
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7214 - rec_loss: 0.7214 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5772
val/lungOpacity_old_AUROC: 0.5520
val/lungOpacity_young_AP: 0.5544
val/lungOpacity_old_AP: 0.5790
val/lungOpacity_young_anomaly_score: 0.9979
val/lungOpacity_old_anomaly_score: 0.9939
val/lungOpacity_young_fpr@0.95: 0.8800
val/lungOpacity_old_fpr@0.95: 0.9200
val/lungOpacity_young_subgroupAUROC: 0.5446
val/lungOpacity_old_subgroupAUROC: 0.5786
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7959
val/lungOpacity_young_rec_loss: 0.7959
val/lungOpacity_old_loss: 0.7955
val/lungOpacity_old_rec_loss: 0.7955

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5604
test/lungOpacity_old_AUROC: 0.5984
test/lungOpacity_young_AP: 0.5581
test/lungOpacity_old_AP: 0.6145
test/lungOpacity_young_anomaly_score: 0.9979
test/lungOpacity_old_anomaly_score: 0.9985
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8800
test/lungOpacity_young_subgroupAUROC: 0.5582
test/lungOpacity_old_subgroupAUROC: 0.5954
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7985
test/lungOpacity_young_rec_loss: 0.7985
test/lungOpacity_old_loss: 0.8025
test/lungOpacity_old_rec_loss: 0.8025

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: - 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.61452
wandb:           test/lungOpacity_old_AUROC 0.5984
wandb:   test/lungOpacity_old_anomaly_score 0.99853
wandb:        test/lungOpacity_old_fpr@0.95 0.88
wandb:            test/lungOpacity_old_loss 0.80251
wandb:        test/lungOpacity_old_rec_loss 0.80251
wandb:   test/lungOpacity_old_subgroupAUROC 0.5954
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.55811
wandb:         test/lungOpacity_young_AUROC 0.5604
wandb: test/lungOpacity_young_anomaly_score 0.99785
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.79848
wandb:      test/lungOpacity_young_rec_loss 0.79848
wandb: test/lungOpacity_young_subgroupAUROC 0.5582
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.7214
wandb:                       train/rec_loss 0.7214
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/n8niwh04
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs45/seed_5/wandb/run-20230930_114838-n8niwh04/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.008 (678 young and 678 old samples are available)
Using 5 young and 5 old samples for training.
Final dataset shape:  (10, 4)
Loaded datasets in 0.15s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_1/wandb/run-20230930_114905-9zzxzil2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/9zzxzil2
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7515 - rec_loss: 0.7515 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6448
val/lungOpacity_old_AUROC: 0.6140
val/lungOpacity_young_AP: 0.6160
val/lungOpacity_old_AP: 0.5794
val/lungOpacity_young_anomaly_score: 0.9656
val/lungOpacity_old_anomaly_score: 0.9591
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6154
val/lungOpacity_old_subgroupAUROC: 0.6462
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.1000
val/lungOpacity_young_loss: 0.7684
val/lungOpacity_young_rec_loss: 0.7684
val/lungOpacity_old_loss: 0.7551
val/lungOpacity_old_rec_loss: 0.7551

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6688
test/lungOpacity_old_AUROC: 0.6560
test/lungOpacity_young_AP: 0.6478
test/lungOpacity_old_AP: 0.6252
test/lungOpacity_young_anomaly_score: 0.9680
test/lungOpacity_old_anomaly_score: 0.9636
test/lungOpacity_young_fpr@0.95: 0.7600
test/lungOpacity_old_fpr@0.95: 0.7600
test/lungOpacity_young_subgroupAUROC: 0.6486
test/lungOpacity_old_subgroupAUROC: 0.6752
test/lungOpacity_young_tpr@0.05: 0.1400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7722
test/lungOpacity_young_rec_loss: 0.7722
test/lungOpacity_old_loss: 0.7634
test/lungOpacity_old_rec_loss: 0.7634

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.62516
wandb:           test/lungOpacity_old_AUROC 0.656
wandb:   test/lungOpacity_old_anomaly_score 0.96357
wandb:        test/lungOpacity_old_fpr@0.95 0.76
wandb:            test/lungOpacity_old_loss 0.76343
wandb:        test/lungOpacity_old_rec_loss 0.76343
wandb:   test/lungOpacity_old_subgroupAUROC 0.6752
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.64777
wandb:         test/lungOpacity_young_AUROC 0.6688
wandb: test/lungOpacity_young_anomaly_score 0.96797
wandb:      test/lungOpacity_young_fpr@0.95 0.76
wandb:          test/lungOpacity_young_loss 0.77216
wandb:      test/lungOpacity_young_rec_loss 0.77216
wandb: test/lungOpacity_young_subgroupAUROC 0.6486
wandb:      test/lungOpacity_young_tpr@0.05 0.14
wandb:                           train/loss 0.75152
wandb:                       train/rec_loss 0.75152
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/9zzxzil2
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_1/wandb/run-20230930_114905-9zzxzil2/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_2/wandb/run-20230930_114923-aar07xfy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/aar07xfy
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7440 - rec_loss: 0.7440 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6556
val/lungOpacity_old_AUROC: 0.6472
val/lungOpacity_young_AP: 0.6103
val/lungOpacity_old_AP: 0.6074
val/lungOpacity_young_anomaly_score: 0.9566
val/lungOpacity_old_anomaly_score: 0.9454
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6166
val/lungOpacity_old_subgroupAUROC: 0.6762
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.7617
val/lungOpacity_young_rec_loss: 0.7617
val/lungOpacity_old_loss: 0.7449
val/lungOpacity_old_rec_loss: 0.7449

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6612
test/lungOpacity_old_AUROC: 0.6832
test/lungOpacity_young_AP: 0.6151
test/lungOpacity_old_AP: 0.6370
test/lungOpacity_young_anomaly_score: 0.9570
test/lungOpacity_old_anomaly_score: 0.9493
test/lungOpacity_young_fpr@0.95: 0.7200
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.6364
test/lungOpacity_old_subgroupAUROC: 0.7002
test/lungOpacity_young_tpr@0.05: 0.0200
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7642
test/lungOpacity_young_rec_loss: 0.7642
test/lungOpacity_old_loss: 0.7528
test/lungOpacity_old_rec_loss: 0.7528

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.63699
wandb:           test/lungOpacity_old_AUROC 0.6832
wandb:   test/lungOpacity_old_anomaly_score 0.94933
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.75279
wandb:        test/lungOpacity_old_rec_loss 0.75279
wandb:   test/lungOpacity_old_subgroupAUROC 0.7002
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.61506
wandb:         test/lungOpacity_young_AUROC 0.6612
wandb: test/lungOpacity_young_anomaly_score 0.95697
wandb:      test/lungOpacity_young_fpr@0.95 0.72
wandb:          test/lungOpacity_young_loss 0.76421
wandb:      test/lungOpacity_young_rec_loss 0.76421
wandb: test/lungOpacity_young_subgroupAUROC 0.6364
wandb:      test/lungOpacity_young_tpr@0.05 0.02
wandb:                           train/loss 0.74404
wandb:                       train/rec_loss 0.74404
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/aar07xfy
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_2/wandb/run-20230930_114923-aar07xfy/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_3/wandb/run-20230930_114939-wj4rwoze
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/wj4rwoze
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7381 - rec_loss: 0.7381 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6408
val/lungOpacity_old_AUROC: 0.6192
val/lungOpacity_young_AP: 0.5897
val/lungOpacity_old_AP: 0.5800
val/lungOpacity_young_anomaly_score: 0.9562
val/lungOpacity_old_anomaly_score: 0.9474
val/lungOpacity_young_fpr@0.95: 0.7800
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6126
val/lungOpacity_old_subgroupAUROC: 0.6480
val/lungOpacity_young_tpr@0.05: 0.0200
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.7605
val/lungOpacity_young_rec_loss: 0.7605
val/lungOpacity_old_loss: 0.7461
val/lungOpacity_old_rec_loss: 0.7461

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6612
test/lungOpacity_old_AUROC: 0.6508
test/lungOpacity_young_AP: 0.6048
test/lungOpacity_old_AP: 0.6107
test/lungOpacity_young_anomaly_score: 0.9581
test/lungOpacity_old_anomaly_score: 0.9509
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.6374
test/lungOpacity_old_subgroupAUROC: 0.6702
test/lungOpacity_young_tpr@0.05: 0.0200
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.7632
test/lungOpacity_young_rec_loss: 0.7632
test/lungOpacity_old_loss: 0.7536
test/lungOpacity_old_rec_loss: 0.7536

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.037 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: / 0.037 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.61075
wandb:           test/lungOpacity_old_AUROC 0.6508
wandb:   test/lungOpacity_old_anomaly_score 0.95089
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.75363
wandb:        test/lungOpacity_old_rec_loss 0.75363
wandb:   test/lungOpacity_old_subgroupAUROC 0.6702
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.60476
wandb:         test/lungOpacity_young_AUROC 0.6612
wandb: test/lungOpacity_young_anomaly_score 0.95815
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.76317
wandb:      test/lungOpacity_young_rec_loss 0.76317
wandb: test/lungOpacity_young_subgroupAUROC 0.6374
wandb:      test/lungOpacity_young_tpr@0.05 0.02
wandb:                           train/loss 0.73812
wandb:                       train/rec_loss 0.73812
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/wj4rwoze
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_3/wandb/run-20230930_114939-wj4rwoze/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_4/wandb/run-20230930_114955-j3p94f3v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/j3p94f3v
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7449 - rec_loss: 0.7449 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6324
val/lungOpacity_old_AUROC: 0.6216
val/lungOpacity_young_AP: 0.5881
val/lungOpacity_old_AP: 0.5942
val/lungOpacity_young_anomaly_score: 0.9644
val/lungOpacity_old_anomaly_score: 0.9544
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.8600
val/lungOpacity_young_subgroupAUROC: 0.6002
val/lungOpacity_old_subgroupAUROC: 0.6616
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7634
val/lungOpacity_young_rec_loss: 0.7634
val/lungOpacity_old_loss: 0.7512
val/lungOpacity_old_rec_loss: 0.7512

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6360
test/lungOpacity_old_AUROC: 0.6620
test/lungOpacity_young_AP: 0.6010
test/lungOpacity_old_AP: 0.6259
test/lungOpacity_young_anomaly_score: 0.9652
test/lungOpacity_old_anomaly_score: 0.9584
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.6212
test/lungOpacity_old_subgroupAUROC: 0.6800
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7677
test/lungOpacity_young_rec_loss: 0.7677
test/lungOpacity_old_loss: 0.7586
test/lungOpacity_old_rec_loss: 0.7586

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.62585
wandb:           test/lungOpacity_old_AUROC 0.662
wandb:   test/lungOpacity_old_anomaly_score 0.95837
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.75859
wandb:        test/lungOpacity_old_rec_loss 0.75859
wandb:   test/lungOpacity_old_subgroupAUROC 0.68
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.60096
wandb:         test/lungOpacity_young_AUROC 0.636
wandb: test/lungOpacity_young_anomaly_score 0.96524
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.76772
wandb:      test/lungOpacity_young_rec_loss 0.76772
wandb: test/lungOpacity_young_subgroupAUROC 0.6212
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.74486
wandb:                       train/rec_loss 0.74486
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/j3p94f3v
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_4/wandb/run-20230930_114955-j3p94f3v/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_5/wandb/run-20230930_115011-xt28631k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/xt28631k
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7384 - rec_loss: 0.7384 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6560
val/lungOpacity_old_AUROC: 0.6452
val/lungOpacity_young_AP: 0.6124
val/lungOpacity_old_AP: 0.6161
val/lungOpacity_young_anomaly_score: 0.9574
val/lungOpacity_old_anomaly_score: 0.9473
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6232
val/lungOpacity_old_subgroupAUROC: 0.6786
val/lungOpacity_young_tpr@0.05: 0.0400
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7649
val/lungOpacity_young_rec_loss: 0.7649
val/lungOpacity_old_loss: 0.7485
val/lungOpacity_old_rec_loss: 0.7485

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6644
test/lungOpacity_old_AUROC: 0.6952
test/lungOpacity_young_AP: 0.6285
test/lungOpacity_old_AP: 0.6533
test/lungOpacity_young_anomaly_score: 0.9589
test/lungOpacity_old_anomaly_score: 0.9531
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.6520
test/lungOpacity_old_subgroupAUROC: 0.7044
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7675
test/lungOpacity_young_rec_loss: 0.7675
test/lungOpacity_old_loss: 0.7566
test/lungOpacity_old_rec_loss: 0.7566

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.65327
wandb:           test/lungOpacity_old_AUROC 0.6952
wandb:   test/lungOpacity_old_anomaly_score 0.95307
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.75663
wandb:        test/lungOpacity_old_rec_loss 0.75663
wandb:   test/lungOpacity_old_subgroupAUROC 0.7044
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.62852
wandb:         test/lungOpacity_young_AUROC 0.6644
wandb: test/lungOpacity_young_anomaly_score 0.95895
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.76748
wandb:      test/lungOpacity_young_rec_loss 0.76748
wandb: test/lungOpacity_young_subgroupAUROC 0.652
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.73843
wandb:                       train/rec_loss 0.73843
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/xt28631k
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs45/seed_5/wandb/run-20230930_115011-xt28631k/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.001 (678 young and 678 old samples are available)
Using 1 young and 1 old samples for training.
Final dataset shape:  (2, 4)
Loaded datasets in 0.09s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_1/wandb/run-20230930_115039-czragjaj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/czragjaj
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6883 - rec_loss: 0.6883 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.4408
val/lungOpacity_old_AUROC: 0.5988
val/lungOpacity_young_AP: 0.4469
val/lungOpacity_old_AP: 0.5249
val/lungOpacity_young_anomaly_score: 1.0343
val/lungOpacity_old_anomaly_score: 1.0210
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.7800
val/lungOpacity_young_subgroupAUROC: 0.4218
val/lungOpacity_old_subgroupAUROC: 0.6102
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8349
val/lungOpacity_young_rec_loss: 0.8349
val/lungOpacity_old_loss: 0.8171
val/lungOpacity_old_rec_loss: 0.8171

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4668
test/lungOpacity_old_AUROC: 0.6300
test/lungOpacity_young_AP: 0.4583
test/lungOpacity_old_AP: 0.5665
test/lungOpacity_young_anomaly_score: 1.0369
test/lungOpacity_old_anomaly_score: 1.0236
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.7200
test/lungOpacity_young_subgroupAUROC: 0.4536
test/lungOpacity_old_subgroupAUROC: 0.6412
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0200
test/lungOpacity_young_loss: 0.8315
test/lungOpacity_young_rec_loss: 0.8315
test/lungOpacity_old_loss: 0.8137
test/lungOpacity_old_rec_loss: 0.8137

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.56649
wandb:           test/lungOpacity_old_AUROC 0.63
wandb:   test/lungOpacity_old_anomaly_score 1.02363
wandb:        test/lungOpacity_old_fpr@0.95 0.72
wandb:            test/lungOpacity_old_loss 0.81373
wandb:        test/lungOpacity_old_rec_loss 0.81373
wandb:   test/lungOpacity_old_subgroupAUROC 0.6412
wandb:        test/lungOpacity_old_tpr@0.05 0.02
wandb:            test/lungOpacity_young_AP 0.45833
wandb:         test/lungOpacity_young_AUROC 0.4668
wandb: test/lungOpacity_young_anomaly_score 1.03687
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.83149
wandb:      test/lungOpacity_young_rec_loss 0.83149
wandb: test/lungOpacity_young_subgroupAUROC 0.4536
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.68832
wandb:                       train/rec_loss 0.68832
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/czragjaj
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_1/wandb/run-20230930_115039-czragjaj/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_2/wandb/run-20230930_115058-wq3339px
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/wq3339px
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6892 - rec_loss: 0.6892 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.4472
val/lungOpacity_old_AUROC: 0.5960
val/lungOpacity_young_AP: 0.4485
val/lungOpacity_old_AP: 0.5235
val/lungOpacity_young_anomaly_score: 1.0295
val/lungOpacity_old_anomaly_score: 1.0163
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.4278
val/lungOpacity_old_subgroupAUROC: 0.6096
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8341
val/lungOpacity_young_rec_loss: 0.8341
val/lungOpacity_old_loss: 0.8168
val/lungOpacity_old_rec_loss: 0.8168

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4716
test/lungOpacity_old_AUROC: 0.6200
test/lungOpacity_young_AP: 0.4538
test/lungOpacity_old_AP: 0.5643
test/lungOpacity_young_anomaly_score: 1.0326
test/lungOpacity_old_anomaly_score: 1.0183
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.7200
test/lungOpacity_young_subgroupAUROC: 0.4458
test/lungOpacity_old_subgroupAUROC: 0.6412
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0000
test/lungOpacity_young_loss: 0.8310
test/lungOpacity_young_rec_loss: 0.8310
test/lungOpacity_old_loss: 0.8137
test/lungOpacity_old_rec_loss: 0.8137

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.56427
wandb:           test/lungOpacity_old_AUROC 0.62
wandb:   test/lungOpacity_old_anomaly_score 1.01829
wandb:        test/lungOpacity_old_fpr@0.95 0.72
wandb:            test/lungOpacity_old_loss 0.81372
wandb:        test/lungOpacity_old_rec_loss 0.81372
wandb:   test/lungOpacity_old_subgroupAUROC 0.6412
wandb:        test/lungOpacity_old_tpr@0.05 0.0
wandb:            test/lungOpacity_young_AP 0.45375
wandb:         test/lungOpacity_young_AUROC 0.4716
wandb: test/lungOpacity_young_anomaly_score 1.03258
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.83096
wandb:      test/lungOpacity_young_rec_loss 0.83096
wandb: test/lungOpacity_young_subgroupAUROC 0.4458
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.68916
wandb:                       train/rec_loss 0.68916
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/wq3339px
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_2/wandb/run-20230930_115058-wq3339px/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_3/wandb/run-20230930_115115-rbp8szt5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/rbp8szt5
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6815 - rec_loss: 0.6815 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.4396
val/lungOpacity_old_AUROC: 0.5952
val/lungOpacity_young_AP: 0.4449
val/lungOpacity_old_AP: 0.5256
val/lungOpacity_young_anomaly_score: 1.0299
val/lungOpacity_old_anomaly_score: 1.0165
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.7800
val/lungOpacity_young_subgroupAUROC: 0.4224
val/lungOpacity_old_subgroupAUROC: 0.6090
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8321
val/lungOpacity_young_rec_loss: 0.8321
val/lungOpacity_old_loss: 0.8141
val/lungOpacity_old_rec_loss: 0.8141

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4662
test/lungOpacity_old_AUROC: 0.6204
test/lungOpacity_young_AP: 0.4540
test/lungOpacity_old_AP: 0.5669
test/lungOpacity_young_anomaly_score: 1.0325
test/lungOpacity_old_anomaly_score: 1.0185
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.7400
test/lungOpacity_young_subgroupAUROC: 0.4478
test/lungOpacity_old_subgroupAUROC: 0.6370
test/lungOpacity_young_tpr@0.05: 0.0200
test/lungOpacity_old_tpr@0.05: 0.0200
test/lungOpacity_young_loss: 0.8286
test/lungOpacity_young_rec_loss: 0.8286
test/lungOpacity_old_loss: 0.8107
test/lungOpacity_old_rec_loss: 0.8107

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.56686
wandb:           test/lungOpacity_old_AUROC 0.6204
wandb:   test/lungOpacity_old_anomaly_score 1.01847
wandb:        test/lungOpacity_old_fpr@0.95 0.74
wandb:            test/lungOpacity_old_loss 0.81073
wandb:        test/lungOpacity_old_rec_loss 0.81073
wandb:   test/lungOpacity_old_subgroupAUROC 0.637
wandb:        test/lungOpacity_old_tpr@0.05 0.02
wandb:            test/lungOpacity_young_AP 0.45404
wandb:         test/lungOpacity_young_AUROC 0.4662
wandb: test/lungOpacity_young_anomaly_score 1.03252
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.82859
wandb:      test/lungOpacity_young_rec_loss 0.82859
wandb: test/lungOpacity_young_subgroupAUROC 0.4478
wandb:      test/lungOpacity_young_tpr@0.05 0.02
wandb:                           train/loss 0.68154
wandb:                       train/rec_loss 0.68154
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/rbp8szt5
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_3/wandb/run-20230930_115115-rbp8szt5/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_4/wandb/run-20230930_115131-9oreo5y6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/9oreo5y6
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6856 - rec_loss: 0.6856 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.4476
val/lungOpacity_old_AUROC: 0.6036
val/lungOpacity_young_AP: 0.4508
val/lungOpacity_old_AP: 0.5320
val/lungOpacity_young_anomaly_score: 1.0353
val/lungOpacity_old_anomaly_score: 1.0201
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.7800
val/lungOpacity_young_subgroupAUROC: 0.4236
val/lungOpacity_old_subgroupAUROC: 0.6222
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8337
val/lungOpacity_young_rec_loss: 0.8337
val/lungOpacity_old_loss: 0.8160
val/lungOpacity_old_rec_loss: 0.8160

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4688
test/lungOpacity_old_AUROC: 0.6340
test/lungOpacity_young_AP: 0.4499
test/lungOpacity_old_AP: 0.5610
test/lungOpacity_young_anomaly_score: 1.0377
test/lungOpacity_old_anomaly_score: 1.0225
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.7200
test/lungOpacity_young_subgroupAUROC: 0.4466
test/lungOpacity_old_subgroupAUROC: 0.6524
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0000
test/lungOpacity_young_loss: 0.8304
test/lungOpacity_young_rec_loss: 0.8304
test/lungOpacity_old_loss: 0.8130
test/lungOpacity_old_rec_loss: 0.8130

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.561
wandb:           test/lungOpacity_old_AUROC 0.634
wandb:   test/lungOpacity_old_anomaly_score 1.02249
wandb:        test/lungOpacity_old_fpr@0.95 0.72
wandb:            test/lungOpacity_old_loss 0.81301
wandb:        test/lungOpacity_old_rec_loss 0.81301
wandb:   test/lungOpacity_old_subgroupAUROC 0.6524
wandb:        test/lungOpacity_old_tpr@0.05 0.0
wandb:            test/lungOpacity_young_AP 0.44991
wandb:         test/lungOpacity_young_AUROC 0.4688
wandb: test/lungOpacity_young_anomaly_score 1.03771
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.83036
wandb:      test/lungOpacity_young_rec_loss 0.83036
wandb: test/lungOpacity_young_subgroupAUROC 0.4466
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.68563
wandb:                       train/rec_loss 0.68563
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/9oreo5y6
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_4/wandb/run-20230930_115131-9oreo5y6/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_5/wandb/run-20230930_115147-t58f9jz8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/t58f9jz8
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6809 - rec_loss: 0.6809 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.4552
val/lungOpacity_old_AUROC: 0.6052
val/lungOpacity_young_AP: 0.4489
val/lungOpacity_old_AP: 0.5352
val/lungOpacity_young_anomaly_score: 1.0315
val/lungOpacity_old_anomaly_score: 1.0179
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.7800
val/lungOpacity_young_subgroupAUROC: 0.4368
val/lungOpacity_old_subgroupAUROC: 0.6198
val/lungOpacity_young_tpr@0.05: 0.0000
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8314
val/lungOpacity_young_rec_loss: 0.8314
val/lungOpacity_old_loss: 0.8131
val/lungOpacity_old_rec_loss: 0.8131

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.4832
test/lungOpacity_old_AUROC: 0.6232
test/lungOpacity_young_AP: 0.4578
test/lungOpacity_old_AP: 0.5530
test/lungOpacity_young_anomaly_score: 1.0343
test/lungOpacity_old_anomaly_score: 1.0193
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.7200
test/lungOpacity_young_subgroupAUROC: 0.4544
test/lungOpacity_old_subgroupAUROC: 0.6416
test/lungOpacity_young_tpr@0.05: 0.0000
test/lungOpacity_old_tpr@0.05: 0.0000
test/lungOpacity_young_loss: 0.8280
test/lungOpacity_young_rec_loss: 0.8280
test/lungOpacity_old_loss: 0.8096
test/lungOpacity_old_rec_loss: 0.8096

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.55298
wandb:           test/lungOpacity_old_AUROC 0.6232
wandb:   test/lungOpacity_old_anomaly_score 1.01933
wandb:        test/lungOpacity_old_fpr@0.95 0.72
wandb:            test/lungOpacity_old_loss 0.80957
wandb:        test/lungOpacity_old_rec_loss 0.80957
wandb:   test/lungOpacity_old_subgroupAUROC 0.6416
wandb:        test/lungOpacity_old_tpr@0.05 0.0
wandb:            test/lungOpacity_young_AP 0.45781
wandb:         test/lungOpacity_young_AUROC 0.4832
wandb: test/lungOpacity_young_anomaly_score 1.03432
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.828
wandb:      test/lungOpacity_young_rec_loss 0.828
wandb: test/lungOpacity_young_subgroupAUROC 0.4544
wandb:      test/lungOpacity_young_tpr@0.05 0.0
wandb:                           train/loss 0.68095
wandb:                       train/rec_loss 0.68095
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/t58f9jz8
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs46/seed_5/wandb/run-20230930_115147-t58f9jz8/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.005 (678 young and 678 old samples are available)
Using 3 young and 3 old samples for training.
Final dataset shape:  (6, 4)
Loaded datasets in 0.12s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_1/wandb/run-20230930_115215-z7s2sro1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/z7s2sro1
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7354 - rec_loss: 0.7354 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7188
val/lungOpacity_old_AUROC: 0.6944
val/lungOpacity_young_AP: 0.6864
val/lungOpacity_old_AP: 0.6727
val/lungOpacity_young_anomaly_score: 0.9869
val/lungOpacity_old_anomaly_score: 0.9829
val/lungOpacity_young_fpr@0.95: 0.6600
val/lungOpacity_old_fpr@0.95: 0.7400
val/lungOpacity_young_subgroupAUROC: 0.6988
val/lungOpacity_old_subgroupAUROC: 0.7218
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.8020
val/lungOpacity_young_rec_loss: 0.8020
val/lungOpacity_old_loss: 0.7780
val/lungOpacity_old_rec_loss: 0.7780

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7416
test/lungOpacity_old_AUROC: 0.6436
test/lungOpacity_young_AP: 0.7334
test/lungOpacity_old_AP: 0.6429
test/lungOpacity_young_anomaly_score: 0.9883
test/lungOpacity_old_anomaly_score: 0.9788
test/lungOpacity_young_fpr@0.95: 0.7000
test/lungOpacity_old_fpr@0.95: 0.7600
test/lungOpacity_young_subgroupAUROC: 0.6880
test/lungOpacity_old_subgroupAUROC: 0.7020
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7996
test/lungOpacity_young_rec_loss: 0.7996
test/lungOpacity_old_loss: 0.7672
test/lungOpacity_old_rec_loss: 0.7672

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64286
wandb:           test/lungOpacity_old_AUROC 0.6436
wandb:   test/lungOpacity_old_anomaly_score 0.97881
wandb:        test/lungOpacity_old_fpr@0.95 0.76
wandb:            test/lungOpacity_old_loss 0.76722
wandb:        test/lungOpacity_old_rec_loss 0.76722
wandb:   test/lungOpacity_old_subgroupAUROC 0.702
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.73345
wandb:         test/lungOpacity_young_AUROC 0.7416
wandb: test/lungOpacity_young_anomaly_score 0.98827
wandb:      test/lungOpacity_young_fpr@0.95 0.7
wandb:          test/lungOpacity_young_loss 0.79961
wandb:      test/lungOpacity_young_rec_loss 0.79961
wandb: test/lungOpacity_young_subgroupAUROC 0.688
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.73536
wandb:                       train/rec_loss 0.73536
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/z7s2sro1
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_1/wandb/run-20230930_115215-z7s2sro1/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_2/wandb/run-20230930_115233-utq0ftvv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/utq0ftvv
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7321 - rec_loss: 0.7321 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7556
val/lungOpacity_old_AUROC: 0.7124
val/lungOpacity_young_AP: 0.7123
val/lungOpacity_old_AP: 0.6843
val/lungOpacity_young_anomaly_score: 0.9862
val/lungOpacity_old_anomaly_score: 0.9839
val/lungOpacity_young_fpr@0.95: 0.6400
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.7326
val/lungOpacity_old_subgroupAUROC: 0.7344
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.1600
val/lungOpacity_young_loss: 0.8021
val/lungOpacity_young_rec_loss: 0.8021
val/lungOpacity_old_loss: 0.7798
val/lungOpacity_old_rec_loss: 0.7798

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7460
test/lungOpacity_old_AUROC: 0.6520
test/lungOpacity_young_AP: 0.7222
test/lungOpacity_old_AP: 0.6422
test/lungOpacity_young_anomaly_score: 0.9852
test/lungOpacity_old_anomaly_score: 0.9796
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.7002
test/lungOpacity_old_subgroupAUROC: 0.7006
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7999
test/lungOpacity_young_rec_loss: 0.7999
test/lungOpacity_old_loss: 0.7707
test/lungOpacity_old_rec_loss: 0.7707

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64218
wandb:           test/lungOpacity_old_AUROC 0.652
wandb:   test/lungOpacity_old_anomaly_score 0.97959
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.77073
wandb:        test/lungOpacity_old_rec_loss 0.77073
wandb:   test/lungOpacity_old_subgroupAUROC 0.7006
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.72224
wandb:         test/lungOpacity_young_AUROC 0.746
wandb: test/lungOpacity_young_anomaly_score 0.98522
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.79988
wandb:      test/lungOpacity_young_rec_loss 0.79988
wandb: test/lungOpacity_young_subgroupAUROC 0.7002
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.73214
wandb:                       train/rec_loss 0.73214
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/utq0ftvv
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_2/wandb/run-20230930_115233-utq0ftvv/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_3/wandb/run-20230930_115248-kdnfvjo6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/kdnfvjo6
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7272 - rec_loss: 0.7272 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7188
val/lungOpacity_old_AUROC: 0.6884
val/lungOpacity_young_AP: 0.6894
val/lungOpacity_old_AP: 0.6623
val/lungOpacity_young_anomaly_score: 0.9837
val/lungOpacity_old_anomaly_score: 0.9804
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.7400
val/lungOpacity_young_subgroupAUROC: 0.7006
val/lungOpacity_old_subgroupAUROC: 0.7100
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.1200
val/lungOpacity_young_loss: 0.7992
val/lungOpacity_young_rec_loss: 0.7992
val/lungOpacity_old_loss: 0.7745
val/lungOpacity_old_rec_loss: 0.7745

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7324
test/lungOpacity_old_AUROC: 0.6324
test/lungOpacity_young_AP: 0.7133
test/lungOpacity_old_AP: 0.6154
test/lungOpacity_young_anomaly_score: 0.9847
test/lungOpacity_old_anomaly_score: 0.9759
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.7600
test/lungOpacity_young_subgroupAUROC: 0.6818
test/lungOpacity_old_subgroupAUROC: 0.6840
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7977
test/lungOpacity_young_rec_loss: 0.7977
test/lungOpacity_old_loss: 0.7636
test/lungOpacity_old_rec_loss: 0.7636

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.61536
wandb:           test/lungOpacity_old_AUROC 0.6324
wandb:   test/lungOpacity_old_anomaly_score 0.97594
wandb:        test/lungOpacity_old_fpr@0.95 0.76
wandb:            test/lungOpacity_old_loss 0.76362
wandb:        test/lungOpacity_old_rec_loss 0.76362
wandb:   test/lungOpacity_old_subgroupAUROC 0.684
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.71329
wandb:         test/lungOpacity_young_AUROC 0.7324
wandb: test/lungOpacity_young_anomaly_score 0.98468
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.79773
wandb:      test/lungOpacity_young_rec_loss 0.79773
wandb: test/lungOpacity_young_subgroupAUROC 0.6818
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.7272
wandb:                       train/rec_loss 0.7272
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/kdnfvjo6
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_3/wandb/run-20230930_115248-kdnfvjo6/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_4/wandb/run-20230930_115305-8nmhwe3y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8nmhwe3y
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7276 - rec_loss: 0.7276 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7348
val/lungOpacity_old_AUROC: 0.7064
val/lungOpacity_young_AP: 0.6871
val/lungOpacity_old_AP: 0.6841
val/lungOpacity_young_anomaly_score: 0.9858
val/lungOpacity_old_anomaly_score: 0.9812
val/lungOpacity_young_fpr@0.95: 0.7200
val/lungOpacity_old_fpr@0.95: 0.7400
val/lungOpacity_young_subgroupAUROC: 0.7156
val/lungOpacity_old_subgroupAUROC: 0.7280
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.8035
val/lungOpacity_young_rec_loss: 0.8035
val/lungOpacity_old_loss: 0.7784
val/lungOpacity_old_rec_loss: 0.7784

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7236
test/lungOpacity_old_AUROC: 0.6472
test/lungOpacity_young_AP: 0.6756
test/lungOpacity_old_AP: 0.6471
test/lungOpacity_young_anomaly_score: 0.9853
test/lungOpacity_old_anomaly_score: 0.9768
test/lungOpacity_young_fpr@0.95: 0.7800
test/lungOpacity_old_fpr@0.95: 0.8200
test/lungOpacity_young_subgroupAUROC: 0.6794
test/lungOpacity_old_subgroupAUROC: 0.6962
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.8007
test/lungOpacity_young_rec_loss: 0.8007
test/lungOpacity_old_loss: 0.7679
test/lungOpacity_old_rec_loss: 0.7679

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64707
wandb:           test/lungOpacity_old_AUROC 0.6472
wandb:   test/lungOpacity_old_anomaly_score 0.9768
wandb:        test/lungOpacity_old_fpr@0.95 0.82
wandb:            test/lungOpacity_old_loss 0.7679
wandb:        test/lungOpacity_old_rec_loss 0.7679
wandb:   test/lungOpacity_old_subgroupAUROC 0.6962
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.67563
wandb:         test/lungOpacity_young_AUROC 0.7236
wandb: test/lungOpacity_young_anomaly_score 0.98534
wandb:      test/lungOpacity_young_fpr@0.95 0.78
wandb:          test/lungOpacity_young_loss 0.80072
wandb:      test/lungOpacity_young_rec_loss 0.80072
wandb: test/lungOpacity_young_subgroupAUROC 0.6794
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.7276
wandb:                       train/rec_loss 0.7276
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8nmhwe3y
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_4/wandb/run-20230930_115305-8nmhwe3y/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_5/wandb/run-20230930_115321-ulmdr5is
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ulmdr5is
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7274 - rec_loss: 0.7274 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7260
val/lungOpacity_old_AUROC: 0.7048
val/lungOpacity_young_AP: 0.6775
val/lungOpacity_old_AP: 0.6862
val/lungOpacity_young_anomaly_score: 0.9820
val/lungOpacity_old_anomaly_score: 0.9796
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.7400
val/lungOpacity_young_subgroupAUROC: 0.7104
val/lungOpacity_old_subgroupAUROC: 0.7210
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7995
val/lungOpacity_young_rec_loss: 0.7995
val/lungOpacity_old_loss: 0.7766
val/lungOpacity_old_rec_loss: 0.7766

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7332
test/lungOpacity_old_AUROC: 0.6580
test/lungOpacity_young_AP: 0.6938
test/lungOpacity_old_AP: 0.6614
test/lungOpacity_young_anomaly_score: 0.9829
test/lungOpacity_old_anomaly_score: 0.9764
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.6906
test/lungOpacity_old_subgroupAUROC: 0.6990
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7973
test/lungOpacity_young_rec_loss: 0.7973
test/lungOpacity_old_loss: 0.7665
test/lungOpacity_old_rec_loss: 0.7665

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.66137
wandb:           test/lungOpacity_old_AUROC 0.658
wandb:   test/lungOpacity_old_anomaly_score 0.97637
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.76646
wandb:        test/lungOpacity_old_rec_loss 0.76646
wandb:   test/lungOpacity_old_subgroupAUROC 0.699
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.69381
wandb:         test/lungOpacity_young_AUROC 0.7332
wandb: test/lungOpacity_young_anomaly_score 0.98286
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.79732
wandb:      test/lungOpacity_young_rec_loss 0.79732
wandb: test/lungOpacity_young_subgroupAUROC 0.6906
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.72736
wandb:                       train/rec_loss 0.72736
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ulmdr5is
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs46/seed_5/wandb/run-20230930_115321-ulmdr5is/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.008 (678 young and 678 old samples are available)
Using 5 young and 5 old samples for training.
Final dataset shape:  (10, 4)
Loaded datasets in 0.15s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_1/wandb/run-20230930_115347-abm0c65m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/abm0c65m
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7581 - rec_loss: 0.7581 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7108
val/lungOpacity_old_AUROC: 0.7008
val/lungOpacity_young_AP: 0.6762
val/lungOpacity_old_AP: 0.7086
val/lungOpacity_young_anomaly_score: 0.9574
val/lungOpacity_old_anomaly_score: 0.9451
val/lungOpacity_young_fpr@0.95: 0.8000
val/lungOpacity_old_fpr@0.95: 0.8200
val/lungOpacity_young_subgroupAUROC: 0.6664
val/lungOpacity_old_subgroupAUROC: 0.7458
val/lungOpacity_young_tpr@0.05: 0.2600
val/lungOpacity_old_tpr@0.05: 0.1800
val/lungOpacity_young_loss: 0.7704
val/lungOpacity_young_rec_loss: 0.7704
val/lungOpacity_old_loss: 0.7498
val/lungOpacity_old_rec_loss: 0.7498

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7852
test/lungOpacity_old_AUROC: 0.6876
test/lungOpacity_young_AP: 0.7624
test/lungOpacity_old_AP: 0.6993
test/lungOpacity_young_anomaly_score: 0.9664
test/lungOpacity_old_anomaly_score: 0.9428
test/lungOpacity_young_fpr@0.95: 0.7600
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6934
test/lungOpacity_old_subgroupAUROC: 0.7764
test/lungOpacity_young_tpr@0.05: 0.4600
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7687
test/lungOpacity_young_rec_loss: 0.7687
test/lungOpacity_old_loss: 0.7380
test/lungOpacity_old_rec_loss: 0.7380

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.043 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.69931
wandb:           test/lungOpacity_old_AUROC 0.6876
wandb:   test/lungOpacity_old_anomaly_score 0.94283
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.738
wandb:        test/lungOpacity_old_rec_loss 0.738
wandb:   test/lungOpacity_old_subgroupAUROC 0.7764
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.76238
wandb:         test/lungOpacity_young_AUROC 0.7852
wandb: test/lungOpacity_young_anomaly_score 0.96639
wandb:      test/lungOpacity_young_fpr@0.95 0.76
wandb:          test/lungOpacity_young_loss 0.76872
wandb:      test/lungOpacity_young_rec_loss 0.76872
wandb: test/lungOpacity_young_subgroupAUROC 0.6934
wandb:      test/lungOpacity_young_tpr@0.05 0.46
wandb:                           train/loss 0.75814
wandb:                       train/rec_loss 0.75814
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/abm0c65m
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_1/wandb/run-20230930_115347-abm0c65m/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_2/wandb/run-20230930_115404-b8wgn2gy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/b8wgn2gy
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7502 - rec_loss: 0.7502 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6948
val/lungOpacity_old_AUROC: 0.7016
val/lungOpacity_young_AP: 0.6679
val/lungOpacity_old_AP: 0.7025
val/lungOpacity_young_anomaly_score: 0.9500
val/lungOpacity_old_anomaly_score: 0.9385
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.6556
val/lungOpacity_old_subgroupAUROC: 0.7418
val/lungOpacity_young_tpr@0.05: 0.3000
val/lungOpacity_old_tpr@0.05: 0.2000
val/lungOpacity_young_loss: 0.7668
val/lungOpacity_young_rec_loss: 0.7668
val/lungOpacity_old_loss: 0.7458
val/lungOpacity_old_rec_loss: 0.7458

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7788
test/lungOpacity_old_AUROC: 0.6732
test/lungOpacity_young_AP: 0.7588
test/lungOpacity_old_AP: 0.6803
test/lungOpacity_young_anomaly_score: 0.9598
test/lungOpacity_old_anomaly_score: 0.9346
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.6794
test/lungOpacity_old_subgroupAUROC: 0.7664
test/lungOpacity_young_tpr@0.05: 0.4800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7650
test/lungOpacity_young_rec_loss: 0.7650
test/lungOpacity_old_loss: 0.7341
test/lungOpacity_old_rec_loss: 0.7341

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68026
wandb:           test/lungOpacity_old_AUROC 0.6732
wandb:   test/lungOpacity_old_anomaly_score 0.93459
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.7341
wandb:        test/lungOpacity_old_rec_loss 0.7341
wandb:   test/lungOpacity_old_subgroupAUROC 0.7664
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.75878
wandb:         test/lungOpacity_young_AUROC 0.7788
wandb: test/lungOpacity_young_anomaly_score 0.95976
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.76499
wandb:      test/lungOpacity_young_rec_loss 0.76499
wandb: test/lungOpacity_young_subgroupAUROC 0.6794
wandb:      test/lungOpacity_young_tpr@0.05 0.48
wandb:                           train/loss 0.75022
wandb:                       train/rec_loss 0.75022
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/b8wgn2gy
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_2/wandb/run-20230930_115404-b8wgn2gy/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_3/wandb/run-20230930_115421-tz8o4j0v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/tz8o4j0v
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7421 - rec_loss: 0.7421 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7100
val/lungOpacity_old_AUROC: 0.6756
val/lungOpacity_young_AP: 0.6951
val/lungOpacity_old_AP: 0.6891
val/lungOpacity_young_anomaly_score: 0.9513
val/lungOpacity_old_anomaly_score: 0.9378
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.6592
val/lungOpacity_old_subgroupAUROC: 0.7318
val/lungOpacity_young_tpr@0.05: 0.2600
val/lungOpacity_old_tpr@0.05: 0.1800
val/lungOpacity_young_loss: 0.7671
val/lungOpacity_young_rec_loss: 0.7671
val/lungOpacity_old_loss: 0.7439
val/lungOpacity_old_rec_loss: 0.7439

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7900
test/lungOpacity_old_AUROC: 0.6820
test/lungOpacity_young_AP: 0.7727
test/lungOpacity_old_AP: 0.6854
test/lungOpacity_young_anomaly_score: 0.9603
test/lungOpacity_old_anomaly_score: 0.9363
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.6940
test/lungOpacity_old_subgroupAUROC: 0.7716
test/lungOpacity_young_tpr@0.05: 0.3600
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.7652
test/lungOpacity_young_rec_loss: 0.7652
test/lungOpacity_old_loss: 0.7308
test/lungOpacity_old_rec_loss: 0.7308

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.68542
wandb:           test/lungOpacity_old_AUROC 0.682
wandb:   test/lungOpacity_old_anomaly_score 0.93629
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.73083
wandb:        test/lungOpacity_old_rec_loss 0.73083
wandb:   test/lungOpacity_old_subgroupAUROC 0.7716
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.77268
wandb:         test/lungOpacity_young_AUROC 0.79
wandb: test/lungOpacity_young_anomaly_score 0.96032
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.76523
wandb:      test/lungOpacity_young_rec_loss 0.76523
wandb: test/lungOpacity_young_subgroupAUROC 0.694
wandb:      test/lungOpacity_young_tpr@0.05 0.36
wandb:                           train/loss 0.74208
wandb:                       train/rec_loss 0.74208
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/tz8o4j0v
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_3/wandb/run-20230930_115421-tz8o4j0v/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_4/wandb/run-20230930_115439-tgh81y0q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/tgh81y0q
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7480 - rec_loss: 0.7480 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7012
val/lungOpacity_old_AUROC: 0.6628
val/lungOpacity_young_AP: 0.6657
val/lungOpacity_old_AP: 0.6795
val/lungOpacity_young_anomaly_score: 0.9474
val/lungOpacity_old_anomaly_score: 0.9395
val/lungOpacity_young_fpr@0.95: 0.6800
val/lungOpacity_old_fpr@0.95: 0.7000
val/lungOpacity_young_subgroupAUROC: 0.6632
val/lungOpacity_old_subgroupAUROC: 0.7112
val/lungOpacity_young_tpr@0.05: 0.1800
val/lungOpacity_old_tpr@0.05: 0.1800
val/lungOpacity_young_loss: 0.7640
val/lungOpacity_young_rec_loss: 0.7640
val/lungOpacity_old_loss: 0.7433
val/lungOpacity_old_rec_loss: 0.7433

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7820
test/lungOpacity_old_AUROC: 0.6612
test/lungOpacity_young_AP: 0.7414
test/lungOpacity_old_AP: 0.6499
test/lungOpacity_young_anomaly_score: 0.9574
test/lungOpacity_old_anomaly_score: 0.9377
test/lungOpacity_young_fpr@0.95: 0.6800
test/lungOpacity_old_fpr@0.95: 0.7000
test/lungOpacity_young_subgroupAUROC: 0.7006
test/lungOpacity_old_subgroupAUROC: 0.7536
test/lungOpacity_young_tpr@0.05: 0.3400
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.7628
test/lungOpacity_young_rec_loss: 0.7628
test/lungOpacity_old_loss: 0.7318
test/lungOpacity_old_rec_loss: 0.7318

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.044 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64987
wandb:           test/lungOpacity_old_AUROC 0.6612
wandb:   test/lungOpacity_old_anomaly_score 0.93766
wandb:        test/lungOpacity_old_fpr@0.95 0.7
wandb:            test/lungOpacity_old_loss 0.73183
wandb:        test/lungOpacity_old_rec_loss 0.73183
wandb:   test/lungOpacity_old_subgroupAUROC 0.7536
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.74137
wandb:         test/lungOpacity_young_AUROC 0.782
wandb: test/lungOpacity_young_anomaly_score 0.95742
wandb:      test/lungOpacity_young_fpr@0.95 0.68
wandb:          test/lungOpacity_young_loss 0.76278
wandb:      test/lungOpacity_young_rec_loss 0.76278
wandb: test/lungOpacity_young_subgroupAUROC 0.7006
wandb:      test/lungOpacity_young_tpr@0.05 0.34
wandb:                           train/loss 0.74796
wandb:                       train/rec_loss 0.74796
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/tgh81y0q
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_4/wandb/run-20230930_115439-tgh81y0q/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_5/wandb/run-20230930_115455-xsq8miys
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/xsq8miys
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7452 - rec_loss: 0.7452 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6824
val/lungOpacity_old_AUROC: 0.6908
val/lungOpacity_young_AP: 0.6521
val/lungOpacity_old_AP: 0.6929
val/lungOpacity_young_anomaly_score: 0.9538
val/lungOpacity_old_anomaly_score: 0.9440
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.8600
val/lungOpacity_young_subgroupAUROC: 0.6490
val/lungOpacity_old_subgroupAUROC: 0.7278
val/lungOpacity_young_tpr@0.05: 0.2400
val/lungOpacity_old_tpr@0.05: 0.1800
val/lungOpacity_young_loss: 0.7660
val/lungOpacity_young_rec_loss: 0.7660
val/lungOpacity_old_loss: 0.7450
val/lungOpacity_old_rec_loss: 0.7450

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7644
test/lungOpacity_old_AUROC: 0.6756
test/lungOpacity_young_AP: 0.7311
test/lungOpacity_old_AP: 0.6763
test/lungOpacity_young_anomaly_score: 0.9634
test/lungOpacity_old_anomaly_score: 0.9412
test/lungOpacity_young_fpr@0.95: 0.7600
test/lungOpacity_old_fpr@0.95: 0.8600
test/lungOpacity_young_subgroupAUROC: 0.6726
test/lungOpacity_old_subgroupAUROC: 0.7622
test/lungOpacity_young_tpr@0.05: 0.2800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7648
test/lungOpacity_young_rec_loss: 0.7648
test/lungOpacity_old_loss: 0.7339
test/lungOpacity_old_rec_loss: 0.7339

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.67632
wandb:           test/lungOpacity_old_AUROC 0.6756
wandb:   test/lungOpacity_old_anomaly_score 0.94117
wandb:        test/lungOpacity_old_fpr@0.95 0.86
wandb:            test/lungOpacity_old_loss 0.7339
wandb:        test/lungOpacity_old_rec_loss 0.7339
wandb:   test/lungOpacity_old_subgroupAUROC 0.7622
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.73105
wandb:         test/lungOpacity_young_AUROC 0.7644
wandb: test/lungOpacity_young_anomaly_score 0.96344
wandb:      test/lungOpacity_young_fpr@0.95 0.76
wandb:          test/lungOpacity_young_loss 0.76476
wandb:      test/lungOpacity_young_rec_loss 0.76476
wandb: test/lungOpacity_young_subgroupAUROC 0.6726
wandb:      test/lungOpacity_young_tpr@0.05 0.28
wandb:                           train/loss 0.74521
wandb:                       train/rec_loss 0.74521
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/xsq8miys
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs46/seed_5/wandb/run-20230930_115455-xsq8miys/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.001 (678 young and 678 old samples are available)
Using 1 young and 1 old samples for training.
Final dataset shape:  (2, 4)
Loaded datasets in 0.08s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_1/wandb/run-20230930_115522-byzv2yrq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/byzv2yrq
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6988 - rec_loss: 0.6988 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6116
val/lungOpacity_old_AUROC: 0.5932
val/lungOpacity_young_AP: 0.6219
val/lungOpacity_old_AP: 0.5358
val/lungOpacity_young_anomaly_score: 1.0096
val/lungOpacity_old_anomaly_score: 0.9999
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.8000
val/lungOpacity_young_subgroupAUROC: 0.5686
val/lungOpacity_old_subgroupAUROC: 0.6334
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.8128
val/lungOpacity_young_rec_loss: 0.8128
val/lungOpacity_old_loss: 0.7977
val/lungOpacity_old_rec_loss: 0.7977

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5680
test/lungOpacity_old_AUROC: 0.6584
test/lungOpacity_young_AP: 0.5468
test/lungOpacity_old_AP: 0.6266
test/lungOpacity_young_anomaly_score: 1.0067
test/lungOpacity_old_anomaly_score: 1.0049
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.5814
test/lungOpacity_old_subgroupAUROC: 0.6490
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.8163
test/lungOpacity_young_rec_loss: 0.8163
test/lungOpacity_old_loss: 0.7994
test/lungOpacity_old_rec_loss: 0.7994

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.62656
wandb:           test/lungOpacity_old_AUROC 0.6584
wandb:   test/lungOpacity_old_anomaly_score 1.00492
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.79944
wandb:        test/lungOpacity_old_rec_loss 0.79944
wandb:   test/lungOpacity_old_subgroupAUROC 0.649
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.54676
wandb:         test/lungOpacity_young_AUROC 0.568
wandb: test/lungOpacity_young_anomaly_score 1.00665
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.8163
wandb:      test/lungOpacity_young_rec_loss 0.8163
wandb: test/lungOpacity_young_subgroupAUROC 0.5814
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.69882
wandb:                       train/rec_loss 0.69882
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/byzv2yrq
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_1/wandb/run-20230930_115522-byzv2yrq/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_2/wandb/run-20230930_115540-11kokd10
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/11kokd10
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6929 - rec_loss: 0.6929 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5880
val/lungOpacity_old_AUROC: 0.6004
val/lungOpacity_young_AP: 0.5827
val/lungOpacity_old_AP: 0.5335
val/lungOpacity_young_anomaly_score: 1.0051
val/lungOpacity_old_anomaly_score: 0.9956
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.7800
val/lungOpacity_young_subgroupAUROC: 0.5522
val/lungOpacity_old_subgroupAUROC: 0.6284
val/lungOpacity_young_tpr@0.05: 0.0600
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.8046
val/lungOpacity_young_rec_loss: 0.8046
val/lungOpacity_old_loss: 0.7887
val/lungOpacity_old_rec_loss: 0.7887

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5684
test/lungOpacity_old_AUROC: 0.6356
test/lungOpacity_young_AP: 0.5362
test/lungOpacity_old_AP: 0.5980
test/lungOpacity_young_anomaly_score: 1.0037
test/lungOpacity_old_anomaly_score: 0.9998
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.7800
test/lungOpacity_young_subgroupAUROC: 0.5722
test/lungOpacity_old_subgroupAUROC: 0.6408
test/lungOpacity_young_tpr@0.05: 0.0200
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.8086
test/lungOpacity_young_rec_loss: 0.8086
test/lungOpacity_old_loss: 0.7906
test/lungOpacity_old_rec_loss: 0.7906

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.59803
wandb:           test/lungOpacity_old_AUROC 0.6356
wandb:   test/lungOpacity_old_anomaly_score 0.9998
wandb:        test/lungOpacity_old_fpr@0.95 0.78
wandb:            test/lungOpacity_old_loss 0.79057
wandb:        test/lungOpacity_old_rec_loss 0.79057
wandb:   test/lungOpacity_old_subgroupAUROC 0.6408
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.53616
wandb:         test/lungOpacity_young_AUROC 0.5684
wandb: test/lungOpacity_young_anomaly_score 1.00368
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.80861
wandb:      test/lungOpacity_young_rec_loss 0.80861
wandb: test/lungOpacity_young_subgroupAUROC 0.5722
wandb:      test/lungOpacity_young_tpr@0.05 0.02
wandb:                           train/loss 0.69289
wandb:                       train/rec_loss 0.69289
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/11kokd10
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_2/wandb/run-20230930_115540-11kokd10/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_3/wandb/run-20230930_115556-du3yugxh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/du3yugxh
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6930 - rec_loss: 0.6930 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.5956
val/lungOpacity_old_AUROC: 0.5700
val/lungOpacity_young_AP: 0.5944
val/lungOpacity_old_AP: 0.5259
val/lungOpacity_young_anomaly_score: 1.0024
val/lungOpacity_old_anomaly_score: 0.9933
val/lungOpacity_young_fpr@0.95: 0.8400
val/lungOpacity_old_fpr@0.95: 0.8400
val/lungOpacity_young_subgroupAUROC: 0.5584
val/lungOpacity_old_subgroupAUROC: 0.6110
val/lungOpacity_young_tpr@0.05: 0.1200
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8046
val/lungOpacity_young_rec_loss: 0.8046
val/lungOpacity_old_loss: 0.7894
val/lungOpacity_old_rec_loss: 0.7894

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5652
test/lungOpacity_old_AUROC: 0.6364
test/lungOpacity_young_AP: 0.5405
test/lungOpacity_old_AP: 0.6066
test/lungOpacity_young_anomaly_score: 1.0001
test/lungOpacity_old_anomaly_score: 0.9979
test/lungOpacity_young_fpr@0.95: 0.8400
test/lungOpacity_old_fpr@0.95: 0.8400
test/lungOpacity_young_subgroupAUROC: 0.5730
test/lungOpacity_old_subgroupAUROC: 0.6312
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.8087
test/lungOpacity_young_rec_loss: 0.8087
test/lungOpacity_old_loss: 0.7913
test/lungOpacity_old_rec_loss: 0.7913

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.60659
wandb:           test/lungOpacity_old_AUROC 0.6364
wandb:   test/lungOpacity_old_anomaly_score 0.9979
wandb:        test/lungOpacity_old_fpr@0.95 0.84
wandb:            test/lungOpacity_old_loss 0.79127
wandb:        test/lungOpacity_old_rec_loss 0.79127
wandb:   test/lungOpacity_old_subgroupAUROC 0.6312
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.5405
wandb:         test/lungOpacity_young_AUROC 0.5652
wandb: test/lungOpacity_young_anomaly_score 1.00008
wandb:      test/lungOpacity_young_fpr@0.95 0.84
wandb:          test/lungOpacity_young_loss 0.80874
wandb:      test/lungOpacity_young_rec_loss 0.80874
wandb: test/lungOpacity_young_subgroupAUROC 0.573
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.69302
wandb:                       train/rec_loss 0.69302
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/du3yugxh
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_3/wandb/run-20230930_115556-du3yugxh/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_4/wandb/run-20230930_115613-7rvpjzr6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/7rvpjzr6
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6936 - rec_loss: 0.6936 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6040
val/lungOpacity_old_AUROC: 0.6000
val/lungOpacity_young_AP: 0.6160
val/lungOpacity_old_AP: 0.5397
val/lungOpacity_young_anomaly_score: 1.0066
val/lungOpacity_old_anomaly_score: 0.9972
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.7200
val/lungOpacity_young_subgroupAUROC: 0.5642
val/lungOpacity_old_subgroupAUROC: 0.6346
val/lungOpacity_young_tpr@0.05: 0.1600
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8082
val/lungOpacity_young_rec_loss: 0.8082
val/lungOpacity_old_loss: 0.7933
val/lungOpacity_old_rec_loss: 0.7933

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5644
test/lungOpacity_old_AUROC: 0.6484
test/lungOpacity_young_AP: 0.5497
test/lungOpacity_old_AP: 0.6189
test/lungOpacity_young_anomaly_score: 1.0038
test/lungOpacity_old_anomaly_score: 1.0013
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.5776
test/lungOpacity_old_subgroupAUROC: 0.6446
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.8119
test/lungOpacity_young_rec_loss: 0.8119
test/lungOpacity_old_loss: 0.7949
test/lungOpacity_old_rec_loss: 0.7949

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.61886
wandb:           test/lungOpacity_old_AUROC 0.6484
wandb:   test/lungOpacity_old_anomaly_score 1.00131
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.7949
wandb:        test/lungOpacity_old_rec_loss 0.7949
wandb:   test/lungOpacity_old_subgroupAUROC 0.6446
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.54969
wandb:         test/lungOpacity_young_AUROC 0.5644
wandb: test/lungOpacity_young_anomaly_score 1.00376
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.81193
wandb:      test/lungOpacity_young_rec_loss 0.81193
wandb: test/lungOpacity_young_subgroupAUROC 0.5776
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.69359
wandb:                       train/rec_loss 0.69359
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/7rvpjzr6
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_4/wandb/run-20230930_115613-7rvpjzr6/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_5/wandb/run-20230930_115630-fk55ng7j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/fk55ng7j
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.6918 - rec_loss: 0.6918 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6184
val/lungOpacity_old_AUROC: 0.5920
val/lungOpacity_young_AP: 0.6033
val/lungOpacity_old_AP: 0.5398
val/lungOpacity_young_anomaly_score: 1.0082
val/lungOpacity_old_anomaly_score: 0.9988
val/lungOpacity_young_fpr@0.95: 0.8200
val/lungOpacity_old_fpr@0.95: 0.7600
val/lungOpacity_young_subgroupAUROC: 0.5798
val/lungOpacity_old_subgroupAUROC: 0.6300
val/lungOpacity_young_tpr@0.05: 0.1000
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.8096
val/lungOpacity_young_rec_loss: 0.8096
val/lungOpacity_old_loss: 0.7951
val/lungOpacity_old_rec_loss: 0.7951

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.5624
test/lungOpacity_old_AUROC: 0.6408
test/lungOpacity_young_AP: 0.5397
test/lungOpacity_old_AP: 0.6070
test/lungOpacity_young_anomaly_score: 1.0047
test/lungOpacity_old_anomaly_score: 1.0024
test/lungOpacity_young_fpr@0.95: 0.8200
test/lungOpacity_old_fpr@0.95: 0.8000
test/lungOpacity_young_subgroupAUROC: 0.5724
test/lungOpacity_old_subgroupAUROC: 0.6366
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0600
test/lungOpacity_young_loss: 0.8129
test/lungOpacity_young_rec_loss: 0.8129
test/lungOpacity_old_loss: 0.7963
test/lungOpacity_old_rec_loss: 0.7963

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.60702
wandb:           test/lungOpacity_old_AUROC 0.6408
wandb:   test/lungOpacity_old_anomaly_score 1.00244
wandb:        test/lungOpacity_old_fpr@0.95 0.8
wandb:            test/lungOpacity_old_loss 0.79635
wandb:        test/lungOpacity_old_rec_loss 0.79635
wandb:   test/lungOpacity_old_subgroupAUROC 0.6366
wandb:        test/lungOpacity_old_tpr@0.05 0.06
wandb:            test/lungOpacity_young_AP 0.53966
wandb:         test/lungOpacity_young_AUROC 0.5624
wandb: test/lungOpacity_young_anomaly_score 1.00468
wandb:      test/lungOpacity_young_fpr@0.95 0.82
wandb:          test/lungOpacity_young_loss 0.81294
wandb:      test/lungOpacity_young_rec_loss 0.81294
wandb: test/lungOpacity_young_subgroupAUROC 0.5724
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.6918
wandb:                       train/rec_loss 0.6918
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/fk55ng7j
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0001-rs47/seed_5/wandb/run-20230930_115630-fk55ng7j/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.005 (678 young and 678 old samples are available)
Using 3 young and 3 old samples for training.
Final dataset shape:  (6, 4)
Loaded datasets in 0.12s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_1/wandb/run-20230930_115658-cfajprqj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cfajprqj
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7286 - rec_loss: 0.7286 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6976
val/lungOpacity_old_AUROC: 0.7356
val/lungOpacity_young_AP: 0.6821
val/lungOpacity_old_AP: 0.6422
val/lungOpacity_young_anomaly_score: 0.9893
val/lungOpacity_old_anomaly_score: 0.9714
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.5800
val/lungOpacity_young_subgroupAUROC: 0.6678
val/lungOpacity_old_subgroupAUROC: 0.7540
val/lungOpacity_young_tpr@0.05: 0.1400
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7850
val/lungOpacity_young_rec_loss: 0.7850
val/lungOpacity_old_loss: 0.7662
val/lungOpacity_old_rec_loss: 0.7662

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6492
test/lungOpacity_old_AUROC: 0.7440
test/lungOpacity_young_AP: 0.5908
test/lungOpacity_old_AP: 0.6787
test/lungOpacity_young_anomaly_score: 0.9833
test/lungOpacity_old_anomaly_score: 0.9729
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.5800
test/lungOpacity_young_subgroupAUROC: 0.6478
test/lungOpacity_old_subgroupAUROC: 0.7396
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7874
test/lungOpacity_young_rec_loss: 0.7874
test/lungOpacity_old_loss: 0.7662
test/lungOpacity_old_rec_loss: 0.7662

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.67866
wandb:           test/lungOpacity_old_AUROC 0.744
wandb:   test/lungOpacity_old_anomaly_score 0.97293
wandb:        test/lungOpacity_old_fpr@0.95 0.58
wandb:            test/lungOpacity_old_loss 0.76619
wandb:        test/lungOpacity_old_rec_loss 0.76619
wandb:   test/lungOpacity_old_subgroupAUROC 0.7396
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.5908
wandb:         test/lungOpacity_young_AUROC 0.6492
wandb: test/lungOpacity_young_anomaly_score 0.98329
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.78742
wandb:      test/lungOpacity_young_rec_loss 0.78742
wandb: test/lungOpacity_young_subgroupAUROC 0.6478
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.72858
wandb:                       train/rec_loss 0.72858
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/cfajprqj
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_1/wandb/run-20230930_115658-cfajprqj/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_2/wandb/run-20230930_115716-l99p7m3w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/l99p7m3w
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7191 - rec_loss: 0.7191 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7016
val/lungOpacity_old_AUROC: 0.7348
val/lungOpacity_young_AP: 0.6661
val/lungOpacity_old_AP: 0.6331
val/lungOpacity_young_anomaly_score: 0.9851
val/lungOpacity_old_anomaly_score: 0.9673
val/lungOpacity_young_fpr@0.95: 0.7000
val/lungOpacity_old_fpr@0.95: 0.5600
val/lungOpacity_young_subgroupAUROC: 0.6708
val/lungOpacity_old_subgroupAUROC: 0.7502
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.7773
val/lungOpacity_young_rec_loss: 0.7773
val/lungOpacity_old_loss: 0.7570
val/lungOpacity_old_rec_loss: 0.7570

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6420
test/lungOpacity_old_AUROC: 0.7356
test/lungOpacity_young_AP: 0.5886
test/lungOpacity_old_AP: 0.6542
test/lungOpacity_young_anomaly_score: 0.9788
test/lungOpacity_old_anomaly_score: 0.9688
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.6000
test/lungOpacity_young_subgroupAUROC: 0.6474
test/lungOpacity_old_subgroupAUROC: 0.7318
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.7797
test/lungOpacity_young_rec_loss: 0.7797
test/lungOpacity_old_loss: 0.7566
test/lungOpacity_old_rec_loss: 0.7566

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.65424
wandb:           test/lungOpacity_old_AUROC 0.7356
wandb:   test/lungOpacity_old_anomaly_score 0.96877
wandb:        test/lungOpacity_old_fpr@0.95 0.6
wandb:            test/lungOpacity_old_loss 0.75663
wandb:        test/lungOpacity_old_rec_loss 0.75663
wandb:   test/lungOpacity_old_subgroupAUROC 0.7318
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.58855
wandb:         test/lungOpacity_young_AUROC 0.642
wandb: test/lungOpacity_young_anomaly_score 0.97883
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.77969
wandb:      test/lungOpacity_young_rec_loss 0.77969
wandb: test/lungOpacity_young_subgroupAUROC 0.6474
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.71914
wandb:                       train/rec_loss 0.71914
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/l99p7m3w
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_2/wandb/run-20230930_115716-l99p7m3w/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_3/wandb/run-20230930_115732-9xuikrlo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/9xuikrlo
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7096 - rec_loss: 0.7096 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6972
val/lungOpacity_old_AUROC: 0.7276
val/lungOpacity_young_AP: 0.6582
val/lungOpacity_old_AP: 0.6292
val/lungOpacity_young_anomaly_score: 0.9808
val/lungOpacity_old_anomaly_score: 0.9642
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.5800
val/lungOpacity_young_subgroupAUROC: 0.6686
val/lungOpacity_old_subgroupAUROC: 0.7438
val/lungOpacity_young_tpr@0.05: 0.0800
val/lungOpacity_old_tpr@0.05: 0.0000
val/lungOpacity_young_loss: 0.7760
val/lungOpacity_young_rec_loss: 0.7760
val/lungOpacity_old_loss: 0.7553
val/lungOpacity_old_rec_loss: 0.7553

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6496
test/lungOpacity_old_AUROC: 0.7312
test/lungOpacity_young_AP: 0.5980
test/lungOpacity_old_AP: 0.6496
test/lungOpacity_young_anomaly_score: 0.9766
test/lungOpacity_old_anomaly_score: 0.9648
test/lungOpacity_young_fpr@0.95: 0.8000
test/lungOpacity_old_fpr@0.95: 0.6200
test/lungOpacity_young_subgroupAUROC: 0.6472
test/lungOpacity_old_subgroupAUROC: 0.7300
test/lungOpacity_young_tpr@0.05: 0.0400
test/lungOpacity_old_tpr@0.05: 0.0400
test/lungOpacity_young_loss: 0.7788
test/lungOpacity_young_rec_loss: 0.7788
test/lungOpacity_old_loss: 0.7546
test/lungOpacity_old_rec_loss: 0.7546

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64961
wandb:           test/lungOpacity_old_AUROC 0.7312
wandb:   test/lungOpacity_old_anomaly_score 0.96482
wandb:        test/lungOpacity_old_fpr@0.95 0.62
wandb:            test/lungOpacity_old_loss 0.75462
wandb:        test/lungOpacity_old_rec_loss 0.75462
wandb:   test/lungOpacity_old_subgroupAUROC 0.73
wandb:        test/lungOpacity_old_tpr@0.05 0.04
wandb:            test/lungOpacity_young_AP 0.59801
wandb:         test/lungOpacity_young_AUROC 0.6496
wandb: test/lungOpacity_young_anomaly_score 0.97658
wandb:      test/lungOpacity_young_fpr@0.95 0.8
wandb:          test/lungOpacity_young_loss 0.77875
wandb:      test/lungOpacity_young_rec_loss 0.77875
wandb: test/lungOpacity_young_subgroupAUROC 0.6472
wandb:      test/lungOpacity_young_tpr@0.05 0.04
wandb:                           train/loss 0.70956
wandb:                       train/rec_loss 0.70956
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/9xuikrlo
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_3/wandb/run-20230930_115732-9xuikrlo/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_4/wandb/run-20230930_115748-4l52mdi5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/4l52mdi5
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7147 - rec_loss: 0.7147 - time: 01-00:00:00s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.6968
val/lungOpacity_old_AUROC: 0.7160
val/lungOpacity_young_AP: 0.6771
val/lungOpacity_old_AP: 0.6186
val/lungOpacity_young_anomaly_score: 0.9878
val/lungOpacity_old_anomaly_score: 0.9707
val/lungOpacity_young_fpr@0.95: 0.6800
val/lungOpacity_old_fpr@0.95: 0.5600
val/lungOpacity_young_subgroupAUROC: 0.6644
val/lungOpacity_old_subgroupAUROC: 0.7362
val/lungOpacity_young_tpr@0.05: 0.1400
val/lungOpacity_old_tpr@0.05: 0.0200
val/lungOpacity_young_loss: 0.7794
val/lungOpacity_young_rec_loss: 0.7794
val/lungOpacity_old_loss: 0.7587
val/lungOpacity_old_rec_loss: 0.7587

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6428
test/lungOpacity_old_AUROC: 0.7224
test/lungOpacity_young_AP: 0.6000
test/lungOpacity_old_AP: 0.6443
test/lungOpacity_young_anomaly_score: 0.9825
test/lungOpacity_old_anomaly_score: 0.9722
test/lungOpacity_young_fpr@0.95: 0.7400
test/lungOpacity_old_fpr@0.95: 0.6200
test/lungOpacity_young_subgroupAUROC: 0.6438
test/lungOpacity_old_subgroupAUROC: 0.7220
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.0800
test/lungOpacity_young_loss: 0.7819
test/lungOpacity_young_rec_loss: 0.7819
test/lungOpacity_old_loss: 0.7581
test/lungOpacity_old_rec_loss: 0.7581

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.64428
wandb:           test/lungOpacity_old_AUROC 0.7224
wandb:   test/lungOpacity_old_anomaly_score 0.97222
wandb:        test/lungOpacity_old_fpr@0.95 0.62
wandb:            test/lungOpacity_old_loss 0.75812
wandb:        test/lungOpacity_old_rec_loss 0.75812
wandb:   test/lungOpacity_old_subgroupAUROC 0.722
wandb:        test/lungOpacity_old_tpr@0.05 0.08
wandb:            test/lungOpacity_young_AP 0.59999
wandb:         test/lungOpacity_young_AUROC 0.6428
wandb: test/lungOpacity_young_anomaly_score 0.98254
wandb:      test/lungOpacity_young_fpr@0.95 0.74
wandb:          test/lungOpacity_young_loss 0.78195
wandb:      test/lungOpacity_young_rec_loss 0.78195
wandb: test/lungOpacity_young_subgroupAUROC 0.6438
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.71474
wandb:                       train/rec_loss 0.71474
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/4l52mdi5
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_4/wandb/run-20230930_115748-4l52mdi5/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_5/wandb/run-20230930_115803-1txlyoyh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1txlyoyh
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7144 - rec_loss: 0.7144 - time: 01-00:00:01s - remaining time: 0d-0h-0m-0s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7220
val/lungOpacity_old_AUROC: 0.7516
val/lungOpacity_young_AP: 0.6930
val/lungOpacity_old_AP: 0.6603
val/lungOpacity_young_anomaly_score: 0.9860
val/lungOpacity_old_anomaly_score: 0.9701
val/lungOpacity_young_fpr@0.95: 0.6800
val/lungOpacity_old_fpr@0.95: 0.5600
val/lungOpacity_young_subgroupAUROC: 0.7032
val/lungOpacity_old_subgroupAUROC: 0.7658
val/lungOpacity_young_tpr@0.05: 0.1200
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7827
val/lungOpacity_young_rec_loss: 0.7827
val/lungOpacity_old_loss: 0.7628
val/lungOpacity_old_rec_loss: 0.7628

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6760
test/lungOpacity_old_AUROC: 0.7408
test/lungOpacity_young_AP: 0.6271
test/lungOpacity_old_AP: 0.6688
test/lungOpacity_young_anomaly_score: 0.9806
test/lungOpacity_old_anomaly_score: 0.9701
test/lungOpacity_young_fpr@0.95: 0.7600
test/lungOpacity_old_fpr@0.95: 0.6400
test/lungOpacity_young_subgroupAUROC: 0.6738
test/lungOpacity_old_subgroupAUROC: 0.7424
test/lungOpacity_young_tpr@0.05: 0.0600
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7845
test/lungOpacity_young_rec_loss: 0.7845
test/lungOpacity_old_loss: 0.7612
test/lungOpacity_old_rec_loss: 0.7612

wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.66879
wandb:           test/lungOpacity_old_AUROC 0.7408
wandb:   test/lungOpacity_old_anomaly_score 0.97007
wandb:        test/lungOpacity_old_fpr@0.95 0.64
wandb:            test/lungOpacity_old_loss 0.76118
wandb:        test/lungOpacity_old_rec_loss 0.76118
wandb:   test/lungOpacity_old_subgroupAUROC 0.7424
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.62708
wandb:         test/lungOpacity_young_AUROC 0.676
wandb: test/lungOpacity_young_anomaly_score 0.98056
wandb:      test/lungOpacity_young_fpr@0.95 0.76
wandb:          test/lungOpacity_young_loss 0.78447
wandb:      test/lungOpacity_young_rec_loss 0.78447
wandb: test/lungOpacity_young_subgroupAUROC 0.6738
wandb:      test/lungOpacity_young_tpr@0.05 0.06
wandb:                           train/loss 0.71439
wandb:                       train/rec_loss 0.71439
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/1txlyoyh
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0005-rs47/seed_5/wandb/run-20230930_115803-1txlyoyh/logs
Using cuda
Running normal/v1...
Run config: {'dp': False, 'protected_attr': 'age', 'initial_seed': 1, 'num_seeds': 5, 'wandb_project': 'unsupervised-fairness', 'epochs': 187, 'batch_size': 32}
Loading data...
Splitting data into 2 bins by age: [ 2.         31.66666667 61.33333333 91.        ]
Reducing dataset size to 0.008 (678 young and 678 old samples are available)
Using 5 young and 5 old samples for training.
Final dataset shape:  (10, 4)
Loaded datasets in 0.16s
wandb: Currently logged in as: j-getzner (thesis-getzner). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_1/wandb/run-20230930_115831-ny8zmupg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ny8zmupg
Setting seed to 1...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7447 - rec_loss: 0.7447 - time: 01-00:00:02s - remaining time: 0d-0h-0m-2s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7528
val/lungOpacity_old_AUROC: 0.7384
val/lungOpacity_young_AP: 0.7342
val/lungOpacity_old_AP: 0.6749
val/lungOpacity_young_anomaly_score: 0.9730
val/lungOpacity_old_anomaly_score: 0.9498
val/lungOpacity_young_fpr@0.95: 0.7400
val/lungOpacity_old_fpr@0.95: 0.6000
val/lungOpacity_young_subgroupAUROC: 0.7106
val/lungOpacity_old_subgroupAUROC: 0.7740
val/lungOpacity_young_tpr@0.05: 0.2800
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7648
val/lungOpacity_young_rec_loss: 0.7648
val/lungOpacity_old_loss: 0.7447
val/lungOpacity_old_rec_loss: 0.7447

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_1/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7128
test/lungOpacity_old_AUROC: 0.7484
test/lungOpacity_young_AP: 0.6775
test/lungOpacity_old_AP: 0.7157
test/lungOpacity_young_anomaly_score: 0.9673
test/lungOpacity_old_anomaly_score: 0.9523
test/lungOpacity_young_fpr@0.95: 0.7000
test/lungOpacity_old_fpr@0.95: 0.5800
test/lungOpacity_young_subgroupAUROC: 0.6940
test/lungOpacity_old_subgroupAUROC: 0.7642
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7669
test/lungOpacity_young_rec_loss: 0.7669
test/lungOpacity_old_loss: 0.7442
test/lungOpacity_old_rec_loss: 0.7442

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.71571
wandb:           test/lungOpacity_old_AUROC 0.7484
wandb:   test/lungOpacity_old_anomaly_score 0.9523
wandb:        test/lungOpacity_old_fpr@0.95 0.58
wandb:            test/lungOpacity_old_loss 0.74423
wandb:        test/lungOpacity_old_rec_loss 0.74423
wandb:   test/lungOpacity_old_subgroupAUROC 0.7642
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.67749
wandb:         test/lungOpacity_young_AUROC 0.7128
wandb: test/lungOpacity_young_anomaly_score 0.96728
wandb:      test/lungOpacity_young_fpr@0.95 0.7
wandb:          test/lungOpacity_young_loss 0.76686
wandb:      test/lungOpacity_young_rec_loss 0.76686
wandb: test/lungOpacity_young_subgroupAUROC 0.694
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.74466
wandb:                       train/rec_loss 0.74466
wandb: 
wandb: üöÄ View run seed_1 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ny8zmupg
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v155
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_1/wandb/run-20230930_115831-ny8zmupg/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_2/wandb/run-20230930_115849-r9j6ncfr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/r9j6ncfr
Setting seed to 2...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7369 - rec_loss: 0.7369 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7392
val/lungOpacity_old_AUROC: 0.7460
val/lungOpacity_young_AP: 0.7312
val/lungOpacity_old_AP: 0.6991
val/lungOpacity_young_anomaly_score: 0.9714
val/lungOpacity_old_anomaly_score: 0.9477
val/lungOpacity_young_fpr@0.95: 0.7200
val/lungOpacity_old_fpr@0.95: 0.5800
val/lungOpacity_young_subgroupAUROC: 0.6930
val/lungOpacity_old_subgroupAUROC: 0.7776
val/lungOpacity_young_tpr@0.05: 0.3000
val/lungOpacity_old_tpr@0.05: 0.1000
val/lungOpacity_young_loss: 0.7613
val/lungOpacity_young_rec_loss: 0.7613
val/lungOpacity_old_loss: 0.7427
val/lungOpacity_old_rec_loss: 0.7427

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_2/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6848
test/lungOpacity_old_AUROC: 0.7464
test/lungOpacity_young_AP: 0.6469
test/lungOpacity_old_AP: 0.7140
test/lungOpacity_young_anomaly_score: 0.9646
test/lungOpacity_old_anomaly_score: 0.9496
test/lungOpacity_young_fpr@0.95: 0.7000
test/lungOpacity_old_fpr@0.95: 0.5800
test/lungOpacity_young_subgroupAUROC: 0.6714
test/lungOpacity_old_subgroupAUROC: 0.7606
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.1600
test/lungOpacity_young_loss: 0.7636
test/lungOpacity_young_rec_loss: 0.7636
test/lungOpacity_old_loss: 0.7425
test/lungOpacity_old_rec_loss: 0.7425

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.71396
wandb:           test/lungOpacity_old_AUROC 0.7464
wandb:   test/lungOpacity_old_anomaly_score 0.94957
wandb:        test/lungOpacity_old_fpr@0.95 0.58
wandb:            test/lungOpacity_old_loss 0.74245
wandb:        test/lungOpacity_old_rec_loss 0.74245
wandb:   test/lungOpacity_old_subgroupAUROC 0.7606
wandb:        test/lungOpacity_old_tpr@0.05 0.16
wandb:            test/lungOpacity_young_AP 0.64689
wandb:         test/lungOpacity_young_AUROC 0.6848
wandb: test/lungOpacity_young_anomaly_score 0.96461
wandb:      test/lungOpacity_young_fpr@0.95 0.7
wandb:          test/lungOpacity_young_loss 0.76359
wandb:      test/lungOpacity_young_rec_loss 0.76359
wandb: test/lungOpacity_young_subgroupAUROC 0.6714
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.73686
wandb:                       train/rec_loss 0.73686
wandb: 
wandb: üöÄ View run seed_2 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/r9j6ncfr
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_2/wandb/run-20230930_115849-r9j6ncfr/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_3/wandb/run-20230930_115905-8ffnj39j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8ffnj39j
Setting seed to 3...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7276 - rec_loss: 0.7276 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7344
val/lungOpacity_old_AUROC: 0.7172
val/lungOpacity_young_AP: 0.7116
val/lungOpacity_old_AP: 0.6579
val/lungOpacity_young_anomaly_score: 0.9662
val/lungOpacity_old_anomaly_score: 0.9444
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.6200
val/lungOpacity_young_subgroupAUROC: 0.6922
val/lungOpacity_old_subgroupAUROC: 0.7514
val/lungOpacity_young_tpr@0.05: 0.1600
val/lungOpacity_old_tpr@0.05: 0.0600
val/lungOpacity_young_loss: 0.7597
val/lungOpacity_young_rec_loss: 0.7597
val/lungOpacity_old_loss: 0.7376
val/lungOpacity_old_rec_loss: 0.7376

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_3/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.6864
test/lungOpacity_old_AUROC: 0.7156
test/lungOpacity_young_AP: 0.6560
test/lungOpacity_old_AP: 0.6949
test/lungOpacity_young_anomaly_score: 0.9603
test/lungOpacity_old_anomaly_score: 0.9457
test/lungOpacity_young_fpr@0.95: 0.7600
test/lungOpacity_old_fpr@0.95: 0.6200
test/lungOpacity_young_subgroupAUROC: 0.6638
test/lungOpacity_old_subgroupAUROC: 0.7364
test/lungOpacity_young_tpr@0.05: 0.0800
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7606
test/lungOpacity_young_rec_loss: 0.7606
test/lungOpacity_old_loss: 0.7373
test/lungOpacity_old_rec_loss: 0.7373

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.69491
wandb:           test/lungOpacity_old_AUROC 0.7156
wandb:   test/lungOpacity_old_anomaly_score 0.9457
wandb:        test/lungOpacity_old_fpr@0.95 0.62
wandb:            test/lungOpacity_old_loss 0.73732
wandb:        test/lungOpacity_old_rec_loss 0.73732
wandb:   test/lungOpacity_old_subgroupAUROC 0.7364
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.65597
wandb:         test/lungOpacity_young_AUROC 0.6864
wandb: test/lungOpacity_young_anomaly_score 0.96034
wandb:      test/lungOpacity_young_fpr@0.95 0.76
wandb:          test/lungOpacity_young_loss 0.76056
wandb:      test/lungOpacity_young_rec_loss 0.76056
wandb: test/lungOpacity_young_subgroupAUROC 0.6638
wandb:      test/lungOpacity_young_tpr@0.05 0.08
wandb:                           train/loss 0.72762
wandb:                       train/rec_loss 0.72762
wandb: 
wandb: üöÄ View run seed_3 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/8ffnj39j
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_3/wandb/run-20230930_115905-8ffnj39j/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_4/wandb/run-20230930_115922-ftp0h6kt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ftp0h6kt
Setting seed to 4...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7413 - rec_loss: 0.7413 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7464
val/lungOpacity_old_AUROC: 0.7568
val/lungOpacity_young_AP: 0.7174
val/lungOpacity_old_AP: 0.6921
val/lungOpacity_young_anomaly_score: 0.9732
val/lungOpacity_old_anomaly_score: 0.9498
val/lungOpacity_young_fpr@0.95: 0.6600
val/lungOpacity_old_fpr@0.95: 0.5400
val/lungOpacity_young_subgroupAUROC: 0.7034
val/lungOpacity_old_subgroupAUROC: 0.7882
val/lungOpacity_young_tpr@0.05: 0.2200
val/lungOpacity_old_tpr@0.05: 0.0400
val/lungOpacity_young_loss: 0.7639
val/lungOpacity_young_rec_loss: 0.7639
val/lungOpacity_old_loss: 0.7422
val/lungOpacity_old_rec_loss: 0.7422

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_4/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7024
test/lungOpacity_old_AUROC: 0.7612
test/lungOpacity_young_AP: 0.6801
test/lungOpacity_old_AP: 0.7267
test/lungOpacity_young_anomaly_score: 0.9665
test/lungOpacity_old_anomaly_score: 0.9523
test/lungOpacity_young_fpr@0.95: 0.6800
test/lungOpacity_old_fpr@0.95: 0.5600
test/lungOpacity_young_subgroupAUROC: 0.6866
test/lungOpacity_old_subgroupAUROC: 0.7710
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.1000
test/lungOpacity_young_loss: 0.7661
test/lungOpacity_young_rec_loss: 0.7661
test/lungOpacity_old_loss: 0.7423
test/lungOpacity_old_rec_loss: 0.7423

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: / 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.72668
wandb:           test/lungOpacity_old_AUROC 0.7612
wandb:   test/lungOpacity_old_anomaly_score 0.95227
wandb:        test/lungOpacity_old_fpr@0.95 0.56
wandb:            test/lungOpacity_old_loss 0.74232
wandb:        test/lungOpacity_old_rec_loss 0.74232
wandb:   test/lungOpacity_old_subgroupAUROC 0.771
wandb:        test/lungOpacity_old_tpr@0.05 0.1
wandb:            test/lungOpacity_young_AP 0.68013
wandb:         test/lungOpacity_young_AUROC 0.7024
wandb: test/lungOpacity_young_anomaly_score 0.96655
wandb:      test/lungOpacity_young_fpr@0.95 0.68
wandb:          test/lungOpacity_young_loss 0.76612
wandb:      test/lungOpacity_young_rec_loss 0.76612
wandb: test/lungOpacity_young_subgroupAUROC 0.6866
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.7413
wandb:                       train/rec_loss 0.7413
wandb: 
wandb: üöÄ View run seed_4 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/ftp0h6kt
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_4/wandb/run-20230930_115922-ftp0h6kt/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.15.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_5/wandb/run-20230930_115938-fnv6yy06
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run seed_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/thesis-getzner/unsupervised-fairness
wandb: üöÄ View run at https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/fnv6yy06
Setting seed to 5...
Initializing model...
Using normal loss
Starting training...
Finished epoch 1/187, (1 iterations)
Finished epoch 2/187, (2 iterations)
Finished epoch 3/187, (3 iterations)
Finished epoch 4/187, (4 iterations)
Finished epoch 5/187, (5 iterations)
Finished epoch 6/187, (6 iterations)
Finished epoch 7/187, (7 iterations)
Finished epoch 8/187, (8 iterations)
Finished epoch 9/187, (9 iterations)
Finished epoch 10/187, (10 iterations)
Finished epoch 11/187, (11 iterations)
Finished epoch 12/187, (12 iterations)
Finished epoch 13/187, (13 iterations)
Finished epoch 14/187, (14 iterations)
Finished epoch 15/187, (15 iterations)
Finished epoch 16/187, (16 iterations)
Finished epoch 17/187, (17 iterations)
Finished epoch 18/187, (18 iterations)
Finished epoch 19/187, (19 iterations)
Finished epoch 20/187, (20 iterations)
Finished epoch 21/187, (21 iterations)
Finished epoch 22/187, (22 iterations)
Finished epoch 23/187, (23 iterations)
Finished epoch 24/187, (24 iterations)
Finished epoch 25/187, (25 iterations)
Finished epoch 26/187, (26 iterations)
Finished epoch 27/187, (27 iterations)
Finished epoch 28/187, (28 iterations)
Finished epoch 29/187, (29 iterations)
Finished epoch 30/187, (30 iterations)
Finished epoch 31/187, (31 iterations)
Finished epoch 32/187, (32 iterations)
Finished epoch 33/187, (33 iterations)
Finished epoch 34/187, (34 iterations)
Finished epoch 35/187, (35 iterations)
Finished epoch 36/187, (36 iterations)
Finished epoch 37/187, (37 iterations)
Finished epoch 38/187, (38 iterations)
Finished epoch 39/187, (39 iterations)
Finished epoch 40/187, (40 iterations)
Finished epoch 41/187, (41 iterations)
Finished epoch 42/187, (42 iterations)
Finished epoch 43/187, (43 iterations)
Finished epoch 44/187, (44 iterations)
Finished epoch 45/187, (45 iterations)
Finished epoch 46/187, (46 iterations)
Finished epoch 47/187, (47 iterations)
Finished epoch 48/187, (48 iterations)
Finished epoch 49/187, (49 iterations)
Finished epoch 50/187, (50 iterations)
Finished epoch 51/187, (51 iterations)
Finished epoch 52/187, (52 iterations)
Finished epoch 53/187, (53 iterations)
Finished epoch 54/187, (54 iterations)
Finished epoch 55/187, (55 iterations)
Finished epoch 56/187, (56 iterations)
Finished epoch 57/187, (57 iterations)
Finished epoch 58/187, (58 iterations)
Finished epoch 59/187, (59 iterations)
Finished epoch 60/187, (60 iterations)
Finished epoch 61/187, (61 iterations)
Finished epoch 62/187, (62 iterations)
Finished epoch 63/187, (63 iterations)
Finished epoch 64/187, (64 iterations)
Finished epoch 65/187, (65 iterations)
Finished epoch 66/187, (66 iterations)
Finished epoch 67/187, (67 iterations)
Finished epoch 68/187, (68 iterations)
Finished epoch 69/187, (69 iterations)
Finished epoch 70/187, (70 iterations)
Finished epoch 71/187, (71 iterations)
Finished epoch 72/187, (72 iterations)
Finished epoch 73/187, (73 iterations)
Finished epoch 74/187, (74 iterations)
Finished epoch 75/187, (75 iterations)
Finished epoch 76/187, (76 iterations)
Finished epoch 77/187, (77 iterations)
Finished epoch 78/187, (78 iterations)
Finished epoch 79/187, (79 iterations)
Finished epoch 80/187, (80 iterations)
Finished epoch 81/187, (81 iterations)
Finished epoch 82/187, (82 iterations)
Finished epoch 83/187, (83 iterations)
Finished epoch 84/187, (84 iterations)
Finished epoch 85/187, (85 iterations)
Finished epoch 86/187, (86 iterations)
Finished epoch 87/187, (87 iterations)
Finished epoch 88/187, (88 iterations)
Finished epoch 89/187, (89 iterations)
Finished epoch 90/187, (90 iterations)
Finished epoch 91/187, (91 iterations)
Finished epoch 92/187, (92 iterations)
Finished epoch 93/187, (93 iterations)
Finished epoch 94/187, (94 iterations)
Finished epoch 95/187, (95 iterations)
Finished epoch 96/187, (96 iterations)
Finished epoch 97/187, (97 iterations)
Finished epoch 98/187, (98 iterations)
Finished epoch 99/187, (99 iterations)
Iteration 100 - loss: 0.7298 - rec_loss: 0.7298 - time: 01-00:00:01s - remaining time: 0d-0h-0m-1s
Finished epoch 100/187, (100 iterations)
Finished epoch 101/187, (101 iterations)
Finished epoch 102/187, (102 iterations)
Finished epoch 103/187, (103 iterations)
Finished epoch 104/187, (104 iterations)
Finished epoch 105/187, (105 iterations)
Finished epoch 106/187, (106 iterations)
Finished epoch 107/187, (107 iterations)
Finished epoch 108/187, (108 iterations)
Finished epoch 109/187, (109 iterations)
Finished epoch 110/187, (110 iterations)
Finished epoch 111/187, (111 iterations)
Finished epoch 112/187, (112 iterations)
Finished epoch 113/187, (113 iterations)
Finished epoch 114/187, (114 iterations)
Finished epoch 115/187, (115 iterations)
Finished epoch 116/187, (116 iterations)
Finished epoch 117/187, (117 iterations)
Finished epoch 118/187, (118 iterations)
Finished epoch 119/187, (119 iterations)
Finished epoch 120/187, (120 iterations)
Finished epoch 121/187, (121 iterations)
Finished epoch 122/187, (122 iterations)
Finished epoch 123/187, (123 iterations)
Finished epoch 124/187, (124 iterations)
Finished epoch 125/187, (125 iterations)
Finished epoch 126/187, (126 iterations)
Finished epoch 127/187, (127 iterations)
Finished epoch 128/187, (128 iterations)
Finished epoch 129/187, (129 iterations)
Finished epoch 130/187, (130 iterations)
Finished epoch 131/187, (131 iterations)
Finished epoch 132/187, (132 iterations)
Finished epoch 133/187, (133 iterations)
Finished epoch 134/187, (134 iterations)
Finished epoch 135/187, (135 iterations)
Finished epoch 136/187, (136 iterations)
Finished epoch 137/187, (137 iterations)
Finished epoch 138/187, (138 iterations)
Finished epoch 139/187, (139 iterations)
Finished epoch 140/187, (140 iterations)
Finished epoch 141/187, (141 iterations)
Finished epoch 142/187, (142 iterations)
Finished epoch 143/187, (143 iterations)
Finished epoch 144/187, (144 iterations)
Finished epoch 145/187, (145 iterations)
Finished epoch 146/187, (146 iterations)
Finished epoch 147/187, (147 iterations)
Finished epoch 148/187, (148 iterations)
Finished epoch 149/187, (149 iterations)
Finished epoch 150/187, (150 iterations)
Finished epoch 151/187, (151 iterations)
Finished epoch 152/187, (152 iterations)
Finished epoch 153/187, (153 iterations)
Finished epoch 154/187, (154 iterations)
Finished epoch 155/187, (155 iterations)
Finished epoch 156/187, (156 iterations)
Finished epoch 157/187, (157 iterations)
Finished epoch 158/187, (158 iterations)
Finished epoch 159/187, (159 iterations)
Finished epoch 160/187, (160 iterations)
Finished epoch 161/187, (161 iterations)
Finished epoch 162/187, (162 iterations)
Finished epoch 163/187, (163 iterations)
Finished epoch 164/187, (164 iterations)
Finished epoch 165/187, (165 iterations)
Finished epoch 166/187, (166 iterations)
Finished epoch 167/187, (167 iterations)
Finished epoch 168/187, (168 iterations)
Finished epoch 169/187, (169 iterations)
Finished epoch 170/187, (170 iterations)
Finished epoch 171/187, (171 iterations)
Finished epoch 172/187, (172 iterations)
Finished epoch 173/187, (173 iterations)
Finished epoch 174/187, (174 iterations)
Finished epoch 175/187, (175 iterations)
Finished epoch 176/187, (176 iterations)
Finished epoch 177/187, (177 iterations)
Finished epoch 178/187, (178 iterations)
Finished epoch 179/187, (179 iterations)
Finished epoch 180/187, (180 iterations)
Finished epoch 181/187, (181 iterations)
Finished epoch 182/187, (182 iterations)
Finished epoch 183/187, (183 iterations)
Finished epoch 184/187, (184 iterations)
Finished epoch 185/187, (185 iterations)
Finished epoch 186/187, (186 iterations)
Finished epoch 187/187, (187 iterations)
Reached 187 epochs. Finished training.
Final validation...

val results:
val/lungOpacity_young_AUROC: 0.7520
val/lungOpacity_old_AUROC: 0.7420
val/lungOpacity_young_AP: 0.7392
val/lungOpacity_old_AP: 0.7012
val/lungOpacity_young_anomaly_score: 0.9691
val/lungOpacity_old_anomaly_score: 0.9473
val/lungOpacity_young_fpr@0.95: 0.7600
val/lungOpacity_old_fpr@0.95: 0.6200
val/lungOpacity_young_subgroupAUROC: 0.7104
val/lungOpacity_old_subgroupAUROC: 0.7746
val/lungOpacity_young_tpr@0.05: 0.1800
val/lungOpacity_old_tpr@0.05: 0.0800
val/lungOpacity_young_loss: 0.7633
val/lungOpacity_young_rec_loss: 0.7633
val/lungOpacity_old_loss: 0.7416
val/lungOpacity_old_rec_loss: 0.7416

Saving checkpoint to logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_5/ckpt_last.pth
Testing...

Test results:
test/lungOpacity_young_AUROC: 0.7128
test/lungOpacity_old_AUROC: 0.7476
test/lungOpacity_young_AP: 0.6852
test/lungOpacity_old_AP: 0.7186
test/lungOpacity_young_anomaly_score: 0.9633
test/lungOpacity_old_anomaly_score: 0.9486
test/lungOpacity_young_fpr@0.95: 0.6800
test/lungOpacity_old_fpr@0.95: 0.5600
test/lungOpacity_young_subgroupAUROC: 0.6922
test/lungOpacity_old_subgroupAUROC: 0.7636
test/lungOpacity_young_tpr@0.05: 0.1000
test/lungOpacity_old_tpr@0.05: 0.1200
test/lungOpacity_young_loss: 0.7650
test/lungOpacity_young_rec_loss: 0.7650
test/lungOpacity_old_loss: 0.7416
test/lungOpacity_old_rec_loss: 0.7416

wandb: Waiting for W&B process to finish... (success).
wandb: - 0.028 MB of 0.028 MB uploaded (0.000 MB deduped)wandb: \ 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: | 0.028 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     train/loss ‚ñÅ
wandb: train/rec_loss ‚ñÅ
wandb: 
wandb: Run summary:
wandb:              test/lungOpacity_old_AP 0.71865
wandb:           test/lungOpacity_old_AUROC 0.7476
wandb:   test/lungOpacity_old_anomaly_score 0.94858
wandb:        test/lungOpacity_old_fpr@0.95 0.56
wandb:            test/lungOpacity_old_loss 0.74163
wandb:        test/lungOpacity_old_rec_loss 0.74163
wandb:   test/lungOpacity_old_subgroupAUROC 0.7636
wandb:        test/lungOpacity_old_tpr@0.05 0.12
wandb:            test/lungOpacity_young_AP 0.68516
wandb:         test/lungOpacity_young_AUROC 0.7128
wandb: test/lungOpacity_young_anomaly_score 0.96327
wandb:      test/lungOpacity_young_fpr@0.95 0.68
wandb:          test/lungOpacity_young_loss 0.765
wandb:      test/lungOpacity_young_rec_loss 0.765
wandb: test/lungOpacity_young_subgroupAUROC 0.6922
wandb:      test/lungOpacity_young_tpr@0.05 0.1
wandb:                           train/loss 0.72979
wandb:                       train/rec_loss 0.72979
wandb: 
wandb: üöÄ View run seed_5 at: https://wandb.ai/thesis-getzner/unsupervised-fairness/runs/fnv6yy06
wandb: Ô∏è‚ö° View job at https://wandb.ai/thesis-getzner/unsupervised-fairness/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjg4MDgyNTYz/version_details/v154
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: logs/2023-09-30 11:29:59-FAE-rsna-age-bs32-dss-noDP/old_percent_05_0008-rs47/seed_5/wandb/run-20230930_115938-fnv6yy06/logs
