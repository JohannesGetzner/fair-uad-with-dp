parser = ArgumentParser()
# General script settings
parser.add_argument('--initial_seed', type=int, default=1, help='Random seed')
parser.add_argument('--num_seeds', type=int, default=1, help='Number of random seed')
parser.add_argument('--debug', action='store_true', help='Debug mode')
parser.add_argument('--disable_wandb', action='store_true', help='Debug mode')

# Experiment settings
parser.add_argument('--experiment_name', type=str, default='')

# Data settings
parser.add_argument('--dataset', type=str, default='rsna', choices=['rsna'])
parser.add_argument('--protected_attr', type=str, default='none', choices=['none', 'age', 'sex'])
parser.add_argument('--male_percent', type=float, default=0.5)
parser.add_argument('--old_percent', type=float, default=0.5)
parser.add_argument('--img_size', type=int, default=128, help='Image size')
parser.add_argument('--num_workers', type=int, default=0, help='Number of workers for dataloader')

# Logging settings
parser.add_argument('--val_frequency', type=int, default=200, help='Validation frequency')
parser.add_argument('--val_steps', type=int, default=50, help='Steps per validation')
parser.add_argument('--log_frequency', type=int, default=100, help='Logging frequency')
parser.add_argument('--log_img_freq', type=int, default=1000)
parser.add_argument('--num_imgs_log', type=int, default=8)
parser.add_argument('--log_dir', type=str, help="Logging directory",default=os.path.join('logs', datetime.strftime(datetime.now(), format="%Y.%m.%d-%H:%M:%S")))

# Hyperparameters
parser.add_argument('--lr', type=float, default=2e-4, help='Learning rate')
parser.add_argument('--weight_decay', type=float, default=0.0, help='Weight decay')
parser.add_argument('--max_steps', type=int, default=8000,  # 8000,  # 10000, help='Number of training steps')
parser.add_argument('--batch_size', type=int, default=32, help='Batch size')

# Model settings
parser.add_argument('--model_type', type=str, default='FAE', choices=['FAE', 'DeepSVDD'])
# FAE settings
# 128, 160, 224, 320
parser.add_argument('--hidden_dims', type=int, nargs='+', default=[100, 150, 200, 300], help='Autoencoder hidden dimensions')
parser.add_argument('--dropout', type=float, default=0.1, help='Dropout rate')
parser.add_argument('--loss_fn', type=str, default='ssim', help='loss function', choices=['mse', 'ssim'])
parser.add_argument('--extractor_cnn_layers', type=str, nargs='+', default=['layer0', 'layer1', 'layer2'])
parser.add_argument('--keep_feature_prop', type=float, default=1.0, help='Proportion of ResNet features to keep')
# DeepSVDD settings
parser.add_argument('--repr_dim', type=int, default=256, help='Dimensionality of the hypersphere c')

# Differential Privacy settings
parser.add_argument('--dp', action=BooleanOptionalAction, default=False, help='Use differential privacy')
parser.add_argument('--e', type=float, default=8, help='Noise multiplier')
parser.add_argument('--delta', type=float, help='Target delta')
parser.add_argument('--max_grad_norm', type=float, default=1, help='Max gradient norm')


# Other
parser.add_argument('--sweep',  action=BooleanOptionalAction, default=False, help='do a hyperparam sweep')
CONFIG = parser.parse_args()